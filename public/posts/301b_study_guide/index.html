<!DOCTYPE html>
<html itemscope itemtype="http://schema.org/WebPage" lang="en">
  <head>
    
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
    <meta name="robots" content="noodp" />
    <title>F5 301b Study Guide - Route Your Network</title><meta name="author" content="Caleb Delbrugge">
<meta name="author-link" content="">
<meta name="description" content="Introduction Hey all,
This is the study guide I&rsquo;ve been building since I started studying for this exam way back in 2017. Hopefully it can help fill any gaps you may have. I&rsquo;ve sourced the material from solution articles, experience, and manuals.
Section 1 - Maintain Application and LTM Device Health Objective 1.01 Given a scenario, determine the appropriate profile setting modifications SSL K13385: Overview of the Proxy SSL feature" /><meta name="keywords" content='Hugo, FixIt' /><meta itemprop="name" content="F5 301b Study Guide">
<meta itemprop="description" content="Introduction Hey all,
This is the study guide I&rsquo;ve been building since I started studying for this exam way back in 2017. Hopefully it can help fill any gaps you may have. I&rsquo;ve sourced the material from solution articles, experience, and manuals.
Section 1 - Maintain Application and LTM Device Health Objective 1.01 Given a scenario, determine the appropriate profile setting modifications SSL K13385: Overview of the Proxy SSL feature"><meta itemprop="datePublished" content="2023-04-30T20:14:22+08:00" />
<meta itemprop="dateModified" content="2023-04-30T20:14:22+08:00" />
<meta itemprop="wordCount" content="15749">
<meta itemprop="keywords" content="" /><meta property="og:title" content="F5 301b Study Guide" />
<meta property="og:description" content="Introduction Hey all,
This is the study guide I&rsquo;ve been building since I started studying for this exam way back in 2017. Hopefully it can help fill any gaps you may have. I&rsquo;ve sourced the material from solution articles, experience, and manuals.
Section 1 - Maintain Application and LTM Device Health Objective 1.01 Given a scenario, determine the appropriate profile setting modifications SSL K13385: Overview of the Proxy SSL feature" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://routeyour.net/posts/301b_study_guide/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-04-30T20:14:22+08:00" />
<meta property="article:modified_time" content="2023-04-30T20:14:22+08:00" />
<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="F5 301b Study Guide"/>
<meta name="twitter:description" content="Introduction Hey all,
This is the study guide I&rsquo;ve been building since I started studying for this exam way back in 2017. Hopefully it can help fill any gaps you may have. I&rsquo;ve sourced the material from solution articles, experience, and manuals.
Section 1 - Maintain Application and LTM Device Health Objective 1.01 Given a scenario, determine the appropriate profile setting modifications SSL K13385: Overview of the Proxy SSL feature"/>
<meta name="application-name" content="FixIt">
<meta name="apple-mobile-web-app-title" content="FixIt"><meta name="theme-color" data-light="#f8f8f8" data-dark="#252627" content="#f8f8f8"><meta name="msapplication-TileColor" content="#da532c"><link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" />
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5"><link rel="canonical" href="https://routeyour.net/posts/301b_study_guide/" /><link rel="stylesheet" href="/css/style.min.css"><link rel="stylesheet" href="/lib/fontawesome-free/all.min.css"><link rel="stylesheet" href="/lib/animate/animate.min.css"><script type="application/ld+json">
  {
    "@context": "http://schema.org",
    "@type": "BlogPosting",
    "headline": "F5 301b Study Guide",
    "inLanguage": "en",
    "mainEntityOfPage": {
      "@type": "WebPage",
      "@id": "https:\/\/routeyour.net\/posts\/301b_study_guide\/"
    },"genre": "posts","wordcount":  15749 ,
    "url": "https:\/\/routeyour.net\/posts\/301b_study_guide\/","datePublished": "2023-04-30T20:14:22+08:00","dateModified": "2023-04-30T20:14:22+08:00","publisher": {
      "@type": "Organization",
      "name": ""},"author": {
        "@type": "Person",
        "name": "Caleb Delbrugge"
      },"description": ""
  }
  </script></head>
  <body data-header-desktop="sticky" data-header-mobile="auto"><script>(window.localStorage?.getItem('theme') ? localStorage.getItem('theme') === 'dark' : ('auto' === 'auto' ? window.matchMedia('(prefers-color-scheme: dark)').matches : 'auto' === 'dark')) && document.body.setAttribute('data-theme', 'dark');</script><div class="wrapper" data-page-style="normal"><header class="desktop animate__faster" id="header-desktop">
  <div class="header-wrapper">
    <div class="header-title">
      <a href="/" title="Route Your Network"><span class="header-title-text">routeyour.net</span></a><span class="header-subtitle"></span></div>
    <nav>
      <ul class="menu"><li class="menu-item">
              <a
                class="menu-link"
                href="/posts/"
                
                
              >Posts</a></li><li class="menu-item">
              <a
                class="menu-link"
                href="/tags/"
                
                
              >Tags</a></li><li class="menu-item">
              <a
                class="menu-link"
                href="/categories/"
                
                
              >Categories</a></li><li class="menu-item delimiter"></li><li class="menu-item theme-switch" title="Switch Theme">
          <i class="fa-solid fa-adjust fa-fw" aria-hidden="true"></i>
        </li></ul>
    </nav>
  </div>
</header><header class="mobile animate__faster" id="header-mobile">
  <div class="header-container">
    <div class="header-wrapper">
      <div class="header-title">
        <a href="/" title="Route Your Network"><span class="header-title-text">routeyour.net</span></a><span class="header-subtitle"></span></div>
      <div class="menu-toggle" id="menu-toggle-mobile">
        <span></span><span></span><span></span>
      </div>
    </div>
    <nav>
      <ul class="menu" id="menu-mobile"><li
              class="menu-item"
            ><a
                  class="menu-link"
                  href="/posts/"
                  
                  
                >Posts</a></li><li
              class="menu-item"
            ><a
                  class="menu-link"
                  href="/tags/"
                  
                  
                >Tags</a></li><li
              class="menu-item"
            ><a
                  class="menu-link"
                  href="/categories/"
                  
                  
                >Categories</a></li><li class="menu-item menu-system">
          <span class="menu-system-item theme-switch" title="Switch Theme"><i class="fa-solid fa-adjust fa-fw" aria-hidden="true"></i></span></li>
      </ul>
    </nav>
  </div>
</header><main class="container"><aside class="toc" id="toc-auto"><h2 class="toc-title">Contents&nbsp;<i class="toc-icon fa-solid fa-angle-down fa-fw" aria-hidden="true"></i></h2>
      <div class="toc-content" id="toc-content-auto"></div></aside>

  <aside class="aside-custom">
    </aside>

  <article class="page single">
    <div class="header"><h1 class="single-title animate__animated animate__flipInX"><span>F5 301b Study Guide</span>
      </h1></div><div class="post-meta">
      <div class="post-meta-line"><span class="post-author"><span class="author"><i class="fa-solid fa-user-circle" aria-hidden="true"></i>
      Caleb Delbrugge</span></span></div>
      <div class="post-meta-line"><span title="published on 2023-04-30 20:14:22"><i class="fa-regular fa-calendar-alt fa-fw me-1" aria-hidden="true"></i><time datetime="2023-04-30">2023-04-30</time></span>&nbsp;<span title="Updated on 2023-04-30 20:14:22"><i class="fa-regular fa-edit fa-fw me-1" aria-hidden="true"></i><time datetime="2023-04-30">2023-04-30</time></span>&nbsp;<span><i class="fa-solid fa-pencil-alt fa-fw me-1" aria-hidden="true"></i>15749 words</span>&nbsp;<span><i class="fa-regular fa-clock fa-fw me-1" aria-hidden="true"></i>74 minutes</span>&nbsp;</div>
    </div><div class="details toc" id="toc-static" data-kept="false">
        <div class="details-summary toc-title">
          <span>Contents</span>
          <span><i class="details-icon fa-solid fa-angle-right" aria-hidden="true"></i></span>
        </div>
        <div class="details-content toc-content" id="toc-content-static"><nav id="TableOfContents">
  <ul>
    <li><a href="#section-1---maintain-application-and-ltm-device-health">Section 1 - Maintain Application and LTM Device Health</a></li>
    <li><a href="#objective-101-given-a-scenario-determine-the-appropriate-profile-setting-modifications">Objective 1.01 Given a scenario, determine the appropriate profile setting modifications</a>
      <ul>
        <li><a href="#ssl">SSL</a></li>
        <li><a href="#stream-profile">Stream Profile</a></li>
        <li><a href="#http">HTTP</a></li>
        <li><a href="#http-compression">HTTP Compression</a></li>
        <li><a href="#web-acceleration-cache">Web Acceleration (Cache)</a></li>
        <li><a href="#xml">XML</a></li>
        <li><a href="#oneconnect">OneConnect</a></li>
      </ul>
    </li>
    <li><a href="#--101a---given-a-scenario-of-client-or-server-side-buffer-issues-packet-loss-or-congestion-select-the-appropriate-tcp-or-udp-profile-to-correct-the-issue">- 1.01a - Given a scenario of client or server side buffer issues, packet loss, or congestion, select the appropriate TCP or UDP profile to correct the issue</a>
      <ul>
        <li><a href="#tcp-profile">TCP Profile</a></li>
        <li><a href="#tcp">TCP</a></li>
      </ul>
    </li>
    <li><a href="#--101b---given-a-scenario-determine-when-an-application-would-benefit-from-http-compression-andor-web-acceleration-profile">- 1.01b - Given a scenario determine when an application would benefit from HTTP Compression and/or Web Acceleration profile</a>
      <ul>
        <li><a href="#virtual-server">Virtual Server</a></li>
      </ul>
    </li>
    <li><a href="#--102a---evaluate-which-irules-can-be-replaced-with-a-profile-or-policy-setting">- 1.02a - Evaluate which iRules can be replaced with a profile or policy setting</a></li>
    <li><a href="#--102b---evaluate-which-host-virtual-servers-would-be-better-consolidated-into-a-network-virtual-server">- 1.02b - Evaluate which host virtual servers would be better consolidated into a network virtual server</a></li>
    <li><a href="#--103a---identify-redundant-andor-unused-objects">- 1.03a - Identify redundant and/or unused objects</a></li>
    <li><a href="#--103b---identify-unnecessary-monitoring">- 1.03b - Identify unnecessary monitoring</a></li>
    <li><a href="#--103c---interpret-configuration-and-performance-statistics">- 1.03c - Interpret configuration and performance statistics</a></li>
    <li><a href="#--103d---explain-the-effect-of-removing-functions-from-the-ltm-device-configuration">- 1.03d - Explain the effect of removing functions from the LTM device configuration</a>
      <ul>
        <li><a href="#removing-a-pool-member-from-a-pool">Removing a Pool member from a pool</a></li>
        <li><a href="#increase-disk-space">Increase disk space</a></li>
        <li><a href="#console">Console</a></li>
        <li><a href="#management-ip-config">Management IP Config</a></li>
        <li><a href="#gui-issues">GUI Issues</a></li>
        <li><a href="#daemons">Daemons</a></li>
        <li><a href="#mos-maintenance-operating-system">MOS (Maintenance Operating System)</a></li>
        <li><a href="#e2fsck">e2fsck</a></li>
        <li><a href="#fsck">fsck</a></li>
        <li><a href="#replace-down-device">Replace down device</a></li>
        <li><a href="#reload-configuration">Reload Configuration</a></li>
        <li><a href="#single-configuration-file">Single Configuration File</a></li>
        <li><a href="#diff-scf-files">Diff SCF files</a></li>
        <li><a href="#ucs-contents--info">UCS Contents &amp; Info</a></li>
        <li><a href="#restore-without-passphrase">Restore without passphrase</a></li>
      </ul>
    </li>
    <li><a href="#--104a---identify-the-appropriate-methods-for-a-clean-install">- 1.04a - Identify the appropriate methods for a clean install</a>
      <ul>
        <li><a href="#clean-install">Clean Install</a></li>
      </ul>
    </li>
    <li><a href="#--104b---identify-the-tmsh-sys-software-install-options-required-to-install-a-new-version">- 1.04b - Identify the TMSH sys software install options required to install a new version</a></li>
    <li><a href="#--104c---identify-the-steps-required-to-upgrade-the-ltm-device-such-as-license-renewal-validation-of-upgrade-path-review-release-notes-etc">- 1.04c - Identify the steps required to upgrade the LTM device such as: license renewal, validation of upgrade path, review release notes, etc.</a>
      <ul>
        <li><a href="#upgrade-code">Upgrade Code</a></li>
      </ul>
    </li>
    <li><a href="#--104d---identify-how-to-copy-a-config-to-a-previously-installed-boot-locationslot">- 1.04d - Identify how to copy a config to a previously installed boot location/slot</a></li>
    <li><a href="#--104e---identify-valid-rollback-steps-for-a-given-upgrade-scenario">- 1.04e - Identify valid rollback steps for a given upgrade scenario</a></li>
    <li><a href="#--105a---explain-how-to-upgrade-an-ltm-device-from-the-gui">- 1.05a - Explain how to upgrade an LTM device from the GUI</a></li>
    <li><a href="#--105b---describe-the-effect-of-performing-an-upgrade-in-an-environment-with-device-groups-and-traffic-groups">- 1.05b - Describe the effect of performing an upgrade in an environment with device groups and traffic groups</a></li>
    <li><a href="#--105c---explain-how-to-perform-an-upgrade-in-a-high-availability-group">- 1.05c - Explain how to perform an upgrade in a high availability group</a></li>
    <li><a href="#--106a---describe-how-to-specify-the-oids-for-alerting">- 1.06a - Describe how to specify the OIDs for alerting</a></li>
    <li><a href="#--106b---explain-how-to-log-different-levels-of-local-traffic-message-logs">- 1.06b - Explain how to log different levels of local traffic message logs</a>
      <ul>
        <li><a href="#modify-linux-host-syslog-levels">Modify Linux host syslog levels</a></li>
      </ul>
    </li>
    <li><a href="#--106c---explain-how-to-trigger-custom-alerts-for-testing-purposes">- 1.06c - Explain how to trigger custom alerts for testing purposes</a>
      <ul>
        <li><a href="#built-in-alerts">Built-in Alerts</a></li>
      </ul>
    </li>
    <li><a href="#--107a---list-and-describe-custom-alerts-snmp-email-and-remote-syslog">- 1.07a - List and describe custom alerts: SNMP, email and Remote Syslog</a>
      <ul>
        <li><a href="#configure-syslog">Configure Syslog</a></li>
        <li><a href="#snmp">SNMP</a></li>
        <li><a href="#email-snmp-traps">Email SNMP traps</a></li>
      </ul>
    </li>
    <li><a href="#--107b---identify-the-location-of-custom-alert-configuration-files">- 1.07b - Identify the location of custom alert configuration files</a></li>
    <li><a href="#--107c---identify-the-available-levels-for-local-traffic-logging">- 1.07c - Identify the available levels for local traffic logging</a></li>
    <li><a href="#--201a---determine-which-irule-events-and-commands-to-use">- 2.01a - Determine which iRule events and commands to use</a></li>
    <li><a href="#--201b---given-a-specific-irule-event-determine-what-commands-are-available">- 2.01b - Given a specific iRule event determine what commands are available</a>
      <ul>
        <li><a href="#events">Events</a></li>
        <li><a href="#operators">Operators</a></li>
        <li><a href="#commands">Commands</a></li>
      </ul>
    </li>
    <li><a href="#--202a---interpret-information-in-irule-logs-to-determine-the-irule-and-irule-events-where-they-occurred">- 2.02a - Interpret information in iRule logs to determine the iRule and iRule events where they occurred</a></li>
    <li><a href="#--202b---describe-the-results-of-irule-errors">- 2.02b - Describe the results of iRule errors</a>
      <ul>
        <li><a href="#example-irules">Example iRules</a></li>
      </ul>
    </li>
    <li><a href="#--203a---use-an-irule-to-resolve-application-issues-related-to-traffic-steering-andor-application-data">- 2.03a - Use an iRule to resolve application issues related to traffic steering and/or application data</a>
      <ul>
        <li><a href="#insecure-content-on-page">Insecure Content on Page</a></li>
        <li><a href="#allow-internet-explorer-to-download-files-through-ssl">Allow Internet Explorer to download files through SSL</a></li>
      </ul>
    </li>
    <li><a href="#objective-204-interpret-avr-information-to-identify-performance-issues-or-application-attacks">Objective 2.04 Interpret AVR information to identify performance issues or application attacks</a></li>
    <li><a href="#--204a---explain-how-to-modify-profile-settings-using-information-from-the-avr">- 2.04a - Explain how to modify profile settings using information from the AVR </a></li>
    <li><a href="#--204b---explain-how-to-use-advanced-filters-to-narrow-output-data-from-avr">- 2.04b - Explain how to use advanced filters to narrow output data from AVR </a></li>
    <li><a href="#--204c---identify-potential-latency-increases-within-an-application">- 2.04c - Identify potential latency increases within an application</a></li>
    <li><a href="#--205a---explain-how-to-use-avr-to-trace-application-traffic">- 2.05a - Explain how to use AVR to trace application traffic </a></li>
    <li><a href="#--205b---explain-how-latency-trends-identify-application-tier-bottlenecks">- 2.05b - Explain how latency trends identify application tier bottlenecks</a></li>
    <li><a href="#--206a---explain-how-to-interpret-response-codes">- 2.06a - Explain how to interpret response codes</a></li>
    <li><a href="#--206b---explain-the-function-of-http-headers-within-different-http-applications-cookies-cache-control-vary-content-type--host----207c---predict-the-browser-caching-behavior-when-application-data-is-received-headers-and-html">- 2.06b - Explain the function of HTTP headers within different HTTP applications (Cookies, Cache Control, Vary, Content Type &amp; Host) / - 2.07c - Predict the browser caching behavior when application data is received (headers and HTML)</a>
      <ul>
        <li><a href="#meta-headers">META Headers</a></li>
        <li><a href="#etag">ETag</a></li>
        <li><a href="#http-vary-header-and-caching">HTTP Vary Header and Caching</a></li>
        <li><a href="#caching-commands---show-and-delete-entries">Caching Commands - Show and Delete Entries</a></li>
      </ul>
    </li>
    <li><a href="#--206c---explain-http-methods-get-post-etc">- 2.06c - Explain HTTP methods (GET, POST, etc.)</a>
      <ul>
        <li><a href="#http-methods">HTTP Methods</a></li>
      </ul>
    </li>
    <li><a href="#--206d---explain-how-to-decode-post-data">- 2.06d - Explain how to decode POST data.</a>
      <ul>
        <li><a href="#decode-post-data">Decode POST Data</a></li>
      </ul>
    </li>
    <li><a href="#--207a---investigate-the-cause-of-a-specific-response-code">- 2.07a - Investigate the cause of a specific response code</a></li>
    <li><a href="#--207b---investigate-the-cause-of-an-ssl-handshake-failure">- 2.07b - Investigate the cause of an SSL Handshake failure</a>
      <ul>
        <li><a href="#handshake-failures">Handshake Failures</a></li>
        <li><a href="#ssldump-failure-examples">SSLDUMP failure examples</a></li>
      </ul>
    </li>
    <li><a href="#objective-209-given-a-direct-trace-a-trace-through-the-ltm-device-and-other-relevant-information-compare-the-traces-to-determine-a-solution-to-an-httphttps-application-problem">Objective 2.09 Given a direct trace, a trace through the LTM device, and other relevant information, compare the traces to determine a solution to an HTTP/HTTPS application problem</a></li>
    <li><a href="#--209b---given-a-failed-http-request-and-ltm-configuration-data-determine-if-the-connection-is-failing-due-to-the-ltm-configuration">- 2.09b - Given a failed HTTP request and LTM configuration data determine if the connection is failing due to the LTM configuration</a>
      <ul>
        <li><a href="#auto-last-hop">Auto Last Hop</a></li>
        <li><a href="#failed-request-captures">Failed Request Captures</a></li>
        <li><a href="#persistence">Persistence</a></li>
        <li><a href="#_packet-filters_"><em>Packet Filters</em></a></li>
        <li><a href="#snat">SNAT</a></li>
        <li><a href="#fastl4-profile">FastL4 Profile</a></li>
        <li><a href="#fasthttp-profile">FastHTTP Profile</a></li>
        <li><a href="#ssldump">ssldump</a></li>
        <li><a href="#tcpdump">TCPDUMP</a></li>
      </ul>
    </li>
    <li><a href="#--210a---identify-application-issues-based-on-a-protocol-analyzer-trace-and-determine-solution">- 2.10a - Identify application issues based on a protocol analyzer trace and determine solution</a>
      <ul>
        <li><a href="#no-response">No Response</a></li>
      </ul>
    </li>
    <li><a href="#--210b---explain-how-to-follow-a-conversation-from-client-side-and-server-side-traces">- 2.10b - Explain how to follow a conversation from client side and server side traces</a>
      <ul>
        <li><a href="#following-a-trace">Following a Trace</a></li>
        <li><a href="#following-a-trace-in-wireshark">Following a Trace in Wireshark</a></li>
      </ul>
    </li>
    <li><a href="#--210c---explain-how-snat-and-oneconnect-affect-protocol-analyzer-traces">- 2.10c - Explain how SNAT and OneConnect affect protocol analyzer traces</a>
      <ul>
        <li><a href="#snat-1">SNAT</a></li>
        <li><a href="#oneconnect-1">OneConnect</a></li>
      </ul>
    </li>
    <li><a href="#--210d---explain-how-to-decrypt-ssl-traffic-for-protocol-analysis-v115">- 2.10d - Explain how to decrypt SSL traffic for protocol analysis (v11.5)</a>
      <ul>
        <li><a href="#read-application-data---symmetric-keys">Read application data - Symmetric keys</a></li>
      </ul>
    </li>
    <li><a href="#--210e---explain-how-to-recognize-the-different-causes-of-slow-traffic-eg-drops-rsts-retransmits-icmp-errors-demotion-from-cmp">- 2.10e - Explain how to recognize the different causes of slow traffic (e.g., drops, RSTs, retransmits, ICMP errors, demotion from CMP)</a>
      <ul>
        <li><a href="#drops">Drops</a></li>
        <li><a href="#resets">Resets</a></li>
        <li><a href="#duplicate-acks">Duplicate ACKs</a></li>
        <li><a href="#slow-traffic">Slow Traffic</a></li>
        <li><a href="#cmp---cluster-multiprocessing">CMP - Cluster Multiprocessing</a></li>
      </ul>
    </li>
    <li><a href="#--214a---explain-how-to-capture-and-interpret-monitor-traffic-using-protocol-analyzer">- 2.14a - Explain how to capture and interpret monitor traffic using protocol analyzer</a></li>
    <li><a href="#--214b---explain-how-to-obtain-needed-input-and-output-data-to-create-the-monitors">- 2.14b - Explain how to obtain needed input and output data to create the monitors</a></li>
    <li><a href="#--215a---determine-appropriate-monitor-and-monitor-timing-based-on-application-and-server-limitations">- 2.15a - Determine appropriate monitor and monitor timing based on application and server limitations</a>
      <ul>
        <li><a href="#types">Types</a></li>
        <li><a href="#pools-1">Pools</a></li>
        <li><a href="#ftp">FTP</a></li>
        <li><a href="#external">External</a></li>
      </ul>
    </li>
    <li><a href="#--215b---describe-how-to-modify-monitor-settings-to-resolve-monitor-problems">- 2.15b - Describe how to modify monitor settings to resolve monitor problems</a>
      <ul>
        <li><a href="#http-1">HTTP</a></li>
        <li><a href="#lcd-messages">LCD Messages</a></li>
        <li><a href="#alert-conditions">Alert conditions</a></li>
      </ul>
    </li>
    <li><a href="#--301a---interpret-log-file-messages-to-identify-ltm-device-issues">- 3.01a - Interpret log file messages to identify LTM device issues</a></li>
    <li><a href="#--301b---interpret-the-qkview-heuristic-results">- 3.01b - Interpret the qkview heuristic results</a></li>
    <li><a href="#--301c---identify-appropriate-methods-to-troubleshoot-ntp">- 3.01c - Identify appropriate methods to troubleshoot NTP</a>
      <ul>
        <li><a href="#prefer-ntp-server">Prefer NTP server</a></li>
        <li><a href="#troubleshooting-1">Troubleshooting</a></li>
        <li><a href="#output-1">Output</a></li>
      </ul>
    </li>
    <li><a href="#--301d---identify-license-problems-based-on-the-log-file-messages-and-statistics">- 3.01d - Identify license problems based on the log file messages and statistics</a></li>
    <li><a href="#--302a---identify-hardware-problems-based-on-the-log-file-messages-and-statistics">- 3.02a - Identify hardware problems based on the log file messages and statistics</a>
      <ul>
        <li><a href="#end-user-diagnostics">End User Diagnostics</a></li>
        <li><a href="#ssl-hardware-accelerator">SSL Hardware Accelerator</a></li>
        <li><a href="#hard-drive-issues">Hard Drive Issues</a></li>
      </ul>
    </li>
    <li><a href="#--302b---identify-resource-exhaustion-problems-based-on-the-log-file-messages-and-statistics">- 3.02b - Identify resource exhaustion problems based on the log file messages and statistics</a>
      <ul>
        <li><a href="#memory">Memory</a></li>
        <li><a href="#cpu">CPU</a></li>
        <li><a href="#hard-drive">Hard Drive</a></li>
        <li><a href="#cache">Cache</a></li>
      </ul>
    </li>
    <li><a href="#--302c---identify-connectivity-problems-based-on-the-log-files">- 3.02c - Identify connectivity problems based on the log files</a></li>
    <li><a href="#--302d---determine-the-appropriate-log-file-to-examine-to-determine-the-cause-of-the-problem">- 3.02d - Determine the appropriate log file to examine to determine the cause of the problem</a></li>
    <li><a href="#objective-303-analyze-performance-data-to-identify-a-resource-problem-on-an-ltm-device">Objective 3.03 Analyze performance data to identify a resource problem on an LTM device</a></li>
    <li><a href="#--303a---analyze-performance-data-to-identify-a-resource-problem-on-an-ltm-device">- 3.03a - Analyze performance data to identify a resource problem on an LTM device</a></li>
    <li><a href="#objective-304-given-a-scenario-determine-the-cause-of-an-ltm-device-failover">Objective 3.04 Given a scenario, determine the cause of an LTM device failover</a>
      <ul>
        <li><a href="#ha-groups-fast-failover">HA Groups (Fast Failover)</a></li>
        <li><a href="#ha-order">HA Order</a></li>
        <li><a href="#load-aware">Load Aware</a></li>
        <li><a href="#failsafes">Failsafes</a></li>
      </ul>
    </li>
    <li><a href="#--304a---explain-the-effect-of-network-failover-settings-on-the-ltm-device">- 3.04a - Explain the effect of network failover settings on the LTM device </a></li>
    <li><a href="#--304b---explain-the-relationship-between-serial-and-network-failover">- 3.04b - Explain the relationship between serial and network failover </a></li>
    <li><a href="#--304c---differentiate-between-unicast-and-multicast-network-failover-modes">- 3.04c - Differentiate between unicast and multicast network failover modes</a></li>
    <li><a href="#--304d---identify-the-cause-of-failover-using-logs-and-statistics">- 3.04d - Identify the cause of failover using logs and statistics</a>
      <ul>
        <li><a href="#logs">Logs</a></li>
        <li><a href="#statistics">Statistics</a></li>
      </ul>
    </li>
    <li><a href="#objective-305-given-a-scenario-determine-the-cause-of-loss-of-high-availability-andor-sync-failure">Objective 3.05 Given a scenario, determine the cause of loss of high availability and/or sync failure</a></li>
    <li><a href="#--305a---explain-how-the-high-availability-concepts-relate-to-one-another">- 3.05a - Explain how the high availability concepts relate to one another</a></li>
    <li><a href="#--305b---explain-the-relationship-between-device-trust-and-device-groups">- 3.05b - Explain the relationship between device trust and device groups</a></li>
    <li><a href="#--305c---identify-the-cause-of-config-sync-failures">- 3.05c - Identify the cause of config sync failures</a>
      <ul>
        <li><a href="#config-sync-requirements">Config-Sync Requirements</a></li>
        <li><a href="#sync-and-device-trust-problems">Sync and Device Trust Problems</a></li>
        <li><a href="#self-ips">Self-IPs</a></li>
      </ul>
    </li>
    <li><a href="#--305d---explain-the-relationship-between-traffic-groups-and-ltm-objects">- 3.05d - Explain the relationship between traffic groups and LTM objects</a></li>
    <li><a href="#--305e---interpret-log-messages-to-determine-the-cause-of-high-availability-issues">- 3.05e - Interpret log messages to determine the cause of high availability issues</a></li>
  </ul>
</nav></div>
      </div><div class="content" id="content"><h1 id="introduction">Introduction</h1>
<p>Hey all,</p>
<p>This is the study guide I&rsquo;ve been building since I started studying for this exam way back in 2017. Hopefully it can help fill any gaps you may have. I&rsquo;ve sourced the material from solution articles, experience, and manuals.</p>
<h2 id="section-1---maintain-application-and-ltm-device-health">Section 1 - Maintain Application and LTM Device Health</h2>
<h2 id="objective-101-given-a-scenario-determine-the-appropriate-profile-setting-modifications">Objective 1.01 Given a scenario, determine the appropriate profile setting modifications</h2>
<h3 id="ssl">SSL</h3>
<p><a href="https://support.f5.com/csp/article/K13385"target="_blank" rel="external nofollow noopener noreferrer">K13385: Overview of the Proxy SSL feature</a></p>
<p>Proxy SSL does NOT terminate SSL on the load balancer. Use it to optimize the SSL connection.</p>
<p>Use Proxy SSL in an SSL profile to forward a client cert to a server for certification authentication</p>
<h3 id="stream-profile">Stream Profile</h3>
<p><a href="https://support.f5.com/csp/article/K39394712"target="_blank" rel="external nofollow noopener noreferrer">Overview of the Stream Profile</a></p>
<p><a href="https://support.f5.com/csp/article/K7027"target="_blank" rel="external nofollow noopener noreferrer">Article: K7027 - Replacing multiple strings using a Stream profile</a></p>
<p>“Content rewrite”</p>
<p>Standard Virtual Server setting</p>
<p>Replaces string in a data stream (TCP) from the client and server</p>
<p>Can replace string if it spans across multiple segments by buffering just enough data to do so</p>
<p>If HTTP profile is applied, search is done in HTTP payload only (not headers) in each segment. Otherwise, the whole TCP segment is searched and this is when you can replace HTTP Headers!</p>
<p>Compatible with HTTP Profile Chunking</p>
<h4 id="parameters">Parameters</h4>
<p>Source: What to look for in the content</p>
<p>Target: What to replace the content with</p>
<h4 id="replace-multiple-sets-of-strings">Replace Multiple Sets of Strings</h4>
<p>Leave ‘source’ in profile blank</p>
<p>Use a unique delimiter in the ‘target’ field and a space between the source/target pairs.</p>
<p>Don’t put &lt; &gt; unless you want to literally.</p>
<p><strong>@</strong><!-- raw HTML omitted --><strong>@</strong><!-- raw HTML omitted --><strong>@</strong> <strong>@</strong><!-- raw HTML omitted --><strong>@</strong><!-- raw HTML omitted --><strong>@</strong></p>
<p>Note: The first character in the field defines the delimiter bounding each field for this replacement and must not appear anywhere else in the target string. In certain versions, the delimiter can be a period (.), asterisk (*), forward slash (/), dash (-), colon (:), underscore (_), question mark (?), equals (=), at (@), comma (,), or ampersand (&amp;) character.</p>
<p><strong>Example:</strong></p>
<pre tabindex="0"><code>ltm profile stream h1_marquee {
 app-service none
 defaults-from stream
 source &lt;h1&gt;Sunshine&lt;/h1&gt;
 target &lt;marquee&gt;&lt;h1&gt;Moon&lt;/h1&gt;&lt;/marquee&gt;
}
</code></pre><p>You don’t need to use an iRule</p>
<pre tabindex="0"><code>when HTTP_RESPONSE {
 STREAM::expression &#34;@123@456@ @abc@xyz@&#34;
 STREAM::enable
}
</code></pre><h4 id="recommendations">Recommendations</h4>
<ul>
<li>Restrict rewrites to Content-Type: text*/</li>
<li>A stream profile must be on VIP before using the STREAM command in an iRule. The default Stream profile may be used with all parameters blank</li>
<li>Data is changed once per operation</li>
<li>A compression profile is required to rewrite compressed data</li>
<li>Source and Target are case-sensitive unless you use RegEx</li>
</ul>
<h3 id="http">HTTP</h3>
<p><a href="https://support.f5.com/csp/article/K4707?sr=46615374"target="_blank" rel="external nofollow noopener noreferrer">Choosing appropriate profiles for HTTP traffic</a></p>
<p><a href="https://support.f5.com/csp/article/K5379"target="_blank" rel="external nofollow noopener noreferrer">Overview of HTTP Chunking</a></p>
<p><a href="https://support.f5.com/csp/article/K14775"target="_blank" rel="external nofollow noopener noreferrer">K14775: Configuring an HTTP profile to rewrite URLs so that redirects from an HTTP server specify the HTTPS protocol (10.x, 11.x, and 12.x)</a></p>
<p><strong>Drawbacks</strong> - Uses CPU, more memory utilized for compression/caching</p>
<h4 id="options">Options</h4>
<ul>
<li>
<p>Request Header Insert</p>
</li>
<li>
<p>Request Header Erase</p>
</li>
<li>
<p>Insert X-Forwarded-For</p>
</li>
<li>
<p>Accept XFF - Distrust or trust XFF header from client to use in statistics for AVR</p>
</li>
<li>
<p>Fallback host, Fallback on error codes</p>
</li>
<li>
<p>Redirect Rewrite</p>
</li>
<li>
<p>Server Header Name</p>
</li>
<li>
<p>Cookie encryption</p>
</li>
<li>
<p>Protocol enforcement - Header size, count, Pipelining</p>
</li>
<li>
<p>Strict Transport Security (HSTS)</p>
<ul>
<li>Protect against stripping attacks by downgrading to HTTP. Force all content in a page to use HTTPS. The F5 inserts a header in the response to the client.</li>
</ul>
</li>
</ul>
<h4 id="redirect-rewrite-options">Redirect Rewrite Options</h4>
<p>The F5 will see an HTTP redirect from a server on a 443 VIP and change it to HTTPS.</p>
<p>Great for SSL offload unaware servers that need to send some redirects.</p>
<p>If the F5 does not do this, one of the following will happen:</p>
<ul>
<li>If there’s no HTTP VIP, causes request failure</li>
<li>Request goes to HTTP VIP and HTTP pool member and causes failure</li>
<li>Request goes to HTTP VIP and server, which gets redirected to HTTPs and causes redirect loop</li>
</ul>
<p>Matching</p>
<p>Only rewrite courtesy redirects to HTTPS</p>
<p>Courtesy redirects = Sent by server, the F5 adds / to specify a directory if original resource isn’t found.</p>
<ul>
<li><a href="http://f5.com/stuff"target="_blank" rel="external nofollow noopener noreferrer">http://f5.com/stuff</a> → <a href="https://f5.com/stuff/"target="_blank" rel="external nofollow noopener noreferrer">https://f5.com/stuff/</a></li>
</ul>
<p>Nodes - Change the redirect containing the node’s IP to the VIP</p>
<p>All - Rewrites all HTTP 301, 302, 303, 305, or 307 redirects to HTTPS</p>
<h3 id="http-compression">HTTP Compression</h3>
<p>Profiles &gt; Services &gt; HTTP Compression</p>
<p>Good for WAN clients with slow internet and/or high latency</p>
<p>Reads <strong>Accept-encoding</strong> from client, removes and sends request to server<br>
Inserts <strong>Content-Encoding</strong> header in response from Server, and specifies clients preferred method, <strong>gzip</strong> or <strong>deflate</strong></p>
<p><strong>Compression Levels gzip</strong></p>
<p>1 - 9, highest is more compression. Anything more than 1 will degrade performance in some way</p>
<p>Depending on load, gzip compression level will automatically go down.</p>
<h3 id="web-acceleration-cache">Web Acceleration (Cache)</h3>
<p>Profiles &gt; Services &gt; Web Acceleration</p>
<ul>
<li>Must have HTTP profile assigned to VIP</li>
<li>The server only has to serve content to the BIG-IP once every expiration period for the content</li>
<li>The cache size in a profile is shared among all VIPs it is applied to.</li>
</ul>
<p>Types of web acceleration profiles: Basic, Optimized, optimized caching</p>
<p>When to use caching</p>
<ul>
<li>High demand objects - server sends data to BIG IP when content expires</li>
<li>Static content - CSS files, javascript, images/logos, audio.</li>
</ul>
<p>Items that are cacheable - RFC2616 HTTP/1.1</p>
<ul>
<li>200, 203, 206, 300, 301, 410 responses</li>
<li>GET methods by default - other methods are supported, even non HTTP methods specified in URI list or iRule</li>
<li>Based on User-Agent and Accept-Encoding headers</li>
<li>If the server says it&rsquo;s cacheable, the F5 does it.</li>
</ul>
<p>Cache-Control Header specifies which content cannot be cacheable</p>
<ul>
<li>private, no-store, no-cache - Do not cache</li>
<li>Set-Cookie - Not cached, as it is usually authentication intended for a particular user session</li>
</ul>
<p>Cannot cache - HEAD, PUT, DELETE, TRACE, CONNECT by default</p>
<p>Objects that are cached continue to be served even if the pool member is offline, until the object expires. This is by design. Create an iRule if you want this changed.</p>
<h4 id="show-and-delete-entries">Show and Delete Entries</h4>
<p><strong>show ltm profile ramcache</strong> &lt;profile_name&gt; <strong>[ host</strong> &lt;vip_address:port&gt; <strong>max-response</strong> &lt;how_many_entries_to_display&gt; <strong>]</strong></p>
<p><strong>delete ltm profile ramcache</strong> &lt;profile_name&gt; <strong>[ host</strong> &lt;vip_address:port&gt; <strong>uri /</strong>&lt;object_name&gt; <strong>]</strong></p>
<p><strong>delete ltm profile ramcache</strong> &lt;profile_name&gt; ****- Deletes all entries</p>
<h3 id="xml">XML</h3>
<p>Route to pools, pool members, or VIP based on content in XML file. Specify content in profile and reference in iRule.</p>
<h3 id="oneconnect">OneConnect</h3>
<ul>
<li>Re-use server-side connections using Keep-Alive.</li>
<li>Use an HTTP profile with it or it could do funny things.</li>
<li>Don’t use on SSL pass-through</li>
<li>Opens a new connection to the server if needed when the LB algorithm chooses that server. LB algorithm is not overridden</li>
<li>Load balances each HTTP request individually from the same connection.</li>
<li>Will close connection after Maximum Reuse or Max Age is exceeded or the server closes it due to Idle timeout</li>
<li>If SNAT is enabled, the mask is applied to the SNAT IP, which may not work well.</li>
</ul>
<p>OneConnect Transformations - Replaces client&rsquo;s HTTP/1.1 Connection: close with X-Cnection: close to the server. The server will ignore the header. F5 does not send Keep-Alive in HTTP/1.1 as it&rsquo;s the default. The F5 inserts Connection: Keep-Alive for HTTP/1.0 requests. The server must support Connection: Keep-Alive if HTTP/1.0 and HTTP/0.9 is used. A FastHTTP profile will instead replace it with Xonnection: close</p>
<p>Source Mask - Specify subnet mask. This is used to specify when to use an idle connection for a client IP coming in</p>
<ul>
<li>0.0.0.0 - Re-use idle connections for all connections regardless of client-IP. Multiple requests from different clients can come over one connection, appearing as if it is from one IP</li>
<li>255.255.255.0 - Allow clients with the same first 3 octets to reuse the same connections</li>
<li>255.255.255.255 - Only the same IP can re-use an idle connection</li>
</ul>
<p>Maximum Size - How many idle connections to keep connected to servers</p>
<p>Maximum Reuse - How many requests to send over one connection. Set to below the max of the server Keep-Alive limit to prevent the server connection to close and entering the TIME_WAIT state</p>
<p>Maximum Age - How long to reuse server connection before deleting it</p>
<p>Idle Timeout Override - Override idle timeout in TCP profile</p>
<h4 id="troubleshooting">Troubleshooting</h4>
<ul>
<li>Fast servers may have fewer open connections and more idle connections than slow servers because they finish connections quicker.</li>
<li>Persistence can offset if slow servers do not respond quickly enough and more connections go to faster servers.</li>
</ul>
<h2 id="--101a---given-a-scenario-of-client-or-server-side-buffer-issues-packet-loss-or-congestion-select-the-appropriate-tcp-or-udp-profile-to-correct-the-issue">- 1.01a - Given a scenario of client or server side buffer issues, packet loss, or congestion, select the appropriate TCP or UDP profile to correct the issue</h2>
<h3 id="tcp-profile">TCP Profile</h3>
<p><strong>Proxy Buffer (Content spool)</strong>:</p>
<p>The F5 buffers data from the server if the client has not acknowledged data quick enough. This allows the server to focus on other requests.</p>
<p>(Airport analogy - Bags are offloaded to the metal rollers to allow people to rest and do other things.)</p>
<p>May want to increase this with clients that have packet loss or are latent. Keeping both the same and high is optimal so data is buffered as soon as the client ACKs content in the send buffer.</p>
<p>Proxy Buffer High: The amount of data in the buffer in which to close the receive window from the server.
Proxy Buffer Low: Amount of data in the buffer that triggers the receive window to open.</p>
<p>(The amount of space free on the metal rollers to start accepting more bags.- 3 feet)</p>
<p>Send Buffer: Data that was sent but not yet acknowledged - kept just in case it needs retransmitted.
Receive Window: How much to send the F5 that can be outstanding/unacknowledged
Congestion Control: Use Woodside if some clients are wireless</p>
<p><strong>tcp-mobile-optimized</strong></p>
<ul>
<li>Buffers and window increased to allow for latency/packet loss</li>
<li>Initial Congestion Window Size: 16: Sends more data unacknowledged to begin with</li>
<li>Nagle - Enabled: Needing ACKs of full segment size to send more when data is outstanding. Fewer packets on latent slow networks.</li>
</ul>
<p><strong>tcp-wan-optimized</strong></p>
<ul>
<li>Increased buffers</li>
<li>Send Buffer and Receive window the same as mobile-optimized</li>
<li>SACK and Nagle Enabled</li>
</ul>
<p><strong>tcp-lan-optimized</strong></p>
<ul>
<li>Buffers, window the same as wan-optimized</li>
<li>Slow Start: Disabled</li>
<li>Nagle - Disabled: Nagle may hold data, when its not needed</li>
<li>Acknowledge on Push: Enabled: Helpful for Windows and MacOS with small send buffers.</li>
</ul>
<h3 id="tcp">TCP</h3>
<p><strong>Stream-oriented</strong> - TCP will send a continuous stream of data and divide up packets to fit into IP datagrams.</p>
<p>TCP Window Size, AKA Send Window:</p>
<p><em>Send Window</em><strong>:</strong> Amount of data that can be sent and be outstanding/unacknowledged. A 16-bit field (2^16 = 65535)</p>
<ul>
<li>This can be increased by using the scale factor in the Options field during the handshake, value 0 to 14.</li>
<li>Take the unscaled Window, multiply it by 2^(0-14)</li>
<li>Example - 65535 * (2^14) = 1,073,725,440 bytes (a gigabyte)</li>
</ul>
<p>Maximum Segment Size (MSS) - The maximum segment size the local host <em>will</em> accept. It usually is 40 bytes less than the MTU size.</p>
<p>Default is 536 bytes, 40 bytes less than default IP MTU</p>
<h2 id="--101b---given-a-scenario-determine-when-an-application-would-benefit-from-http-compression-andor-web-acceleration-profile">- 1.01b - Given a scenario determine when an application would benefit from HTTP Compression and/or Web Acceleration profile</h2>
<p>Compression - Good for WAN clients with low bandwidth or latency</p>
<p>Caching</p>
<ul>
<li>High demand objects - server sends data to BIG IP when content expires</li>
<li>Static content - CSS files, javascript, images, audio.</li>
</ul>
<p>Objective 1.02 Given a subset of an LTM configuration, determine which objects to remove or consolidate to simplify the LTM configuration</p>
<h3 id="virtual-server">Virtual Server</h3>
<h4 id="matching-order">Matching Order</h4>
<p>Most Specific &gt; Least specific</p>
<ul>
<li>Destination</li>
<li>Source</li>
<li>Port</li>
</ul>
<p>VIP listener has precedence over NAT</p>
<p>Types</p>
<ul>
<li>Standard</li>
<li>Forwarding (Layer 2) - No pools</li>
<li>Forwarding (IP) - No pools</li>
<li>Performance (HTTP)</li>
<li>Performance (Layer 4)</li>
<li>Stateless</li>
<li>Reject</li>
<li>DHCP Relay</li>
</ul>
<p><strong>Address translation</strong> - Send to different IP (Pool member) Default enabled. Disable if the pool member has the same IP as the VIP</p>
<p><strong>Port</strong> <strong>translation</strong> - Automatically enabled on a Standard VIP. Connections to VS:80 -&gt; Server:8909. Disable it if you have a multi-port VIP and want traffic sent to pool members that are listening on several ports</p>
<p><strong>Auto Last Hop</strong> - Send return traffic from the pool of servers to the MAC address that sent the client request. This is useful if there is not a default route on the F5 and there is no route for the source. Also works to reply return traffic through transparent devices like an IPS.</p>
<p><strong>Last Hop Pool</strong> - Send return traffic through this pool</p>
<p><strong>Clone Pool (Client)</strong> - Specify a pool that all client traffic will get cloned to. The service port is irrelevant in the pool config.</p>
<p><strong>Clone Pool (Server)</strong></p>
<p><strong>Rewrite Profile</strong> - Content Rewrite profile for HTML web application rewrites <a href="https://support.f5.com/csp/article/K99872325"target="_blank" rel="external nofollow noopener noreferrer">K99872325: Modifying HTML tag attributes using an HTML profile</a></p>
<h2 id="--102a---evaluate-which-irules-can-be-replaced-with-a-profile-or-policy-setting">- 1.02a - Evaluate which iRules can be replaced with a profile or policy setting</h2>
<p>Use built in things over iRules.</p>
<p>LTM Policies override iRules</p>
<p>HTTP Profile</p>
<h2 id="--102b---evaluate-which-host-virtual-servers-would-be-better-consolidated-into-a-network-virtual-server">- 1.02b - Evaluate which host virtual servers would be better consolidated into a network virtual server</h2>
<p>If you wanted to direct clients destined to a network to a pool of firewalls.</p>
<p>Objective 1.03 Given a set of LTM device statistics, determine which objects to remove or consolidate to simplify the LTM configuration</p>
<h2 id="--103a---identify-redundant-andor-unused-objects">- 1.03a - Identify redundant and/or unused objects</h2>
<p>HTTP profile on VIP without iRule or HTTP inspect/modification requirements.</p>
<h2 id="--103b---identify-unnecessary-monitoring">- 1.03b - Identify unnecessary monitoring</h2>
<p>ICMP and TCP is unnecessary</p>
<p>Same monitors applied to the pool member and the pool</p>
<h2 id="--103c---interpret-configuration-and-performance-statistics">- 1.03c - Interpret configuration and performance statistics</h2>
<p><strong>show ltm pool</strong></p>
<p><strong>show ltm virtual</strong></p>
<h2 id="--103d---explain-the-effect-of-removing-functions-from-the-ltm-device-configuration">- 1.03d - Explain the effect of removing functions from the LTM device configuration</h2>
<p>SSL profiles and certificates</p>
<ul>
<li>Note: Existing connections continue to use the old SSL certificate until the connections complete or are renegotiated or until TMM is restarted.</li>
<li>Impact of procedure: Performing the following procedure should not have any impact on the existing traffic and new traffic will utilize the new certificate.</li>
</ul>
<p>HTTP profiles</p>
<p>SNAT</p>
<h3 id="removing-a-pool-member-from-a-pool">Removing a Pool member from a pool</h3>
<p>Removes existing persistence entries.</p>
<p>If the cookie pool member is not available, the F5 makes a new load balancing decision.</p>
<p>Existing connections remain until idle timeout or client close.</p>
<p>Objective 1.04 Given a scenario, determine the appropriate upgrade and recovery steps required to restore functionality to LTM devices</p>
<h3 id="increase-disk-space">Increase disk space</h3>
<p><a href="https://support.f5.com/csp/article/K14952"target="_blank" rel="external nofollow noopener noreferrer">K14952: Extending disk space on BIG-IP VE</a></p>
<p>Supported directories that can be increased:</p>
<ul>
<li>/var</li>
<li>/var/log</li>
<li>/config</li>
<li>/shared</li>
</ul>
<p>Verify free space - <strong>list sys disk</strong></p>
<p>Increase space - <strong>modify sys disk directory /var new-size</strong> <!-- raw HTML omitted --></p>
<p>Verify - <strong>show sys disk directory</strong></p>
<p><strong>reboot</strong></p>
<h3 id="console">Console</h3>
<p>Bits - 19200<br>
Data bits - 8<br>
Parity - N<br>
Stop bit - 1<br>
Flow control - N</p>
<h3 id="management-ip-config">Management IP Config</h3>
<p>GUI:  System -&gt; Platform</p>
<p>TMSH: <strong>modify sys management-</strong></p>
<h3 id="gui-issues">GUI Issues</h3>
<p>Check or restart <strong>httpd</strong> and <strong>tomcat</strong></p>
<p><strong>bigstart restart httpd tomcat</strong></p>
<h3 id="daemons">Daemons</h3>
<p><strong>restart sys service <!-- raw HTML omitted --></strong></p>
<p>The <strong>mcpd</strong> daemon is the Master Control Program. Allows two-way communication between userland (applications outside the kernel) processes and TMM processes.</p>
<p>If this is down, traffic management does not function and nothing can be configured. Other daemons will also not function correctly.</p>
<p>MCP is responsible for health checks</p>
<p><strong>show sys mcp-state</strong></p>
<pre tabindex="0"><code>--------------------------------------------------------
Sys::mcpd State:
--------------------------------------------------------
Running Phase                            running
Last Configuration Load Status           full-config-load-succeed
End Platform ID received:                true
</code></pre><h3 id="mos-maintenance-operating-system">MOS (Maintenance Operating System)</h3>
<p><a href="https://support.f5.com/csp/article/K14245"target="_blank" rel="external nofollow noopener noreferrer">Article: K14245 - Overview of the recovery tasks performed from the MOS (11.x - 15.x)</a></p>
<p>Reboot into it from CLI: <strong>mosreboot</strong></p>
<p>Boot into it using Console:</p>
<p>Select TMOS Maintenance from grub boot menu:</p>
<pre tabindex="0"><code>   GNU GRUB  version 0.97  (619K LOWER / 3653927K UPPER MEMORY)
 ******************************************************************
 * BIG-IP 12.1.3.7 Build 0.0.2 - drive sda.1                      *
 * TMOS maintenance                                               *
 *                                                                *
 ******************************************************************
</code></pre><p>You will be logged in as root automatically</p>
<p>Capabilities:</p>
<ul>
<li>Mount filesystems</li>
<li>Use <strong>e2fsck</strong> to repair file system</li>
<li>Set mgmt IP</li>
<li>Transfer files</li>
<li>Install IOS using <strong>image2disk</strong></li>
</ul>
<h3 id="e2fsck">e2fsck</h3>
<p>For ext2/ext3/ext4 filesystems</p>
<h4 id="error-on-boot-about-hdd">Error on boot about HDD</h4>
<pre tabindex="0"><code>[/sbin/fsck.ext3 (1) -- /shared] fsck.ext3 -a /dev/mapper/vg--db--sda-dat.share.1 dat.share.1 contains a file system with errors, check forced.
 Error reading block 5259469 (Attempt to read block from filesystem resulted in short read) while reading indirect blocks of inode 2622816.
</code></pre><p><strong>e2fsck -yf</strong> /dev/mapper/vg&ndash;db&ndash;sda-dat.share.1</p>
<p><strong>-y</strong> : Assume yes to all questions<br>
<strong>-f</strong> : Force check even if it seems clean</p>
<h3 id="fsck">fsck</h3>
<p><a href="https://support.f5.com/csp/article/K73827442"target="_blank" rel="external nofollow noopener noreferrer">Article: K73827442 - Forcing a file system check on the next system reboot (12.x - 15.x)</a></p>
<p><a href="https://support.f5.com/csp/article/K60432403"target="_blank" rel="external nofollow noopener noreferrer">Article: K60432403 - Recovering from a failed device start due to file system errors</a></p>
<p><a href="https://www.devcentral.f5.com/s/question/0D51T00006wzaNH/f5-upgrade-error"target="_blank" rel="external nofollow noopener noreferrer">F5 upgrade error DevCentral</a></p>
<p><a href="https://support.f5.com/csp/article/K61521075"target="_blank" rel="external nofollow noopener noreferrer">K61521075: BIG-IP VE failed to boot after outage with console message: UNEXPECTED INCONSISTENCY; RUN fsck MANUALLY.</a> - May not be on test</p>
<h4 id="run-on-next-reboot">Run on next reboot</h4>
<p><strong>touch /forcefsck</strong><br>
<strong>reboot</strong></p>
<p>OR</p>
<p><strong>shutdown -rF now</strong></p>
<h4 id="error-on-boot-about-hdd-1">Error on boot about HDD</h4>
<pre tabindex="0"><code>set.1./var contains a file system with errors, check forced
set.1./var: Directory inode 81930, block 0, offset 0: directory corrupted
set.1./var: UNEXPECTED INCONSISTENCY; RUN fsck MANUALLY. (i.e., without -a or -p options) [FAILED]
*** An error occurred during the file system check.
*** Dropping you to a shell; the system will reboot
*** when you leave the shell.
*** Warning -- SELinux is active
*** Disabling security enforcement for system recovery.
*** Run &#39;setenforce 1&#39; to reenable.
Give root password for maintenance
(or type Control-D to continue)
</code></pre><p><strong>CTRL + D</strong></p>
<p>*login*</p>
<p><strong>fsck -y</strong> Automatically attempt to fix any filesystem corruption errors automagically.</p>
<h3 id="replace-down-device">Replace down device</h3>
<p>Only a couple steps that might be on the test:</p>
<p>Remove serial cable if necessary or disable it - <strong>modify sys db failover.usetty01 value disable</strong></p>
<p>Update Master Key on the new device to what the old device had, so that the UCS loads</p>
<ul>
<li>Retrieve key from failed device - <strong>f5mku -K</strong></li>
<li>Replace master key on new unit <strong>f5mku -r <!-- raw HTML omitted --></strong></li>
</ul>
<h3 id="reload-configuration">Reload Configuration</h3>
<p><a href="https://support.f5.com/csp/article/K13030"target="_blank" rel="external nofollow noopener noreferrer">Article: K13030 - Forcing the mcpd process to reload the BIG-IP configuration</a></p>
<p>Binary file that is loaded on boot mismatches text file config (bigip.conf)</p>
<p><strong># touch /service/mcpd/forceload</strong></p>
<p><strong># reboot</strong></p>
<p>Logs after reboot</p>
<p>The configuration DB has been initialized with 26130560 bytes of memory</p>
<p>Configuration restored from binary image.</p>
<h3 id="single-configuration-file">Single Configuration File</h3>
<p>Single Configuration File (SCF) - Used to configure everything, in one file</p>
<p>bigip.conf - Configuration objects, VIPs, pools, profiles, iRules, authentication settings. Partitions have a separate ‘partitions’ folder at the root in the UCS file that have a bigip.conf in them.</p>
<p>bigip_base.conf - Base level configuration like VLANs, Self-IPs, Management IP settings, DSC settings, provisioning.</p>
<p>bigip_user.conf - User account config</p>
<p>bigip_script.conf - Custom iApp templates</p>
<p>SCF files are intended to help configure additional BIG-IP systems; SCFs are not intended to back up and restore a full BIG-IP system configuration or to restore a BIG-IP configuration to a later BIG-IP version.</p>
<ul>
<li>You want to replicate a configuration across multiple BIG-IP systems.</li>
<li>You want to migrate a configuration from one platform type to another (for example, from BIG-IP VE to a hardware platform).</li>
</ul>
<h4 id="saving-an-scf-file">Saving an SCF file</h4>
<p>Save the running configuration to an SCF</p>
<ul>
<li><strong>save sys config file</strong> &lt;SCF_filename&gt; <strong>[passphrase</strong> <!-- raw HTML omitted -->]</li>
</ul>
<p>Specify a custom name for the TAR file when saving the configuration to an unencrypted SCF:</p>
<ul>
<li><strong>save sys config file</strong> &lt;SCF_filename&gt; <strong>tar-file</strong> &lt;TAR-FILE_filename&gt;</li>
</ul>
<p>Note: When you use the tar-file option, the actual file does not have .tar file extension by default, unless specified. Additionally, you cannot specify the passphrase option when you use the tar-file option.</p>
<p>The SCF file and the TAR file are saved to the <strong>/var/local/scf/</strong> directory.</p>
<p>Files referenced [keys, external monitor files and external data group files] in config are saved in <strong>/var/local/scf/<!-- raw HTML omitted -->.tar</strong></p>
<h4 id="loading-a-scf">Loading a SCF</h4>
<p>When loading a SCF file, the current config is backed up in <strong>/var/local/scf/backup.scf</strong></p>
<p>You cannot load an SCF onto another software version</p>
<p>To install an SCF:</p>
<ul>
<li><strong>load sys config file &lt;SCF_filename&gt; [passphrase <!-- raw HTML omitted -->]</strong></li>
</ul>
<p>To load the unencrypted configuration with a TAR file that has a custom name:</p>
<ul>
<li><strong>load sys config file</strong> &lt;SCF_filename&gt; <strong>tar-file</strong> &lt;TAR-FILE_filename&gt;</li>
</ul>
<h3 id="diff-scf-files">Diff SCF files</h3>
<p><strong>show sys config-diff</strong> &lt;SCF_filename&gt; [SCF_filename_or_blank_for_running_config]</p>
<h3 id="ucs-contents--info">UCS Contents &amp; Info</h3>
<ul>
<li>BIG-IP Config files</li>
<li>Product licenses. New system should have a base license already. Use the -no-license flag. Or contact F5 to associate license with new F5 system</li>
<li>SSL certs/keys</li>
<li>User/passwords</li>
<li>DNS zone files</li>
<li>Allows restoring config to newer versions (10.x to 11.x)</li>
<li>Hardware must be the same or do <strong>no-platform-check</strong></li>
<li>Restoring configuration for an unlicensed module will error.</li>
<li>You can restore a configuration without the master key matching, but it won’t decrypt encrypted passphrases.</li>
</ul>
<p>root@(bigip1)(cfg-sync Standalone)(Active)(/Common)(tmos)# <strong>load sys ucs test.ucs</strong> ?</p>
<p>Options:</p>
<p><strong>no-license</strong>         This option mostly is for RMA use. It loads full configuration from a UCS file except the license file.</p>
<p><strong>no-platform-check</strong>  Bypass platform check.</p>
<p><strong>passphrase</strong>         Passphrase for (un)encrypting UCS.</p>
<p><strong>platform-migrate</strong>   Don&rsquo;t load or modify some objects specific to a particular device.</p>
<p><strong>reset-trust</strong>        Reset device and trust domain certificates and keys when loading a UCS.</p>
<h3 id="restore-without-passphrase">Restore without passphrase</h3>
<p><strong>0107102b:3: Master Key decrypt failure - decrypt failure - final</strong></p>
<p>Restore the UCS and then replace the encrypted passphrases with the unencrypted ones in the bigip.conf file</p>
<h2 id="--104a---identify-the-appropriate-methods-for-a-clean-install">- 1.04a - Identify the appropriate methods for a clean install</h2>
<h3 id="clean-install">Clean Install</h3>
<p>All mass-storage devices are wiped. Useful if the device no longer boots from any volumes.</p>
<h4 id="bootable-usb">Bootable USB</h4>
<p>Must be done on a Linux workstation</p>
<p>4G or larger USB</p>
<p>Dependencies</p>
<ul>
<li>
<p>Linux 2.6.x kernel</p>
</li>
<li>
<p>Perl 5.8 or later</p>
</li>
<li>
<p><strong>cpio</strong> - Manages CPIO archive files</p>
</li>
<li>
<p><strong>mke2fs - Creates Linux ext2 file system</strong></p>
</li>
<li>
<p><strong>extlinux - Lightweight bootloader that starts computers with the Linux kernel</strong></p>
</li>
</ul>
<p>Unmount, plug into BIG-IP and reboot: <strong>umount /mnt/<!-- raw HTML omitted --></strong></p>
<p>You will be in MOS and prompted to perform an <strong>automatic</strong> <strong>clean</strong> <strong>install</strong>, just hit <strong>[Enter]</strong></p>
<h4 id="usb-dvd-rom-drive---recommended">USB DVD-ROM Drive - Recommended</h4>
<p>Burn .iso image file to DVD.</p>
<p>You will be in MOS and prompted to perform an <strong>automatic</strong> <strong>clean</strong> <strong>install</strong>, just hit <strong>[Enter]</strong></p>
<h4 id="pxe-boot">PXE Boot</h4>
<p>Can be used to install when physical access is not available and to multiple systems simultaneously.</p>
<p>The server providing the image must be on the same network as the management port and provide HTTP, TFTP and DHCP services.</p>
<h2 id="--104b---identify-the-tmsh-sys-software-install-options-required-to-install-a-new-version">- 1.04b - Identify the TMSH sys software install options required to install a new version</h2>
<p><strong>install sys software</strong> { <strong>hotfix</strong> | <strong>image</strong> } <!-- raw HTML omitted --> (<strong>create-volume</strong>)  <strong>volume</strong> &lt;HDx.x&gt;</p>
<h2 id="--104c---identify-the-steps-required-to-upgrade-the-ltm-device-such-as-license-renewal-validation-of-upgrade-path-review-release-notes-etc">- 1.04c - Identify the steps required to upgrade the LTM device such as: license renewal, validation of upgrade path, review release notes, etc.</h2>
<h3 id="upgrade-code">Upgrade Code</h3>
<h4 id="preparation">Preparation</h4>
<p>Make sure there’s enough space on the hard drive. Use “df -h” - 50GB required</p>
<h4 id="download-code">Download code</h4>
<ul>
<li><strong>/shared/images</strong></li>
<li>GUI - System &gt; Software Management &gt; Image List &gt; Import&hellip;</li>
</ul>
<h4 id="verify-image">Verify image</h4>
<ul>
<li><strong>md5sum</strong> /shared/images/<!-- raw HTML omitted -->.iso</li>
</ul>
<h4 id="list-available-images-for-installation">List available images for installation</h4>
<p><strong>list sys software image</strong></p>
<p>System &gt; Software Management &gt; Image | Hotfix List</p>
<h4 id="install-to-inactive-volume">Install to inactive volume</h4>
<p><strong>install sys software</strong> { <strong>hotfix</strong> | <strong>image</strong> } <!-- raw HTML omitted --> [<strong>create-volume</strong>]  <strong>volume</strong> &lt;HDx.x&gt;</p>
<p><strong>GUI -</strong> System &gt; Software Management &gt; Image | Hotfix List &gt; Install &gt; HDx.x</p>
<p>Delete volume: <strong>delete sys software volume</strong> HD1.<!-- raw HTML omitted --></p>
<h4 id="reactivate-the-license-traffic-impacting">Reactivate the license (Traffic impacting)</h4>
<p>If you fail to do this, Reboot into the old volume and reactivate.</p>
<p>Terms</p>
<ul>
<li><strong>License Check date</strong>: A date specific to each software release - check online F5 solutions article</li>
<li><strong>Service Check date: Date from the last time activated or when the service contract ends, whichever is earlier.</strong></li>
</ul>
<p>If the service check date is missing or is earlier than the license check date, then the system initializes, but does not load the configuration. To allow the configuration to load, you must update the service check date in the license file by reactivating the system&rsquo;s license.</p>
<p><strong>TMSH</strong></p>
<p>Determine if re-activation is needed: <strong>grep “Service check date” /config/bigip.license</strong>. This should be a later date that the license check date of the software you’re upgrading to</p>
<p><strong>GUI</strong></p>
<p>System &gt; License &gt; Re-activate… &gt; Automatic selected &gt; Next</p>
<p>01070424:5: Full configuration initialization phase triggered.</p>
<p>01070427:5: Initialization complete. The MCP is up and running</p>
<h4 id="confirm-current-config-will-load-upon-reboot">Confirm Current Config will Load Upon Reboot</h4>
<p>load sys config verify</p>
<h4 id="copy-configuration-to-new-volume-and-reboot-into-it">Copy configuration to new volume and reboot into it</h4>
<p>TMSH</p>
<ul>
<li><strong>cpcfg &ndash;source=HD</strong>x.x <strong>HD</strong>x.x</li>
<li><strong>reboot volume HD</strong>x.x - OR - <strong>switchboot</strong></li>
</ul>
<p>GUI - System &gt; Software Management &gt; Boot Locations &gt; HDx.x &gt; Install Configuration [yes] &gt; Activate</p>
<h2 id="--104d---identify-how-to-copy-a-config-to-a-previously-installed-boot-locationslot">- 1.04d - Identify how to copy a config to a previously installed boot location/slot</h2>
<p><strong>cpcfg &ndash;source=HD</strong>x.x <strong>HD</strong>x.x</p>
<p>GUI - System &gt; Software Management &gt; Boot Locations &gt; HDx.x &gt; <strong>Install Configuration [yes]</strong> &gt; Activate</p>
<h2 id="--104e---identify-valid-rollback-steps-for-a-given-upgrade-scenario">- 1.04e - Identify valid rollback steps for a given upgrade scenario</h2>
<p>Reboot into the old volume</p>
<ul>
<li><strong>reboot volume HD</strong>x.x - OR - <strong>switchboot</strong></li>
</ul>
<p>Objective 1.05 Given a scenario, determine the appropriate upgrade steps required to minimize application outages</p>
<h2 id="--105a---explain-how-to-upgrade-an-ltm-device-from-the-gui">- 1.05a - Explain how to upgrade an LTM device from the GUI</h2>
<p>See above</p>
<h2 id="--105b---describe-the-effect-of-performing-an-upgrade-in-an-environment-with-device-groups-and-traffic-groups">- 1.05b - Describe the effect of performing an upgrade in an environment with device groups and traffic groups</h2>
<p>Move traffic groups to the active unit before upgrading the standby</p>
<h2 id="--105c---explain-how-to-perform-an-upgrade-in-a-high-availability-group">- 1.05c - Explain how to perform an upgrade in a high availability group</h2>
<p>Upgrade secondary / standby first</p>
<p>Failover to secondary - run sys failover standby</p>
<p>Upgrade primary / standby</p>
<p>Objective 1.06 Describe the benefits of custom alerting within an LTM environment</p>
<h2 id="--106a---describe-how-to-specify-the-oids-for-alerting">- 1.06a - Describe how to specify the OIDs for alerting</h2>
<p>alert <!-- raw HTML omitted --> “<!-- raw HTML omitted -->” {<br>
snmptrap OID=”.1.3.6.1.4.1.3375.2.4.0.&lt;<strong>300 - 999&gt;</strong>”<br>
}</p>
<h2 id="--106b---explain-how-to-log-different-levels-of-local-traffic-message-logs">- 1.06b - Explain how to log different levels of local traffic message logs</h2>
<p>TMSH - <strong>modify sys db <!-- raw HTML omitted -->.level value <!-- raw HTML omitted --></strong></p>
<p>GUI - System &gt; Logs &gt; Configuration &gt; Options</p>
<p>The severity level is in between the colons</p>
<p>Jul 22 07:38:28 nusiaalbipve02 mcpd[1844]: 01070638:5: Pool member 10.0.0.154:80 monitor status forced down.</p>
<h3 id="modify-linux-host-syslog-levels">Modify Linux host syslog levels</h3>
<ul>
<li><strong>list sys syslog all-properties</strong></li>
<li><strong>modify sys syslog <!-- raw HTML omitted -->-from <!-- raw HTML omitted -->-to <!-- raw HTML omitted --></strong></li>
<li><strong>modify sys syslog daemon-from warning daemon-to emerg</strong></li>
</ul>
<h2 id="--106c---explain-how-to-trigger-custom-alerts-for-testing-purposes">- 1.06c - Explain how to trigger custom alerts for testing purposes</h2>
<h3 id="built-in-alerts">Built-in Alerts</h3>
<ol>
<li>
<p>Find trap in <strong>/etc/alertd/alert.conf</strong></p>
</li>
<li>
<p>Grep for that alert for the full logging info-</p>
<ol>
<li><strong>cd /etc/alertd/</strong></li>
<li><strong>grep <!-- raw HTML omitted --> *.h</strong></li>
</ol>
</li>
<li>
<p>Find Log Info</p>
<ol>
<li>0 LOG_NOTICE 01070640 BIGIP_MCPD_MCPDERR_NODE_ADDRESS_MON_STATUS &ldquo;Node %s address %s monitor status %s.&rdquo;</li>
<li>Facility 0</li>
<li>Log Level: Notice</li>
<li>Alert code: 01070640</li>
<li>Descriptive Message: &ldquo;Node %s address %s monitor status %s.&rdquo;</li>
</ol>
</li>
</ol>
<p>Use <strong>logger</strong> to generate an alert - **logger -p local0.notice “**01070640:5: Node 10.128.20.20 monitor status down.”</p>
<p>Objective 1.07 Describe how to set up custom alerting for an LTM device</p>
<h2 id="--107a---list-and-describe-custom-alerts-snmp-email-and-remote-syslog">- 1.07a - List and describe custom alerts: SNMP, email and Remote Syslog</h2>
<h3 id="configure-syslog">Configure Syslog</h3>
<p>System &gt; Logs &gt; Configuration &gt; Remote Logging</p>
<h3 id="snmp">SNMP</h3>
<p>Place custom MIB files in <strong>/config/snmp/<!-- raw HTML omitted -->.tcl</strong></p>
<p>Default MIBs under <strong>/usr/share/snmp/mibs</strong></p>
<h4 id="traps">Traps</h4>
<p>Default SNMP Traps - <strong>/etc/alertd/alert.conf</strong> (Don’t add or remove traps from here)<br>
User-defined SNMP Traps - <strong>/config/user_alert.conf</strong></p>
<p>System &gt; SNMP &gt; Traps &gt; Destination</p>
<p>System &gt; SNMP &gt; Traps &gt; Configuration</p>
<h4 id="custom-traps">Custom Traps</h4>
<ol>
<li>Create backup of <strong>/config/user_alert.conf</strong></li>
<li>Open and add new SNMP traps in proper format</li>
</ol>
<p>alert <!-- raw HTML omitted --> “<!-- raw HTML omitted -->” {<br>
snmptrap OID=”.1.3.6.1.4.1.3375.2.4.0.&lt;<strong>300 - 999</strong>&gt;”<br>
}</p>
<ol start="3">
<li>Message -  A syslog message that will match and send the trap. Can use literal or regular expressions. For regex, put parentheses around the expression - (.*) for example.</li>
<li>300 - 999 - A unique OID, don’t use ones that are in F5-BIGIP-COMMON-MIB.txt file</li>
<li>The <strong>user_alert.conf</strong> file is appended to the <strong>alertd.conf</strong> file upon service start, so may need to restart <strong>snmpd</strong> service to take effect</li>
</ol>
<h3 id="email-snmp-traps">Email SNMP traps</h3>
<p><strong>ssmtp</strong> is the process for emailing</p>
<p><strong>modify sys outbound-smtp mailhub</strong> <a href="mail-server:port">mail-server:port</a></p>
<p><strong>/config/user_alert.conf</strong></p>
<p>alert <!-- raw HTML omitted --> “<!-- raw HTML omitted -->” {<br>
snmptrap OID=”.1.3.6.1.4.1.3375.2.4.0.&lt;<strong>300 - 999</strong>&gt;”,</p>
<p>email toaddress=&ldquo;<a href="mailto:dg-network@config.com">dg-network@config.com</a>, <a href="mailto:noc@config.com">noc@config.com</a>&rdquo;<br>
fromaddress=&ldquo;root&rdquo; ←- The FQDN will be the hostname<br>
body=&ldquo;There’s an alert!&rdquo;</p>
<p>}</p>
<p>Save file and restore permissions -  <strong>chmod 444</strong></p>
<p>Restart alertd and snmpd - <strong>restart sys service alertd, restart sys service snmpd</strong></p>
<p><strong>Test Email</strong></p>
<p><strong>echo “<strong>ssmtp test mail</strong>” | mail -vs “<strong>Test email for SOL13180</strong>”</strong> <a href="mailto:myemail@mydomain.com">myemail@mydomain.com</a></p>
<h2 id="--107b---identify-the-location-of-custom-alert-configuration-files">- 1.07b - Identify the location of custom alert configuration files</h2>
<p>/config/user_alert.conf</p>
<h2 id="--107c---identify-the-available-levels-for-local-traffic-logging">- 1.07c - Identify the available levels for local traffic logging</h2>
<p>local0 - /var/log/ltm</p>
<p>local4 - /var/log/ltm</p>
<p>Emergency (0)</p>
<p>Alert (1)</p>
<p>Critical (2)</p>
<p>Error (3)</p>
<p>Warning (4)</p>
<p>Notifications (5)</p>
<p>Information (6)</p>
<p>Debug (7)</p>
<p><strong>E</strong>very <strong>A</strong>lley <strong>C</strong>at <strong>E</strong>ats <strong>W</strong>atery <strong>N</strong>oodles <strong>I</strong>n <strong>D</strong>oors</p>
<p>Section 2 - Identify and Resolve Application Issues</p>
<p>Objective 2.01 Determine which iRule to use to resolve an application issue</p>
<h2 id="--201a---determine-which-irule-events-and-commands-to-use">- 2.01a - Determine which iRule events and commands to use</h2>
<p>CLIENT_ACCEPTED - Connection entry added 3-way handshake completes for Standard VIP, initial SYN for Performance L4.</p>
<p>LB_SELECTED - Pool member selected.</p>
<p>HTTP_REQUEST - Client request headers</p>
<p>HTTP_RESPONSE - Server response</p>
<h2 id="--201b---given-a-specific-irule-event-determine-what-commands-are-available">- 2.01b - Given a specific iRule event determine what commands are available</h2>
<h3 id="events">Events</h3>
<h4 id="lb_selected">LB_SELECTED</h4>
<p>active_members</p>
<p>active_members -list: Determine how many members are currently <strong>available</strong> in a pool by returning IP and port numbers.</p>
<h3 id="operators">Operators</h3>
<p>Relational: contains, equals, starts_with</p>
<p>Logical: and, if, else</p>
<h3 id="commands">Commands</h3>
<p>Statement: <strong>pool, node, virtual</strong></p>
<p>Query: <strong>IP::remote_addr, IP::addr, HTTP::host</strong></p>
<p>Data manipulation: <strong>HTTP::header remove</strong></p>
<p>Utility: <strong>URI::decode</strong></p>
<p>HTTP::method</p>
<p>HTTP::request</p>
<h4 id="httpheader">HTTP::header</h4>
<p>HTTP::header value <!-- raw HTML omitted --> - Returns value from header name</p>
<p>HTTP::header values <!-- raw HTML omitted --> - Returns list of values from header name.</p>
<p>HTTP::header names</p>
<p>HTTP::header exists <!-- raw HTML omitted --></p>
<p>HTTP::header insert [&ldquo;lws&rdquo;] [[list] <!-- raw HTML omitted --> <!-- raw HTML omitted --> <!-- raw HTML omitted --> <!-- raw HTML omitted --> ] - ‘“lws”’, the system adds linear white space to long header values.</p>
<p>HTTP::header is_redirect</p>
<p>HTTP::header replace <!-- raw HTML omitted --> [<!-- raw HTML omitted -->]</p>
<p>HTTP::header remove <!-- raw HTML omitted --></p>
<h4 id="httpuri">HTTP::uri</h4>
<p>Full URI including query</p>
<h4 id="httppath">HTTP::path</h4>
<p>HTTP_REQUEST, SERVER_CONNECTED &amp; more</p>
<p>/main/index.jsp</p>
<p>Does not include the query (?test.xml)</p>
<h4 id="httpquery">HTTP::query</h4>
<p>Objective 2.02 Explain the functionality of a simple iRule</p>
<p>iRules are processed in order in which they appear in the GUI and CMD</p>
<p>Events are processed in a linear fashion so all CLIENT_ACCEPTED events in all iRules finish processing before the first HTTP_REQUEST event can fire.</p>
<p>Once one Event in all iRules is processed, action is taken if matched</p>
<p>HTTP::redirect takes precedence over pool command</p>
<p><strong>&lt;Insert iRules here that direct to pools or nodes based on URI, host header, or IP address that even do snat as well. Use switch, if, elseif, starts_with, contains&gt;</strong></p>
<h2 id="--202a---interpret-information-in-irule-logs-to-determine-the-irule-and-irule-events-where-they-occurred">- 2.02a - Interpret information in iRule logs to determine the iRule and iRule events where they occurred</h2>
<p>Logging in an iRule</p>
<p>log local0.<!-- raw HTML omitted --> “log here!”</p>
<p>Levels</p>
<ul>
<li>emerg</li>
<li>alert</li>
<li>crit</li>
<li>error</li>
<li>warn</li>
<li>notice</li>
<li>info</li>
<li>debug</li>
</ul>
<h2 id="--202b---describe-the-results-of-irule-errors">- 2.02b - Describe the results of iRule errors</h2>
<p>Error Message: 01220001:3: TCL error</p>
<ul>
<li>Stops iRule processing and may send a TCP RST</li>
<li>Can happen if the wrong variable is unset at the end</li>
</ul>
<p>Objective 2.03 Given specific traffic and configuration containing a simple iRule determine the result of the iRule on the traffic</p>
<p><a href="https://clouddocs.f5.com/api/irules/event.html"target="_blank" rel="external nofollow noopener noreferrer">event</a><br>
<a href="https://clouddocs.f5.com/api/irules/switch.html"target="_blank" rel="external nofollow noopener noreferrer">switch</a><br>
<a href="https://clouddocs.f5.com/api/irules/return.html"target="_blank" rel="external nofollow noopener noreferrer">return</a><br>
<a href="https://clouddocs.f5.com/api/irules/class.html"target="_blank" rel="external nofollow noopener noreferrer">class</a></p>
<p>The * in front of a URL will make it so only the URL with stuff in front of that asterisk will match. If there is nothing in front, then that entry won’t be matched. Example, *default.com, make sure to add “default.com” to the rule.</p>
<p>An asterisk afterwards works as ‘contains’</p>
<p>glob - Allows the use of limited regex on URL/URI’s (* or  ?) that is more performant</p>
<p>The ‘-‘ hyphen is an OR statement</p>
<p>A “;” semicolon will let you have two commands on one line</p>
<ul>
<li>Will it only work if there’s one event in the iRule?</li>
</ul>
<p>return - Exit from current event in the <em>current</em> iRule.</p>
<p>event disable [all] - Stop going through the current event in all iRules, Stop going through all iRule events on this connection</p>
<p>-- = Stop option processing - useful if the item might start with a hyphen. Put before ‘-value’</p>
<p>“” = Blank value</p>
<p>The &ldquo;switch -glob&rdquo; and &ldquo;string match&rdquo; commands use a &ldquo;glob style&rdquo; matching that is a small subset of regular expressions, but allows for wildcards and sets of strings.</p>
<p>Make use of the &ldquo;equals&rdquo;, &ldquo;contains&rdquo;, &ldquo;starts_with&rdquo;, and &ldquo;ends_with&rdquo; iRule operators, or the glob matching mentioned above.  They perform significantly faster, and do the exact same thing as regex. Regular expressions are very CPU intensive and should only be used when there are no other options</p>
<p>Use ‘switch’ instead of multiple ‘if’ lines, unless you need more than one condition.</p>
<p>switch “-exact” is the default if no arguments are specified</p>
<p>switch -glob - Supports small subset of regex (same as ‘string match’)</p>
<p>The switch section can contain a ‘default’ action labeled as such, like forwarding to a pool or dropping the packet if there are no matches.</p>
<p><strong>string match</strong> ?-nocase? <em>pattern string</em></p>
<ul>
<li>See if pattern matches string; return 1 if it does, 0 if it does not. If -nocase is specified, then the pattern attempts to match against the string in a case insensitive manner. For the two strings to match, their contents must be identical except that the following special sequences may appear in pattern:</li>
</ul>
<p>* - Matches any sequence of characters in string, including a null string.</p>
<p>? - Matches any single character in string</p>
<p>class - Allows querying of data-groups</p>
<p>class match - Sees if item matches in the data-group</p>
<h3 id="example-irules">Example iRules</h3>
<pre tabindex="0"><code>when HTTP_REQUEST {
    switch -glob [string tolower [HTTP::uri]] {
        # only match ‘/example/blah’ and not ‘/example/’
        &#34;/example/*&#34; { 
            pool server4
            snat 10.0.0.1 
        }
        # only match literal URI with nothing after it
        &#34;/example4&#34; { 
            pool server3
            snat 10.0.0.2 
        }
        default { 
            pool default_pool 
        }
    }
}
</code></pre><p>Example 2</p>
<pre tabindex="0"><code>when HTTP_REQUEST {
    if { [class match [IP::client_addr] equals &#34;localusers_dg&#34; ] } {
        pool server2
    }
    elseif { [class match [IP::client_addr] equals &#34;remote_users_dg&#34;] } {
        pool remote_pool
        snat 10.2.2.2
    elseif { [string match [IP::client_addr] equals &#34;1.1.1.1&#34;] } {
        drop
    else
      drop
    }
}
</code></pre><h2 id="--203a---use-an-irule-to-resolve-application-issues-related-to-traffic-steering-andor-application-data">- 2.03a - Use an iRule to resolve application issues related to traffic steering and/or application data</h2>
<h3 id="insecure-content-on-page">Insecure Content on Page</h3>
<p>Webpages/HTML responses contain links to http pages. You can use a Stream profile or/and iRule to replace http with https in the text of the HTML response page.</p>
<p>Do this in HTTP_RESPONSE<br>
<a href="https://support.f5.com/csp/article/K31100432#irule"target="_blank" rel="external nofollow noopener noreferrer">https://support.f5.com/csp/article/K31100432#irule</a></p>
<pre tabindex="0"><code>when HTTP_REQUEST {
   # Disable the stream filter for all requests
   STREAM::disable
   # LTM does not decompress response content, so if the server has compression enabled
   # and it cannot be disabled on the server, we can prevent the server from
   # sending a compressed response by removing the compression offerings from the client
   HTTP::header remove &#34;Accept-Encoding&#34;
}
when HTTP_RESPONSE {
   # Check if response type is text
      if {[HTTP::header value Content-Type] contains &#34;text&#34;}{
      # Replace http:// with https://
      STREAM::expression {@http://@https://@}
      # Enable the stream filter for this response only
      STREAM::enable
      }
}
</code></pre><h3 id="allow-internet-explorer-to-download-files-through-ssl">Allow Internet Explorer to download files through SSL</h3>
<p><a href="https://support.f5.com/csp/article/K8093"target="_blank" rel="external nofollow noopener noreferrer">Article: K8093 - Using iRules to modify Cache-control headers to allow Internet Explorer to download files through SSL</a></p>
<p>These headers are used to prevent proxy devices from caching a local copy of the file when handling connections.</p>
<ul>
<li>Cache-control:no-store, Cache-control:no-cache, or Pragma:no-cache</li>
</ul>
<p>Use this to fix the problem and allow the files to be downloaded:</p>
<pre tabindex="0"><code>when HTTP_RESPONSE {
   if { [HTTP::header value Content-Type] contains &#34;application/pdf&#34; } {
      HTTP::header replace Pragma public
      HTTP::header replace Cache-Control public
   }
   elseif { [HTTP::header value Content-Type] contains &#34;application/vnd.ms-excel&#34; } {
      HTTP::header replace Pragma public
      HTTP::header replace Cache-Control public
   }
   elseif { [HTTP::header value Content-Type] contains &#34;application/msword&#34; } {
      HTTP::header replace Pragma public
      HTTP::header replace Cache-Control public }
   else {
      return
   }
}
</code></pre><h2 id="objective-204-interpret-avr-information-to-identify-performance-issues-or-application-attacks">Objective 2.04 Interpret AVR information to identify performance issues or application attacks</h2>
<h2 id="--204a---explain-how-to-modify-profile-settings-using-information-from-the-avr">- 2.04a - Explain how to modify profile settings using information from the AVR </h2>
<p>Maybe you could increase the buffers on the TCP profile</p>
<h2 id="--204b---explain-how-to-use-advanced-filters-to-narrow-output-data-from-avr">- 2.04b - Explain how to use advanced filters to narrow output data from AVR </h2>
<p>Statistics &gt; Analytics &gt; HTTP &gt; Custom Page &gt; Add Widget</p>
<p><strong>Capture Options</strong></p>
<p>Choose what to capture</p>
<ul>
<li>Request and/or response that includes: Headers, Body, or All</li>
</ul>
<p>Choose capture filters</p>
<ul>
<li>Virtual Server</li>
<li>Node</li>
<li>Protocols</li>
<li>HTTP Response Codes</li>
<li>HTTP Methods</li>
<li>URL</li>
<li>User Agent</li>
<li>Client IP</li>
<li>Requests and/or Responses strings</li>
</ul>
<h2 id="--204c---identify-potential-latency-increases-within-an-application">- 2.04c - Identify potential latency increases within an application</h2>
<p>See if the latency goes up</p>
<p>Objective 2.05 Interpret AVR information to identify LTM device misconfiguration</p>
<p>How can AVR project misconfiguration?</p>
<h2 id="--205a---explain-how-to-use-avr-to-trace-application-traffic">- 2.05a - Explain how to use AVR to trace application traffic </h2>
<p>Statistics &gt; Analytics &gt; HTTP &gt; Overview</p>
<p>Page Load Time analytics works on browsers that meet the following requirements:</p>
<ul>
<li>Navigation Timing by W3C</li>
<li>Accepts cookies from visited site</li>
<li>JavaScript enabled for site</li>
</ul>
<p><strong>The following can only be changed in the default ‘analytics’ profile</strong></p>
<p>Transaction Sampling (Default profile)</p>
<ul>
<li>Sampling improves system performance.</li>
<li>F5 recommends that you enable sampling if you generally use more than 50 percent of the system CPU resources, or if you have at least 100 transactions in 5 minutes for each entity.</li>
<li>Cannot Capture traffic if Enabled.</li>
</ul>
<p><strong>View Captures</strong> - System &gt; Logs &gt; Captured Transactions. Limited to 1000 entries</p>
<p><strong>Notification Type</strong></p>
<ul>
<li>Syslog (System &gt; Logs &gt; Local Traffic)</li>
<li>SNMP - Sys &gt; SNMP &gt; Traps &gt; Destination (Auto sets up syslog)</li>
<li>E-mail - SMTP under analytics profile</li>
</ul>
<h2 id="--205b---explain-how-latency-trends-identify-application-tier-bottlenecks">- 2.05b - Explain how latency trends identify application tier bottlenecks</h2>
<p>If the latency gets higher, see if pool members have been failing which results in others taking more load.</p>
<p>If there isn’t SSL offloading, try it to reduce latency/server load.</p>
<p>Objective 2.06 Given a set of headers or traces, determine the root cause of an HTTP/HTTPS application problem</p>
<p><strong>HTTP/0.9</strong></p>
<ul>
<li>GET only</li>
<li>One request per connection</li>
</ul>
<p><strong>HTTP/1.0</strong></p>
<ul>
<li>
<p>Introduced media</p>
</li>
<li>
<p>One request per connection</p>
</li>
<li>
<p>Backwards compatible with HTTP/0.9</p>
</li>
<li>
<p>Only 1 domain per IP, cannot specify Host</p>
</li>
</ul>
<p><strong>HTTP/1.1</strong></p>
<ul>
<li>Backwards compatible with HTTP/0.9 and 1.0</li>
<li>Host header required</li>
</ul>
<p>Improvements (Mostly performance)</p>
<ul>
<li><strong>Multiple Hostname Support</strong>: Multiple domains per IP via Host header (required)</li>
<li><strong>Persistent Connections: Multiple requests per TCP connection</strong></li>
<li><strong>Cache and Proxy Support</strong></li>
</ul>
<h2 id="--206a---explain-how-to-interpret-response-codes">- 2.06a - Explain how to interpret response codes</h2>
<table>
<thead>
<tr>
<th style="text-align:center"></th>
<th style="text-align:center"></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"><strong>Status Code Format</strong></td>
<td style="text-align:center"><strong>Meaning</strong></td>
<td><strong>Description</strong></td>
</tr>
<tr>
<td style="text-align:center"><strong>1xx</strong></td>
<td style="text-align:center"><strong>Informational Message</strong></td>
<td>Provides general information; does not indicate success or failure of a request.</td>
</tr>
<tr>
<td style="text-align:center"><strong>2xx</strong></td>
<td style="text-align:center"><strong>Success</strong></td>
<td>The method was received, understood and accepted by the server.</td>
</tr>
<tr>
<td style="text-align:center"><strong>3xx</strong></td>
<td style="text-align:center"><strong>Redirection</strong></td>
<td>The request did not fail outright, but additional action is needed before it can be successfully completed.</td>
</tr>
<tr>
<td style="text-align:center"><strong>4xx</strong></td>
<td style="text-align:center"><strong>Client Error</strong></td>
<td>The request was invalid, contains bad syntax or could not be completed for some other reason that the server believes was the client&rsquo;s fault.</td>
</tr>
<tr>
<td style="text-align:center"><strong>5xx</strong></td>
<td style="text-align:center"><strong>Server Error</strong></td>
<td>The request was valid but the server was unable to complete it due to a problem of its own.</td>
</tr>
</tbody>
</table>
<p>If the code received is not understood by the client, like 491 for example, a 400 code is displayed. The x00 codes are generic.</p>
<p>400 - Bad Request - Missing Host header or bad request</p>
<p>401 - Method Not Allowed</p>
<table>
<thead>
<tr>
<th style="text-align:center"></th>
<th style="text-align:center"></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"><strong>500</strong></td>
<td style="text-align:center">Internal Server Error</td>
<td>Generic error message indicating that the request could not be fulfilled due to a server problem.</td>
</tr>
<tr>
<td style="text-align:center"><strong>501</strong></td>
<td style="text-align:center">Not Implemented</td>
<td>The server does not know how to carry out the request, so it cannot satisfy it.</td>
</tr>
<tr>
<td style="text-align:center"><strong>502</strong></td>
<td style="text-align:center">Bad Gateway</td>
<td>The server, while acting as a gateway or proxy, received an invalid response from another server it tried to access on the client&rsquo;s behalf.</td>
</tr>
<tr>
<td style="text-align:center"><strong>503</strong></td>
<td style="text-align:center">Service Unavailable</td>
<td>The server is temporarily unable to fulfill the request for internal reasons. This is often returned when a server is overloaded or down for maintenance.</td>
</tr>
<tr>
<td style="text-align:center"><strong>504</strong></td>
<td style="text-align:center">Gateway Timeout</td>
<td>The server, while acting as a gateway or proxy, timed out while waiting for a response from another server it tried to access on the client&rsquo;s behalf.</td>
</tr>
</tbody>
</table>
<h2 id="--206b---explain-the-function-of-http-headers-within-different-http-applications-cookies-cache-control-vary-content-type--host----207c---predict-the-browser-caching-behavior-when-application-data-is-received-headers-and-html">- 2.06b - Explain the function of HTTP headers within different HTTP applications (Cookies, Cache Control, Vary, Content Type &amp; Host) / - 2.07c - Predict the browser caching behavior when application data is received (headers and HTML)</h2>
<p><strong><em>Cache-Control</em></strong> <em>-</em> Directions to cache or not, a response or request.</p>
<ul>
<li>This overrides any default caching control for a device</li>
<li>Pragma header is the HTTP/1.0 equivalent</li>
</ul>
<table>
<thead>
<tr>
<th style="text-align:center"></th>
<th style="text-align:center"></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"><strong>Cache-Control Directive</strong></td>
<td style="text-align:center"><strong>HTTP Message Type</strong></td>
<td><strong>Description</strong></td>
</tr>
<tr>
<td style="text-align:center"><strong><em>no-cache</em></strong></td>
<td style="text-align:center"><em>Request or Response</em></td>
<td>The cache must check with the server to ensure that the cached data is still valid.</td>
</tr>
<tr>
<td style="text-align:center"><strong><em>public</em></strong></td>
<td style="text-align:center"><em>Response</em></td>
<td>May be cached by any cache, including a shared one (a cache used by many clients).</td>
</tr>
<tr>
<td style="text-align:center"><strong><em>private</em></strong></td>
<td style="text-align:center"><em>Response</em></td>
<td>Intended for only a particular user and should not be placed into a shared cache.</td>
</tr>
<tr>
<td style="text-align:center"><strong><em>no-store</em></strong></td>
<td style="text-align:center"><em>Request or Response</em></td>
<td>Should not be stored in a cache. (a malicious cache operator could simply ignore the directive.)</td>
</tr>
<tr>
<td style="text-align:center"><strong><em>max-age</em></strong></td>
<td style="text-align:center"><em>Request or Response</em></td>
<td>In a request, indicates that the client is willing to accept a response whose age is no greater than the value specified. In a response, indicates the maximum age of the response before it is considered “stale”—this is an alternative to the use of the <em>Expires</em> header, which can fall victim to clock skew, and takes precedence over it.</td>
</tr>
<tr>
<td style="text-align:center"><strong><em>min-fresh</em></strong></td>
<td style="text-align:center"><em>Request</em></td>
<td>Specifies that the client wants a response that is not only not stale at the time the request is received, but that will remain “fresh” for the specified number of seconds.</td>
</tr>
<tr>
<td style="text-align:center"><strong><em>max-stale</em></strong></td>
<td style="text-align:center"><em>Request</em></td>
<td>If sent without a parameter, indicates that the client is willing to accept a stale reply (one that has expired). If a numeric parameter is included, it indicates how stale, in seconds, the response may be.</td>
</tr>
</tbody>
</table>
<p><strong><em>If-Match</em></strong>: Tells the server to respond if the ETags match</p>
<p><strong><em>If-Modified-Since</em>**</strong><em>:</em>** Return the requested entity only if the resource was modified since &lt;date/time&gt;. Server will respond with “304 Not Modified” if it hasn’t been.</p>
<p><strong><em>If-None-Match</em>**</strong><em>:</em>** Respond only if the ETag does **<em>not</em>** match.</p>
<p><strong><em>Content-Type:</em></strong> Media type and subtype</p>
<h3 id="meta-headers">META Headers</h3>
<p>Included in an HTML file. “HTTP-EQUIV” meta tags are just like HTTP headers and take precedence.</p>
<p>Most problematic:</p>
<ul>
<li><strong><em>no-cache</em></strong>: Forces a refresh even if it hasn’t changed</li>
<li><strong><em>refresh</em></strong>: Used to mimic a 302 redirect, but causes the browser to revalidate all objects referenced by the tag.</li>
</ul>
<h3 id="etag">ETag</h3>
<p>An identifier for a resource. If resource changes, ETag must change. Helps with caching.</p>
<h3 id="http-vary-header-and-caching">HTTP Vary Header and Caching</h3>
<p><a href="https://support.f5.com/csp/article/K5157?sr=46612722"target="_blank" rel="external nofollow noopener noreferrer">BIG-IP HTTP Cache and HTTP Vary header Functionality</a></p>
<p><a href="https://clouddocs.f5.com/api/irules/CACHE__userkey.html"target="_blank" rel="external nofollow noopener noreferrer">CACHE::userkey</a></p>
<p><strong>Vary</strong>: Prevent duplicate cache entries. A header that the originating web server sends, intended for the caching device to read.</p>
<p>It contains things like User-Agent, if a client requests the same resource twice, with the same User-Agent, then don’t validate it</p>
<p>with me and just serve them the cached resource. This can cause duplicate entries of the same resource if the two users have different User-Agent strings.</p>
<ul>
<li>Only <strong>User-Agent</strong> and <strong>Accept-Encoding</strong> are recognized</li>
</ul>
<p>iRule commands to help with this issue:</p>
<ul>
<li><strong>CACHE::userkey <!-- raw HTML omitted --> - Creates a user-defined caching group. Overrides <em>Vary</em> header.</strong></li>
<li><strong>CACHE::useragent - Can specify a group of <em>User-Agents</em> to serve cached content to for the same request</strong></li>
<li><strong>CACHE::acceptencoding - Can specify a group of <em>Accept-Encoding</em> headers __to serve cached content to for the same request, like gzip and deflate would be the same cached entry instead of separate (duplicate)</strong></li>
</ul>
<p>You can also use those commands even if the <em>Vary</em> header isn’t present.</p>
<h3 id="caching-commands---show-and-delete-entries">Caching Commands - Show and Delete Entries</h3>
<p><strong>show ltm profile ramcache</strong> &lt;profile_name&gt; <strong>max-response</strong> &lt;how_many_entries_to_display&gt;</p>
<p><strong>show ltm profile ramcache</strong> &lt;profile_name&gt; <strong>host</strong> &lt;vip_address:port&gt;</p>
<p><strong>delete ltm profile ramcache</strong> &lt;profile_name&gt; <strong>host</strong> &lt;vip_address:port&gt; <strong>uri /&lt;object_name&gt;</strong></p>
<p><strong>delete ltm profile ramcache</strong> &lt;profile_name&gt; ****- Deletes all entries</p>
<h2 id="--206c---explain-http-methods-get-post-etc">- 2.06c - Explain HTTP methods (GET, POST, etc.)</h2>
<h3 id="http-methods">HTTP Methods</h3>
<p><strong>GET:</strong> Proxy servers can intercept this and serve the data for you via caching. Conditions can be sent that require certain things, like <em>If-Modified-Since</em> or <em>If-Match</em>. The server will only reply if those conditions are</p>
<p>then met. This is called a <em>conditional</em> GET. You can also request certain parts of a large file with a <em>partial</em> GET, which will have the <em>Range</em> header inserted.</p>
<p><strong>HEAD:</strong> Used to check if the resource is what is wanted, replies with headers only</p>
<p><strong>POST:</strong> Used to submit data from the client. The query string is sent in the body of the submission of POST, instead of the header like GET does. The ‘? is not included</p>
<p><strong><em>OPTIONS (New in HTTP/1.1):</em></strong> <em>Requests what communication options are available for a URI or specify an asterisk * if about the server itself.</em></p>
<p><strong><em>PUT:</em></strong> <em>Specifies to copy a file to a server. Usually FTP is used so this isn’t common. The difference with this and POST, is that POST specified the program to process the request, while this specifies the URI to</em></p>
<p><em>where the store the file.</em></p>
<p><strong><em>DELETE:</em></strong> <em>Requests that the specified resource be deleted</em></p>
<p><strong><em>TRACE:</em></strong> <em>Requests a copy of the client’s request for diagnostic purposes.</em></p>
<p><strong><em>Idempotent Methods:</em></strong> <em>Requests that have the same result no matter how many times they are issued. Usually GET and HEAD.</em></p>
<h2 id="--206d---explain-how-to-decode-post-data">- 2.06d - Explain how to decode POST data.</h2>
<h3 id="decode-post-data">Decode POST Data</h3>
<p>POST has the query string sent in the Body of the submission of POST, instead of the header like GET does. The ‘? is not included.</p>
<ul>
<li>user=joe+and+bob&amp;food=burger</li>
</ul>
<p>URL’s must be ASCII, characters not in ASCII must be encoded into such. Encoded will be % followed by two hexadecimal digits.</p>
<p>Spaces cannot be in the URL</p>
<p>“ “ = + or %20</p>
<p>@ = %40</p>
<p><strong>URI::decode</strong> Is a function used to decode a URI, under HTTP_REQUEST</p>
<h2 id="--207a---investigate-the-cause-of-a-specific-response-code"><del>- 2.07a - Investigate the cause of a specific response code</del></h2>
<h2 id="--207b---investigate-the-cause-of-an-ssl-handshake-failure">- 2.07b - Investigate the cause of an SSL Handshake failure</h2>
<h3 id="handshake-failures">Handshake Failures</h3>
<p>Date/time incorrect on either side causes conflicts in certificate validity.</p>
<p>The protocol versions are identified as follows</p>
<ul>
<li>SSLv3 - 3.0</li>
<li>TLS1.0 - 3.1</li>
<li>TLS1.1 - 3.2</li>
<li>TLS1.2 - 3.3</li>
</ul>
<h3 id="ssldump-failure-examples">SSLDUMP failure examples</h3>
<h5 id="server-rejects-clients-protocol-version">Server rejects client’s protocol version</h5>
<pre tabindex="0"><code>S&gt;CV0.0 Alert
level fatal
value handshake_failure
</code></pre><h5 id="server-rejects-clients-cipher-suites">Server rejects client’s cipher suites</h5>
<pre tabindex="0"><code>C&gt;SV3.2 Handshake
ClientHello
Version 3.2
TLS_&lt;ciphers&gt;

S&gt;CV3.2 Alert
level fatal
value handshake_failure
</code></pre><h5 id="device-does-not-accept-ssl">Device does not accept SSL</h5>
<pre tabindex="0"><code>C&gt;SV3.1 Handshake
ClientHello
Version3.2

period of waiting

C&gt;S TCP FIN
</code></pre><p>Enable SSL debug in /var/log/ltm -  <strong>modify sys db log.ssl.level value debug</strong> (Default is Warning)</p>
<p><del>Objective 2.07 Given a set of headers or traces, determine a solution to an HTTP/HTTPS application problem</del></p>
<p><del>- 2.07a - Investigate the cause of a specific response code</del></p>
<p><del>- 2.07b - Investigate the cause of an SSL Handshake failure</del></p>
<p><del>- 2.07c - Predict the browser caching behavior when application data is received (headers and HTML)</del></p>
<p><del>Objective 2.08 Given a direct trace, a trace through the LTM device, and other relevant information, compare the traces to determine the root cause of an HTTP/HTTPS application problem</del></p>
<p><del>- 2.08a - Given a failed HTTP request and LTM configuration data determine if the connection is failing due to the LTM configuration</del></p>
<h2 id="objective-209-given-a-direct-trace-a-trace-through-the-ltm-device-and-other-relevant-information-compare-the-traces-to-determine-a-solution-to-an-httphttps-application-problem">Objective 2.09 Given a direct trace, a trace through the LTM device, and other relevant information, compare the traces to determine a solution to an HTTP/HTTPS application problem</h2>
<p><del>- 2.09a - Investigate the cause of an SSL Handshake failure</del></p>
<h2 id="--209b---given-a-failed-http-request-and-ltm-configuration-data-determine-if-the-connection-is-failing-due-to-the-ltm-configuration">- 2.09b - Given a failed HTTP request and LTM configuration data determine if the connection is failing due to the LTM configuration</h2>
<p>Packet Process Order: Packet filter &gt; Connection table &gt; Virtual Server &gt; NAT &gt; SNAT &gt; Self IP</p>
<h3 id="auto-last-hop">Auto Last Hop</h3>
<p>Global Setting under: System &gt; Configuration &gt; Local Traffic &gt; General &gt; Auto Last Hop [ X ]</p>
<p>Send the response back to the MAC of the client requestor, overrides the routing table. Useful if there’s no matching route for the client, or if transparent IPS devices don’t modify the source IP and a response could go to the wrong interface.</p>
<p>Can be overridden locally with Enabled, Disabled, or Default (inherit global) on VIPs, and SNATs</p>
<h3 id="failed-request-captures">Failed Request Captures</h3>
<p>Pictures of Wireshark or TCPDUMP traces that show these issues</p>
<ol>
<li>ClientSSL profile needs applied - ClientHello sent, no response, timeout after 300 seconds, C&gt;S FIN</li>
<li>ServerSSL profile needs applied - ClientHello sent, no response, timeout after 300 seconds, C&gt;S FIN</li>
<li>Server needs configured with SSL - ClientHello sent, no response, timeout after 300 seconds, C&gt;S FIN</li>
<li>SNAT needs enabled - S, S, S, R</li>
</ol>
<h3 id="persistence">Persistence</h3>
<p><strong>show ltm persistence persist-records</strong></p>
<p>Statistics &gt; Module Statistics &gt; Local Traffic &gt; Persistence Records</p>
<p>May need to enable: <strong>modify sys db ui.statistics.modulestatistics.localtraffic.persistencerecords value true</strong></p>
<p>An iRule can override a persistence profile decision</p>
<p>SSL Persistence - Verifies SSL session ID, when there is no client SSL profile applied. IP changes can happen and not affect this. If client SSL applied, use iRule</p>
<h4 id="cookie">Cookie</h4>
<p>Insert, Rewrite, and Passive are resistant to persistence mirroring, and failover. Everything needed is in the cookie.</p>
<p>Expiration</p>
<ul>
<li>
<p>Session (Default) – Valid until the browser is closed</p>
</li>
<li>
<p>Time-based</p>
</li>
</ul>
<p>Override Connection Limit: Pool member limits overridden. Virtual Server ones are not.</p>
<h5 id="insert-default">Insert (Default) </h5>
<p><strong>BIGipServer&lt;pool_name&gt;</strong> cookie is inserted. The server port and address are encoded. Unable to maintain persistence across virtual servers (HTTP/HTTPS) if pool member ports are different.</p>
<h5 id="rewrite">Rewrite</h5>
<p>Intercepts <strong>Set-Cookie</strong> header named <strong>BIGipCookie</strong> from the server and puts in there <strong>BIGipServer&lt;pool_name&gt;</strong>. Cookie field needs to be blank with 120 x 0’s, or 75 for backwards compatibility (has caveats).</p>
<p>Use over passive mode whenever possible</p>
<h5 id="passive">Passive </h5>
<p>Cookie read from the server to determine how to persist based on the encoded address of the pool member and timeout. Not recommended if rewrite is an option.</p>
<h5 id="hash">Hash</h5>
<p>Web server generates a cookie and LTM creates a hash of it to determine where to send it. Must specify a timeout in seconds</p>
<p>Persistence can be ignored for Cookie, Universal and Hash if different persistence entries are sent over the same TCP connection via Keep-Alive.</p>
<p><a href="https://support.f5.com/csp/article/K7964"target="_blank" rel="external nofollow noopener noreferrer">The BIG-IP system may appear to ignore persistence information for Keep-Alive connections (f5.com)</a></p>
<ul>
<li>Use OneConnect to evaluate persistence for each HTTP request.</li>
</ul>
<p>Fallback persistence - source IP only</p>
<h4 id="source-address">Source Address </h4>
<p>Timeout: Default 180 seconds</p>
<p>Match across Services, VIPs, Pools</p>
<p>Hash: CARP or Default</p>
<p>Mask</p>
<p>Override Connection Limit</p>
<h4 id="destination-address">Destination Address</h4>
<p>Good for caching servers</p>
<h4 id="hash-1">Hash</h4>
<p>Uses data from iRule (persist HTTP header)</p>
<p>Two algorithms, Default and CARP</p>
<h4 id="universal-persistence">Universal Persistence</h4>
<p><a href="https://support.f5.com/csp/article/K7392"target="_blank" rel="external nofollow noopener noreferrer">Overview of universal persistence (f5.com)</a></p>
<ul>
<li>Use iRule to persist off of data.</li>
<li>Use OneConnect to load balance effectively</li>
<li><strong>persist uie</strong> - persist off of HTTP_REQUEST client-side request</li>
<li><strong>persist add uie</strong> - used on HTTP_RESPONSE lookup of text to persist from</li>
</ul>
<h4 id="matching-across-options">Matching Across Options</h4>
<p>Pools with different node IPs or pools with multiple members with the same node IP may cause issues</p>
<p>Available in the following persistence profiles:</p>
<ul>
<li>Source Address</li>
<li>Destination Address</li>
<li>Cookie hash</li>
<li>SSL</li>
<li>Universal</li>
<li>Hash</li>
<li>Microsoft RDP</li>
<li>SIP</li>
</ul>
<p>Match Across Services - VIPs or Pools that have the same IP but different ports. Uses the node IP address to find a persistence match in other pools. Fixes secure checkout HTTP to HTTPS issues.</p>
<p>Match Across Virtual Servers - VIPs that have different IPs and Ports. Uses the node IP address to find a persistence match in other pools.</p>
<p>Match Across Pools - Once a pool and member is selected, always return to that pool even if iRule says different and the URL is different.</p>
<ul>
<li>Useful if you have one VIP redirecting to multiple pools using an iRule</li>
<li>Beware if the same client connects to another VIP that has Match Across Pools enabled, they will get directed to the same pool behind the other VIP</li>
</ul>
<h3 id="_packet-filters_"><em>Packet Filters</em></h3>
<ul>
<li><em>Applies to incoming traffic only</em></li>
<li><em>Expressions are written in <a href="http://www.tcpdump.org/manpages/pcap-filter.7.html"target="_blank" rel="external nofollow noopener noreferrer">libpcap </a>syntax like tcpdump commands - “src host and src host”</em></li>
<li><em>Can be applied to all VLANs to evaluate traffic coming into the BIG-IP from everywhere</em></li>
<li><em>Must Enable, default it is disabled</em></li>
</ul>
<h4 id="_criteria_"><em>Criteria</em></h4>
<ul>
<li><em>Source IP</em></li>
<li><em>Destination IP and port</em></li>
<li><em>Protocol</em></li>
<li><em>VLAN</em></li>
</ul>
<h4 id="_options_"><em>Options</em></h4>
<p><strong><em>Unhandled Packet Action</em></strong> <em>- Accept, Discard, or Reject are the options. Default is to Accept</em></p>
<p><strong><em>Filter established connections</em></strong> <em>- Default disabled. Checking this can degrade performance and does not improve security</em></p>
<p><strong><em>Send ICMP error on packet reject</em></strong> <em>- Default disabled. When enabled, BIG-IP sends an ICMP type 3 (destination unreachable), code 13 (administratively prohibited) packet when one is rejected.</em></p>
<p><em>When disabled, sends ICMP reject that is protocol-dependent (TCP reset?)</em></p>
<h5 id="exemptions"><em>Exemptions</em> </h5>
<p><em>VLANs - Default is None</em></p>
<p><em>Protocols</em></p>
<ul>
<li>
<p><em>ARP (default accepted)</em></p>
</li>
<li>
<p><em>Important ICMP (default accept)</em></p>
</li>
</ul>
<p><em>MAC addresses - Default is None (subject to packet filtering)</em></p>
<p><em>IP Addresses</em></p>
<h5 id="_actions_"><em>Actions</em></h5>
<ul>
<li><em>Accept, Discard - Stops processing down the rules</em></li>
<li><em>Reject - Sends reject packet - Depends on <strong>Send ICMP error on packet reject</strong> option</em></li>
<li><em>Continue - Acknowledges packet for logging/statistical purposes and continues</em></li>
</ul>
<h3 id="snat">SNAT</h3>
<p>Local Traffic &gt; Address Translation</p>
<p><a href="https://support.f5.com/csp/article/K9038"target="_blank" rel="external nofollow noopener noreferrer">The order of precedence for local traffic object listeners</a></p>
<p><a href="https://support.f5.com/csp/article/K7820#bp"target="_blank" rel="external nofollow noopener noreferrer">K7820: Overview of SNAT features</a></p>
<ul>
<li>Well known ports are usable as source ports</li>
<li>Can use more than one floating self IP in automap</li>
<li>Each SNAT address can have more than 65,535 translations
<ul>
<li>Source/Dest IP and Port numbers create unique translation</li>
</ul>
</li>
<li>Maximize SNAT IP use - Adjust TCP/UDP idle timeout - 60 seconds for HTTP, 120 - 300 seconds for FTP (Control port will remain idle while data is transferring)</li>
</ul>
<h4 id="pools">Pools</h4>
<ul>
<li>Avoids port exhaustion</li>
<li>Improve performance for FastHTTP VIP</li>
<li>Addresses are used via least connections to members</li>
<li>Configurable Idle timeout value (Unlike Automap)</li>
<li>F5 only uses IPs in the egress VLAN when there are IPs from multiple VLANs in the same pool on multiple VIPs</li>
</ul>
<p>Automap - Uses the self-IPs that egresses to the destination server according to the route table. Uses floating IP if HA.</p>
<h4 id="snat-list">SNAT List</h4>
<p>A global configuration for SNAT</p>
<p>Origin - All addresses | Address list</p>
<p>Translation - Address list, pool, automap</p>
<p>Source Port</p>
<ul>
<li>Preserve</li>
<li>Preserve Strict - Reset client connection if cannot get same source port</li>
<li>Change - Use next available port</li>
</ul>
<p>VLAN</p>
<p>Stateful Failover Mirror [   ]<br>
Auto last hop [ Default | Enabled | Disabled  ]</p>
<h4 id="snat-translation-list">SNAT Translation List</h4>
<p>SNATs will appear here that you configured, such as a pool.</p>
<p>Can only configure these options from this menu</p>
<ul>
<li>
<p>TCP/UDP/IP Idle timeout (Defaults Indefinite)</p>
</li>
<li>
<p>Connection Limit</p>
</li>
<li>
<p>ARP toggle</p>
</li>
<li>
<p>Traffic group selection</p>
</li>
</ul>
<h3 id="fastl4-profile">FastL4 Profile</h3>
<p><a href="https://support.f5.com/csp/article/K01155812"target="_blank" rel="external nofollow noopener noreferrer">K01155812: Overview of the Performance (Layer 4) virtual server</a></p>
<p><a href="https://support.f5.com/csp/article/K16446"target="_blank" rel="external nofollow noopener noreferrer">K16446: The BIG-IP system now allows a Performance (Layer 4) virtual server to have an associated HTTP profile</a></p>
<p>A reset is sent immediately before 3 way handshake when the pool members are unavailable</p>
<p>Able to assign HTTP profile and read HTTP with iRules or gather statistics with AVR</p>
<p>Assigned to the following VIP Types</p>
<ul>
<li>Performance (Layer 4)</li>
<li>Forwarding (Layer 2)</li>
<li>Forwarding (IP)</li>
</ul>
<p><strong>Limitations</strong></p>
<ul>
<li>No HTTP optimizations</li>
<li>No TCP optimizations for server offloading</li>
<li>SNAT/SNAT Pools demote PVA to Assisted</li>
<li>iRule events limited to CLIENT_ACCEPTED and SERVER_CONNECTED</li>
<li>No OneConnect</li>
<li>Limited Persistence - Source and destination address, Universal</li>
<li>No compression</li>
<li>No VIP authentication</li>
<li>No HTTP Pipelining</li>
</ul>
<h3 id="fasthttp-profile">FastHTTP Profile</h3>
<p>Assign to a Performance (HTTP) VIP Type</p>
<p>Packet-by-packet decisions</p>
<p>SNAT Pool can increase performance</p>
<p>Single TCP Connection, not Full proxy</p>
<p>When to use?</p>
<ul>
<li>Traffic with few network problems, such as dropped or out-of-order packets</li>
<li>Traffic generated by well-behaved clients and server</li>
<li>Traffic with protocol headers contained within a single packet</li>
<li>Traffic produced by load generators</li>
</ul>
<p>Advantages</p>
<ul>
<li>Fast HTTP combines TCP, HTTP, and OneConnect profiles into a single profile that is optimized for network performance.</li>
<li>The Fast HTTP profile is designed to reduce network latency and system CPU usage.</li>
<li>Compatible with persistence</li>
</ul>
<p>Disadvantages</p>
<ul>
<li>SNAT Required</li>
<li>No IPv6 support</li>
<li>No SSL offload</li>
<li>No compression</li>
<li>No caching</li>
<li>No PVA acceleration</li>
<li>No virtual server authentication</li>
<li>No state mirroring</li>
<li>No HTTP pipelining</li>
<li>No TCP optimizations</li>
<li>Limited iRule Header expansion</li>
<li>iRules are limited to L4 and a subset of HTTP header operations and pool/pool member selection</li>
<li>Out of order packets are dropped</li>
</ul>
<p><strong>Settings:</strong></p>
<p>Request Header Insert</p>
<p>XFF Insert</p>
<p>Objective 2.10 Given a scenario, determine which protocol analyzer tool and its options are required to resolve an application issue</p>
<p>HTTPWatch</p>
<p>Fiddler</p>
<h3 id="ssldump">ssldump</h3>
<p>Best to capture traffic with tcpdump, then decrypt with ssldump. It is possible to decrypt live traffic with ssldump though.</p>
<p>Flags</p>
<ul>
<li>
<p>-i - Interface</p>
</li>
<li>
<p>-r - Read pcap</p>
</li>
<li>
<p>-A - Display all fields (default is most interesting only)</p>
</li>
<li>
<p>-e - Print actual timestamps (1604107938.9487 (0.1394)  C&gt;S  Handshake)</p>
<ul>
<li>(Without - relative) 0.1238 (0.1238)  C&gt;S  Handshake</li>
</ul>
</li>
<li>
<p>-d - Display app data, including before session</p>
</li>
<li>
<p>-M - Export a (symmetric) pre-master secret log file</p>
</li>
<li>
<p>-k - Specify private key file path</p>
</li>
</ul>
<h3 id="tcpdump">TCPDUMP</h3>
<p><a href="https://support.f5.com/csp/article/K1893"target="_blank" rel="external nofollow noopener noreferrer">Packet trace analysis</a></p>
<p><a href="http://packetpushers.net/masterclass-tcpdump-interpreting-output/"target="_blank" rel="external nofollow noopener noreferrer">Tcpdump – Interpreting Output</a></p>
<p><a href="https://support.f5.com/csp/article/K411"target="_blank" rel="external nofollow noopener noreferrer">Overview of packet tracing with the tcpdump utility</a></p>
<p><a href="https://support.f5.com/csp/article/K13637"target="_blank" rel="external nofollow noopener noreferrer">Capturing internal TMM information with tcpdump</a></p>
<p><a href="http://www.tcpdump.org/tcpdump_man.html"target="_blank" rel="external nofollow noopener noreferrer">TCPDUMP</a></p>
<p>-i - Interface, physical or VLAN - mgmt = eth0 (do not capture on interface with colon)</p>
<ul>
<li>If you don’t specify one, it defaults to eth0 (mgmt)</li>
<li>Use 0.0 (loopback) to capture traffic in all route-domains and VLANs</li>
<li>Specifying VLAN disables hardware checksum L4 UDP/TCP, and calculates it in software</li>
<li>:p - Follow and capture traffic through the entire flow - SNAT and OneConnect included. Only works correctly if using ‘src host &lt;x.x.x.x.&gt;’ and ‘dst host &lt;x.x.x.x&gt;’ filters. If you use ‘host &lt;x.x.x.x&gt;’ it will capture everything.</li>
<li>:nnn - Low, Medium, High details from TMM</li>
</ul>
<p>-n - Disable name resolution</p>
<p>-nn - Disable name and port resolution</p>
<p>-e - Print MAC addresses</p>
<p>-v[vv] Verbose</p>
<ul>
<li>Displays IP headers, options, and amount of packets captured when using -w</li>
</ul>
<p>-w - Write to file (tcpdump &gt; file-name - writes text only)</p>
<p>-C - In megabytes the size of the circular buffer file</p>
<p>-W - Number of max files to create for circular buffers</p>
<p>-r - Read binary file</p>
<ul>
<li>F5 adds pseudo header to beginning of file that includes - tcpdump syntax, code version, hostname, platform, product</li>
</ul>
<p>-s, &ndash;snapshot-length=snaplen  - How much data in <strong>bytes</strong> to capture in each packet - 0 = 65535. Example, -s200 - Default 68 bytes.</p>
<ul>
<li>Only necessary when displaying/reading and not writing to a file.</li>
</ul>
<p>-X - Display hex and ASCII of the actual data</p>
<p>-c [count] -  Exit after so many packets are captured. Useful to prevent capturing too much and affecting the system performance.</p>
<p>-K - Disable checksum (Good if there is checksum offload on the NIC)</p>
<p>-q - Quiet mode, only posts src/dst IP/port, length and DF bit or not, NO FLAGS</p>
<p>-ttt - Display time delta since last packet</p>
<p>-Z - User</p>
<h4 id="operators-1">Operators</h4>
<p>and | or | not</p>
<h4 id="filters">Filters</h4>
<p><strong>src | dst [ net | host | <!-- raw HTML omitted --> ]</strong></p>
<h4 id="output">Output</h4>
<p><strong>IPv4</strong></p>
<p>IP is printed at the beginning if -e is not used.</p>
<p>If -v is used:</p>
<p>tos <em>tos,</em> ttl <em>ttl</em>, id <em>id</em>, offset <em>offset</em>, flags [<em>flags</em>], proto <em>proto</em>, length <em>ip-packet-length</em>, options (<em>options</em>)</p>
<p><strong>TCP/UDP</strong></p>
<p><em>src</em> &gt; <em>dst</em>: Flags [<em>tcpflags</em>], seq <em>data-seqno</em>, ack <em>ackno</em>, win <em>window</em>, urg <em>urgent</em>, options [<em>opts</em>], length <em>len</em></p>
<p>Flags: S, F, P, R, U(URG), W (ECN CWR), E (ECN-Echo), or ‘.’ (ACK), or ‘none’ if no flags are set.</p>
<p>IP Src, Dst, and flags are always present, others are conditional.</p>
<p>16:09:39.397858 IP 10.128.10.50.80 &gt; 10.128.10.1.55945: Flags [P.], seq 1074417:1074792, ack 413, win 4792, options [nop,nop,TS val 3976789900 ecr 226910010], length 375: HTTP</p>
<ul>
<li>seq 1074417:1074792 - Beginning and ending sequence (matches length)</li>
<li>length - TCP data payload length (not headers)</li>
</ul>
<p><strong>SYN Packet</strong></p>
<p>16:09:37.343607 IP 10.128.10.1.55945 &gt; 10.128.10.50.80: Flags [SEW], seq 1505695674, win 65535, options [mss 1460,nop,wscale 5,nop,nop,TS val 226908491 ecr 0,sackOK,eol], length 0</p>
<h2 id="--210a---identify-application-issues-based-on-a-protocol-analyzer-trace-and-determine-solution">- 2.10a - Identify application issues based on a protocol analyzer trace and determine solution</h2>
<p>Virtual Host: Apache setting to allow another host header binding.</p>
<h3 id="no-response">No Response</h3>
<ul>
<li>
<p>SNAT</p>
<ul>
<li>Source and Destination pool member in same subnet</li>
<li>Pool member doesn’t have LB as gateway</li>
</ul>
</li>
</ul>
<h2 id="--210b---explain-how-to-follow-a-conversation-from-client-side-and-server-side-traces">- 2.10b - Explain how to follow a conversation from client side and server side traces</h2>
<h3 id="following-a-trace">Following a Trace</h3>
<ul>
<li>Use 0.0:p (loopback interface) and specify source and destination IPs</li>
<li>Match timestamps on both sides (client and server)</li>
<li>Match source port number</li>
</ul>
<h3 id="following-a-trace-in-wireshark">Following a Trace in Wireshark</h3>
<ul>
<li>In the F5 ETH trailer, the flow ID and peer ID can be used to follow a full trace of the connection. Copy them as a Filter and put ‘or’ in it. This will catch both sides of the connection.</li>
</ul>
<h2 id="--210c---explain-how-snat-and-oneconnect-affect-protocol-analyzer-traces">- 2.10c - Explain how SNAT and OneConnect affect protocol analyzer traces</h2>
<h3 id="snat-1">SNAT</h3>
<p>Automap will use floating self-IP of interface - will preserve the source port by default</p>
<h3 id="oneconnect-1">OneConnect</h3>
<p>tcpdump won’t show 3 way handshake on the server-side and will show multiple HTTP requests on server side over the same connection, while the client side will show multiple connections from multiple clients.</p>
<h2 id="--210d---explain-how-to-decrypt-ssl-traffic-for-protocol-analysis-v115">- 2.10d - Explain how to decrypt SSL traffic for protocol analysis (v11.5)</h2>
<p><a href="https://support.f5.com/csp/article/K10209"target="_blank" rel="external nofollow noopener noreferrer">K10209: Overview of packet tracing with the ssldump utility</a></p>
<h3 id="read-application-data---symmetric-keys">Read application data - Symmetric keys</h3>
<ol>
<li>Disable ECDHE in the SSL profile</li>
<li>Capture traffic with tcpdump</li>
<li>Create pre-master secret (symmetric key)</li>
</ol>
<p><strong>ssldump -r &lt;capture-file.pcap&gt; -k &lt;private-key.key&gt; -M <!-- raw HTML omitted --></strong></p>
<p>The output of the pre-master-secret log file can now be loaded into Wireshark. (Edit &gt; Preferences &gt; Protocols &gt; SSL &gt; PMS key log filename.</p>
<h2 id="--210e---explain-how-to-recognize-the-different-causes-of-slow-traffic-eg-drops-rsts-retransmits-icmp-errors-demotion-from-cmp">- 2.10e - Explain how to recognize the different causes of slow traffic (e.g., drops, RSTs, retransmits, ICMP errors, demotion from CMP)</h2>
<p>ICMP Errors - Packet filter being used and sending ICMP error on Reject</p>
<p>ICMP destination unreachable - can be multiple things, like the destination host cannot be reached by the gateway. Or there isn’t a route that the gateway has to the destination</p>
<h3 id="drops">Drops</h3>
<ul>
<li>
<p>No SNAT</p>
<ul>
<li>Source and Destination pool member in same subnet</li>
<li>Pool member doesn’t have LB as gateway</li>
</ul>
</li>
<li>
<p>MTU size</p>
<ul>
<li>Switches can silently drop packets that have too big of a MTU size, only routers can fragment</li>
</ul>
</li>
<li>
<p>TM.RejectUnmatched <strong>false</strong></p>
<ul>
<li>Packet received on non listening port or invalid sequence (segment) - <em>Silent Drop</em></li>
</ul>
</li>
<li>
<p>TM.MaxRejectRate - 250 TCP RSTs/ICMP UNR / second</p>
<ul>
<li>Too many resets are being sent, <em>silently drop</em></li>
</ul>
</li>
</ul>
<h3 id="resets">Resets</h3>
<p><strong>show net rst-cause</strong></p>
<p>db variable <strong>tm.rstcause.log value enable</strong> - Displays “RST sent from <!-- raw HTML omitted --> to <!-- raw HTML omitted --> and the reason in logs</p>
<p>db variable <strong>tm.rstcause.pkt value enable</strong> - Displays RST cause in TCP payload</p>
<ul>
<li>Can use <strong>tcpdump -i <!-- raw HTML omitted -->:nn</strong> to display the cause without this set.</li>
</ul>
<p>Reaping - RST when high-water mark is reached and no new connections are allowed</p>
<p>TM.RejectUnmatched <strong>true</strong></p>
<ul>
<li>SEQ received on VIP or self-ip that doesn’t match current connection</li>
<li>SYN received on VIP or self-ip for port that isn’t listening</li>
</ul>
<p>VIPs</p>
<ul>
<li>Reject VIP - Always</li>
<li>Connection Limit reached</li>
<li>VLAN not allowed</li>
</ul>
<p>Pools</p>
<ul>
<li>All down</li>
<li>Nodes or Pool Connection limit reached</li>
</ul>
<p>Profiles</p>
<ul>
<li>
<p>Idle timeout reached (<strong>Reset on Timeout</strong> set) Default 300 seconds</p>
<ul>
<li>If multiple profiles with idle timeout, use smallest value</li>
</ul>
</li>
<li>
<p>8 re-transmissions</p>
</li>
<li>
<p>3 SYNs</p>
</li>
</ul>
<p>SNATs</p>
<ul>
<li>3 Unacknowledged SYNs processed</li>
<li>Idle timeout</li>
<li>Port exhaustion</li>
</ul>
<p>Monitors</p>
<ul>
<li>RST when TCP and TCP_Halfopen passess.</li>
<li>HTTP monitor may RST after receive string is received</li>
</ul>
<p>iRule - <strong>reject</strong> command</p>
<p>Packet filter - <strong>reject</strong> action</p>
<h3 id="duplicate-acks">Duplicate ACKs</h3>
<ul>
<li>Packet loss</li>
<li>Resource Exhaustion</li>
<li>Extreme increase in latency</li>
</ul>
<h3 id="slow-traffic">Slow Traffic</h3>
<p><strong>Dropped packets</strong></p>
<ul>
<li>Duplicate ACKs</li>
<li>Duplicate SEQ</li>
</ul>
<h3 id="cmp---cluster-multiprocessing">CMP - Cluster Multiprocessing</h3>
<p>Creates separate TMM processes per CPU to share the load across all.</p>
<p>Demotion - iRule with Global variable, <strong>set::</strong> or <strong>$::</strong> demotes CMP to single.</p>
<p><strong>show ltm virtual <!-- raw HTML omitted --></strong></p>
<ul>
<li>CMP - <strong>enabled/disabled</strong></li>
<li>CMP Mode - <strong>all-cpus</strong>, <strong>single, none</strong>, <strong>disabled</strong></li>
</ul>
<p>Objective 2.14 Given a trace, identify monitor issues</p>
<h2 id="--214a---explain-how-to-capture-and-interpret-monitor-traffic-using-protocol-analyzer">- 2.14a - Explain how to capture and interpret monitor traffic using protocol analyzer</h2>
<p>Capture traffic from non-floating self-IP to pool member</p>
<h2 id="--214b---explain-how-to-obtain-needed-input-and-output-data-to-create-the-monitors">- 2.14b - Explain how to obtain needed input and output data to create the monitors</h2>
<p>Retrieve a health check file and response from cURL or use openssl, telnet, or ncat.</p>
<pre tabindex="0"><code>curl http://10.128.10.10/health-file -H “Host: f5demo.com”
curl http://f5demo.com --resolve “f5demo.com:80:10.128.10.10”
nc -v 10.128.10.10 443
telnet 10.128.10.10 443
openssl s_client -connect 10.128.10.10:443
</code></pre><p>Objective 2.15 Given a monitor issue, determine an appropriate solution</p>
<h2 id="--215a---determine-appropriate-monitor-and-monitor-timing-based-on-application-and-server-limitations">- 2.15a - Determine appropriate monitor and monitor timing based on application and server limitations</h2>
<p><a href="https://support.f5.com/csp/article/K12531"target="_blank" rel="external nofollow noopener noreferrer">Troubleshooting Health Monitors</a></p>
<p><a href="https://support.f5.com/csp/article/K3451"target="_blank" rel="external nofollow noopener noreferrer">Content length limits for HTTP(S) monitors</a></p>
<p><a href="https://linux.die.net/man/8/ftpd"target="_blank" rel="external nofollow noopener noreferrer">ftpd man page</a></p>
<p><a href="https://support.f5.com/csp/article/K11481312"target="_blank" rel="external nofollow noopener noreferrer">Overview of the FTP health monitor</a></p>
<p><a href="https://support.f5.com/csp/article/K13612"target="_blank" rel="external nofollow noopener noreferrer">Response code support for FTP</a></p>
<p><a href="https://support.f5.com/csp/article/K12921"target="_blank" rel="external nofollow noopener noreferrer">Configuring an active FTP monitor for pool members that listen on non-standard FTP port</a></p>
<p><a href="https://support.f5.com/csp/article/K61010136"target="_blank" rel="external nofollow noopener noreferrer">K61010136: Overview of the inband monitor</a></p>
<p>Timeout should be 3 times the interval + 1.</p>
<p>The appropriate monitor should be TCP, or HTTP for most apps. ICMP should not be used.</p>
<h3 id="types">Types</h3>
<h4 id="active">Active</h4>
<ul>
<li>Extended Content Verification (ECV) - Verify content - status.html - ONLINE</li>
<li>Extended Application Verification (EAV) - Verify path or service - Port 443, or HEAD /</li>
</ul>
<h4 id="passive-1">Passive</h4>
<ul>
<li>
<p>Passively monitors traffic, does not generate any</p>
</li>
<li>
<p>Only 1 called “inband”</p>
</li>
<li>
<p>Marks down if client requests timeout to the server or get a TCP reset</p>
</li>
<li>
<p>Cannot specify the responses to mark down/up on</p>
</li>
<li>
<p>Fast to mark servers down</p>
</li>
<li>
<p>Slow to mark servers up</p>
</li>
<li>
<p>Failures - 3</p>
</li>
<li>
<p>Failure Interval - 30 seconds</p>
</li>
<li>
<p>Response Time - 10 seconds</p>
</li>
<li>
<p>Retry Time - 300 seconds. Time before re-checking a down pool member’s status. If 0, won’t be turned back on without manual intervention or another monitor with ‘Time Until Up’ is used.</p>
</li>
<li>
<p><del>Apply HTTP monitor and enable Up Interval, set it to high and Time Until Up. This ensures that once the member is up, stop monitoring it so often and instead use the inband monitor to look for errors.</del></p>
<ul>
<li><del>The Interval set will be used when its down</del></li>
</ul>
</li>
</ul>
<h3 id="pools-1">Pools</h3>
<p><a href="https://support.f5.com/csp/article/K47726919"target="_blank" rel="external nofollow noopener noreferrer">K47726919: FQDN ephemeral nodes on the BIG-IP system do not repopulate after configuration load</a></p>
<h4 id="options-1">Options</h4>
<p><strong>FQDN</strong> - Queries DNS, adds all results as members.</p>
<p>Members will show as a separate node and display as “nodename-10.1.1.100” (11.x) or  “_auto_10.1.1.100” (12.+)</p>
<p><strong>Auto Populate</strong> - Remove and add members as DNS record changes (checks every hour by default or can use the TTL). You can restart <strong>bigd</strong> to force a lookup.</p>
<p><strong>IP Encapsulation</strong></p>
<ul>
<li>GRE/IPIP - nPath/Direct Server Return - Creates IP encapsulation tunnel to server. The server de-encapsulates the packet and then directly responds to the client in the original IP header.</li>
<li><a href="https://techdocs.f5.com/en-us/bigip-15-0-0/big-ip-local-traffic-manager-implementations/configuring-layer-3-npath-routing.html"target="_blank" rel="external nofollow noopener noreferrer">AskF5 | Manual Chapter: Configuring Layer 3 nPath Routing</a></li>
</ul>
<p><strong>Slow Ramp</strong> - Slowly increases connections sent to a server coming up. The member will not be considered active in a priority group until the Slow ramp time is done.</p>
<p><strong>Allow SNAT -</strong> Uncheck to override Virtual Server SNAT.</p>
<p><strong>Reselect Tries</strong> (Use with TCP profile only, not fastL4) - Number of times to try and select a new pool member once one has failed for a client. Used with inband monitor</p>
<p><strong>TCP Request Queue</strong> - Queue connection if connection limit is reached.</p>
<h5 id="action-on-service-down">Action on Service Down</h5>
<p>What happens when a pool member is marked down.</p>
<p>None - <em>Default</em>. Removes existing persistence entries. If the cookie pool member is not available, the F5 makes a new load balancing decision. Existing connections remain until idle timeout or client close.</p>
<p>Reject (Reset in TMSH) - RST or ICMP Unreachable is sent to the client.</p>
<p>Drop - Silently deletes connections - OK for UDP short-lived (DNS queries)</p>
<p>Reselect - Moves client connection without tearing it down.</p>
<ul>
<li>VS with port and address translation disabled (FastL4)</li>
<li>Pool members that don’t care about the state of the connection (Cache servers, firewalls, routers, proxy servers)</li>
<li>UDP VS</li>
<li>If you did this on a TCP VS, the server would send a RST (no existing connection)</li>
</ul>
<h4 id="members">Members</h4>
<p><strong>Down:</strong> Persistence record is removed, no new connections will be directed to that member.</p>
<p><strong>Disabled:</strong> Receive new connections from persistent connections. No new connections allowed from clients without a persistence record</p>
<p><strong>Forced Offline:</strong> Persistence record is removed, no new connections will be directed to that member.</p>
<p>Existing connections can end gracefully and will receive an ICMP Echo Unreachable or TCP RST if the idle timeout is reached.</p>
<p><strong>Connection Rate Limit</strong> - Optimal 300 - 5000 connections per second. Max is 100000.</p>
<h5 id="priority-groups">Priority Groups</h5>
<p>Backup Servers will be placed in lower priority than others.</p>
<p>Priority Group Activation**:** Disabled,  Less than..</p>
<ul>
<li>Less than <strong>0</strong> members - Disables it</li>
</ul>
<p>Members</p>
<ul>
<li>0 is lowest/last</li>
<li>Higher = more priority</li>
<li>If the Less than… is exceeded, the next highest priority group is activated (Less than 3.. Two left &gt; Next highest activated )</li>
<li>Connection limits do not mark them down and does not activate another group</li>
</ul>
<h3 id="ftp">FTP</h3>
<p><a href="https://linux.die.net/man/8/ftpd"target="_blank" rel="external nofollow noopener noreferrer">ftpd man page</a></p>
<p><a href="https://support.f5.com/csp/article/K11481312"target="_blank" rel="external nofollow noopener noreferrer">Overview of the FTP health monitor</a></p>
<p><a href="https://support.f5.com/csp/article/K13612"target="_blank" rel="external nofollow noopener noreferrer">Response code support for FTP</a></p>
<p><a href="https://support.f5.com/csp/article/K12921"target="_blank" rel="external nofollow noopener noreferrer">Configuring an active FTP monitor for pool members that listen on non-standard FTP port</a></p>
<p>Logs in, downloads file to /var/tmp</p>
<h3 id="external">External</h3>
<p><a href="https://support.f5.com/csp/article/K7444"target="_blank" rel="external nofollow noopener noreferrer">Requirements for external monitor output</a></p>
<p>Any output from an external monitor to <strong>stdout</strong> will result in a member being Available. If the script fails, do not write failed status to <strong>stdout</strong></p>
<p>Writing to stdout - ‘<strong>echo</strong> <!-- raw HTML omitted -->’</p>
<h2 id="--215b---describe-how-to-modify-monitor-settings-to-resolve-monitor-problems">- 2.15b - Describe how to modify monitor settings to resolve monitor problems</h2>
<p>Default setting for multiple monitors on a pool is for All to pass.</p>
<h3 id="http-1">HTTP</h3>
<p><a href="https://support.f5.com/csp/article/K3451"target="_blank" rel="external nofollow noopener noreferrer">Content length limits for HTTP(S) monitors</a></p>
<p><a href="https://support.f5.com/csp/article/K83316932"target="_blank" rel="external nofollow noopener noreferrer">K83316932: Overview of the Manual Resume feature for BIG-IP LTM monitors</a></p>
<p>Limit of length to search - ~5k bytes - F5 will send a reset after it receives the string it needs or reaches the limit</p>
<p><strong>Up Interval</strong> - How often to check when resource is up (default disabled)<br>
<strong>Interval</strong> - How often to check, if node is up or down<br>
<strong>Time until Up</strong> - How long to wait after successful check before marking up</p>
<p><strong>Send String</strong></p>
<ul>
<li>
<p>HTTP version differences</p>
</li>
<li>
<p>0.9 - GET /\n or GET /\r\n</p>
</li>
<li>
<p>1.0 - GET / HTTP/1.0\r\n\r\n or GET / HTTP/1.0\r\n</p>
</li>
<li>
<p>1.1 - GET / HTTP/1.1\r\nHost: domain.com\r\n\r\n</p>
<ul>
<li>Connection close optional at the end, Keep-Alive is default</li>
</ul>
</li>
<li>
<p>Marks server up if response is received and no Receive String is configured (200, 404, etc)</p>
</li>
</ul>
<p><strong>Receive Disable String</strong> - Mark member down (Disabled)</p>
<ul>
<li>Receive string will override Receive Disable string and mark the member up</li>
</ul>
<p><strong>Manual Resume</strong> - Require manual enabling when down.</p>
<p><strong>Reverse option</strong> - Marks monitor down when the test is successful. Receive disable string unavailable<br>
<strong>Transparent</strong> - Force the monitor check through this pool member by using the pool member as a gateway to the Alias address/port. Good for gateway pools.<br>
<strong>Alias Address and Port</strong> - Actually test this address/port to determine if this monitor should pass and not the pool member IP:port. Use this in combination with Transparent mode [√] to check through a device.</p>
<p>Section 3 - Identify and Resolve LTM Device Issues</p>
<p>Objective 3.01 Interpret log file messages and/or command line output to identify LTM device issues</p>
<h3 id="lcd-messages">LCD Messages</h3>
<p><a href="https://techdocs.f5.com/kb/en-us/products/big-ip_ltm/manuals/product/b4000-platform/2.html#c_reuse_led_about"target="_blank" rel="external nofollow noopener noreferrer">Manual Chapter: The 4000 Series Platform</a></p>
<h4 id="alert-lights">Alert lights</h4>
<table>
<thead>
<tr>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>Blinking red</td>
<td>Emergency</td>
</tr>
<tr>
<td>Solid red</td>
<td>Alert</td>
</tr>
<tr>
<td></td>
<td>Critical</td>
</tr>
<tr>
<td>Blinking yellow</td>
<td>Error</td>
</tr>
<tr>
<td>Solid yellow</td>
<td>Warning</td>
</tr>
</tbody>
</table>
<p>Status LED</p>
<ul>
<li>Solid Green - Active</li>
<li>Solid yellow - Standby</li>
</ul>
<h3 id="alert-conditions">Alert conditions</h3>
<p><strong>Blinking red</strong> - PSU, Bad HDD</p>
<p><strong>Solid red</strong> - License, DDoS, CPU, Chassis</p>
<p><strong>Warning</strong> - Unit going standby/active</p>
<h2 id="--301a---interpret-log-file-messages-to-identify-ltm-device-issues">- 3.01a - Interpret log file messages to identify LTM device issues</h2>
<p>Covered already under 3.02a/b</p>
<h2 id="--301b---interpret-the-qkview-heuristic-results">- 3.01b - Interpret the qkview heuristic results</h2>
<p>Not sure how to study for this</p>
<h2 id="--301c---identify-appropriate-methods-to-troubleshoot-ntp">- 3.01c - Identify appropriate methods to troubleshoot NTP</h2>
<h3 id="prefer-ntp-server">Prefer NTP server</h3>
<pre tabindex="0"><code>tmsh edit sys ntp all-properties
include “&lt;server ip&gt; prefer”
:wq!
list sys ntp servers
</code></pre><h3 id="troubleshooting-1">Troubleshooting</h3>
<p><a href="https://www.nwtime.org/ntps-refid/"target="_blank" rel="external nofollow noopener noreferrer">NTP&rsquo;s REFID</a></p>
<p>NTP = UDP port 123</p>
<p><strong>show sys service ntpd</strong></p>
<p>ntpd (pid  25898) is running…</p>
<p><strong>list sys ntp all-properties</strong></p>
<p><strong># ntpq -np</strong></p>
<p>-n    Disable hostnames</p>
<p>-p    Print peers - required for below output or else enters interactive mode</p>
<h3 id="output-1">Output</h3>
<table>
<thead>
<tr>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Variable</strong></td>
<td><strong>Description</strong></td>
</tr>
<tr>
<td>[tally]</td>
<td>* = Preferred server<br />+ = Next available server<br />space, x, period (.), dash (-), or pound (#)  = Peer not used - unavailable, not needed, requirements unmet</td>
</tr>
<tr>
<td>remote</td>
<td>Peer address</td>
</tr>
<tr>
<td>refied</td>
<td>Reference ID.CMDA..GPS.</td>
</tr>
<tr>
<td>st</td>
<td>Stratum ID<br />0 = invalid/unspecified<br />1 = primary / reference clock (GPS/CMDA, etc.)<br />2-15 = secondary source, refid changes to remote clock’s peer IP<br />16+ = unsynchronized</td>
</tr>
<tr>
<td></td>
<td></td>
</tr>
<tr>
<td>t</td>
<td>u: unicast address, b: broadcast, l: local address</td>
</tr>
<tr>
<td></td>
<td></td>
</tr>
<tr>
<td></td>
<td></td>
</tr>
<tr>
<td>reach</td>
<td>0 = server not reached</td>
</tr>
</tbody>
</table>
<h4 id="failed">Failed</h4>
<pre tabindex="0"><code>remote       refid  st t when   poll reach delay offset jitter
==============================================================================
172.28.4.133 .INIT. 16 u 64     0    0.000 0.000 0000.00
</code></pre><p><strong>st 16 =</strong> inoperative NTP server or not viable<br>
<strong>refid .INIT</strong> = Initializing request to server, not reached.</p>
<pre tabindex="0"><code>remote       refid        st t when poll reach delay offset  jitter
==============================================================================
172.28.4.133 10.10.10.251 4  u 482  1024 377   0.815 -10.010 0.345
</code></pre><h4 id="normal">Normal</h4>
<p>Example 1</p>
<pre tabindex="0"><code>remote         refid        st t when poll reach delay offset  jitter
==============================================================================
*172.16.24.120 10.30.40.251 4  u 482  1024 377   0.815 -10.010 0.345
+172.17.24.130 10.20.40.252 6  u 482  1024 179   0.215 -1.010  0.545
</code></pre><p>Example 2</p>
<pre tabindex="0"><code>remote    refid        st t when poll reach delay  offset       jitter
==============================================================================
*10.0.0.1 172.18.20.40 2  u 174  1024 377   39.833 -0.447        1.107
+10.0.1.1 .GPS.        1  u 285  1024 377   55.782 -1.010 -0.661 1.562
</code></pre><h2 id="--301d---identify-license-problems-based-on-the-log-file-messages-and-statistics">- 3.01d - Identify license problems based on the log file messages and statistics</h2>
<p><a href="https://support.f5.com/csp/article/K7747"target="_blank" rel="external nofollow noopener noreferrer">K7747: Error Message: SSL transaction (TPS) rate limit reached</a></p>
<p>01260008:3: SSL transaction (TPS) rate limit reached</p>
<p>Objective 3.02 Identify the appropriate command to use to determine the cause of an LTM device problem</p>
<p>You can use <strong>run util <!-- raw HTML omitted --></strong> from TMSH if you don’t feel like going down to bash</p>
<p><strong>run util tcpdump -i 1.1 host 1.1.1.1</strong></p>
<p>Not all programs are there, such as ‘top’</p>
<h2 id="--302a---identify-hardware-problems-based-on-the-log-file-messages-and-statistics">- 3.02a - Identify hardware problems based on the log file messages and statistics</h2>
<p><strong>show sys log ltm [ range</strong> &lt;time-parameters&gt; <strong>]</strong></p>
<p>Max lines is 10000, and will not display it if so<br>
Seconds are optional<br>
The following require <strong>range</strong></p>
<p>now-3d - 3 days ago.<br>
now+3h - 3 hours from now. ← This is impossible<br>
now-3m - 3 minutes ago.<br>
now+3w - 3 weeks from now. ← This is impossible</p>
<p><strong>show sys log ltm</strong> 2022-09-15:00:00:00 ← Cannot get this to work.<br>
<strong>show sys log ltm range now-1h</strong> - Now to 1 hour ago<br>
<strong>show sys log ltm range</strong> 2022-09-15:00:00:00&ndash;2022-09-14:00:00:00</p>
<p>If you don’t specify a destination in the range, it will be 5 minutes</p>
<pre tabindex="0"><code>SYNTAX
Date/Time Syntax
  now[ [ + | - ] &lt;integer&gt; [ d | h | w | m ] ]
  yyyy-mm-dd[ : | T ]hh:mm[:ss]
  mm-dd[-yyyy][ : | T ]hh:mm[:ss]
  mm/dd[/yyyy][ : | T ]hh:mm[:ss]

Date Range Syntax
  now[ [ + | - ] &lt;integer&gt; [ d | h | w | m ] ]--now[ [ + | - ] &lt;integer&gt; [ d | h | w | m ] ]
  yyyy-mm-dd[ : | T ]hh:mm[:ss]--yyyy-mm-dd[ : | T ]hh:mm[:ss]
  mm-dd[-yyyy][ : | T ]hh:mm[:ss]--indefinite
  epoch--mm/dd[yyyy][ : | T ]hh:mm\[:ss]
  now[ [ + | - ] &lt;integer&gt; [ d | h | w | m ] ]
</code></pre><h3 id="end-user-diagnostics">End User Diagnostics</h3>
<p><a href="https://techdocs.f5.com/kb/en-us/products/big-ip_ltm/releasenotes/related/eud-sf.html"target="_blank" rel="external nofollow noopener noreferrer">AskF5 | Manual: Field Testing F5 Hardware: F5 BIG-IP iSeries Platforms</a></p>
<p>Options to run</p>
<ol>
<li>Download ISO file and burn to CD. Use USB DVD drive in system</li>
<li>Download IM file, install it, then install EUD to a flash drive</li>
</ol>
<p>It will automatically boot or select End User Diagnostics from the boot menu from console</p>
<p>Select Option 21 to reboot and exit. Any other way may cause instability</p>
<p>“Completed test with 0 errors”</p>
<p>Diag file <strong>- /shared/log/eud.log</strong></p>
<p>Use command <strong>eud_info</strong> to see version installed</p>
<h4 id="usb-flash-drive">USB Flash drive</h4>
<p>Download .im file to /var/tmp</p>
<p>Install it - <strong>im</strong> &lt;file_name&gt;.im</p>
<p>Loopback mount the downloaded file - <strong>mkdir</strong> <strong>/tmp/eud; mount</strong> <strong>-o ro,loop</strong> &lt;file_name&gt;.im <strong>/tmp/eud</strong></p>
<p>Insert flash drive into BIG-IP</p>
<p>Run mkdisk and follow prompts to install EUD onto flash drive - <strong>cd /tmp/eud; ./mkdisk</strong></p>
<h3 id="ssl-hardware-accelerator">SSL Hardware Accelerator</h3>
<p><a href="https://support.f5.com/csp/article/K16951"target="_blank" rel="external nofollow noopener noreferrer">K16951: Overview of SSL hardware acceleration fail-safe</a></p>
<p>crit tmm[6789]: 01010025:2: Device error: cn0 device requires hard reset; trying soft reset</p>
<p>crit tmm2[6789]: 01010025:2: Device error: cn2 PCI write master retry timeout</p>
<h3 id="hard-drive-issues">Hard Drive Issues</h3>
<p><a href="https://support.f5.com/csp/article/K14426"target="_blank" rel="external nofollow noopener noreferrer">Article: K14426 - Hard disk error detection and correction improvements</a></p>
<p><strong>pendsect</strong> - Process that runs daily to check for HDD errors and logs to <strong>/var/log/user.log</strong> and <strong>/var/log/messages.</strong> Doesn’t apply to SSDs</p>
<table>
<thead>
<tr>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Log Entry</strong></td>
<td><strong>Outcome</strong></td>
</tr>
<tr>
<td>no Pending Sectors detected</td>
<td><strong>No errors detected</strong></td>
</tr>
<tr>
<td>Recovered LBA:230000007<br /> Drive /dev/sda partition UNKNOWN<br />File affected NONE</td>
<td><strong>Errors detected and corrected</strong></td>
</tr>
<tr>
<td>seek(1) error[25]  recovery of LBA:226300793 not complete<br />Drive: /dev/sda filesystem type: Undetermined<br />File affected: NONE</td>
<td><strong>Error detected and unrecoverable</strong></td>
</tr>
<tr>
<td>crit smartd[4652]: Device: /dev/sda, 1 Currently unreadable (pending) sectors</td>
<td><strong>Possible Failure or just busy and recovers</strong> - <strong>/var/log/daemon.log</strong></td>
</tr>
</tbody>
</table>
<p><strong>Confirming Hard Drive Failures</strong></p>
<p><a href="https://techdocs.f5.com/content/kb/en-us/products/big-ip_ltm/manuals/product/f5-plat-diagnostics/_jcr_content/pdfAttach/download/file.res/F5_Platforms__Platform_Diagnostics.pdf"target="_blank" rel="external nofollow noopener noreferrer">Platform Diagnostics</a></p>
<p><a href="https://support.f5.com/csp/article/K15442"target="_blank" rel="external nofollow noopener noreferrer">K15442: Using the BIG-IP platform diagnostics tool</a></p>
<p>EUD SMART test</p>
<p><strong># platform_check disk</strong></p>
<p><strong>(tmos)# run util platform_check disk</strong></p>
<p>Logs to:</p>
<ul>
<li><strong>/var/db/platform_check/platform_check.xml</strong></li>
<li><strong>/var/log/platform_check</strong></li>
</ul>
<p>Results: PASS, FAIL, or NOT RUN</p>
<p>Not supported in VE</p>
<h2 id="--302b---identify-resource-exhaustion-problems-based-on-the-log-file-messages-and-statistics">- 3.02b - Identify resource exhaustion problems based on the log file messages and statistics</h2>
<h3 id="memory">Memory</h3>
<p><a href="https://support.f5.com/csp/article/K16419"target="_blank" rel="external nofollow noopener noreferrer">Article: K16419 - Overview of BIG-IP memory usage</a></p>
<p><a href="https://support.f5.com/csp/article/K16419"target="_blank" rel="external nofollow noopener noreferrer">Overview of BIG-IP TMM Memory Usage</a></p>
<p><a href="https://support.f5.com/csp/article/K16739"target="_blank" rel="external nofollow noopener noreferrer">Understanding the &rsquo;top&rsquo; output on BIG-IP</a></p>
<p><a href="https://www.linuxatemyram.com/"target="_blank" rel="external nofollow noopener noreferrer">Help! Linux ate my RAM!</a></p>
<p><a href="https://web.archive.org/web/20110207101856/http://www.linuxforums.org/articles/using-top-more-efficiently_89.html"target="_blank" rel="external nofollow noopener noreferrer">https://web.archive.org/web/20110207101856/http://www.linuxforums.org/articles/using-top-more-efficiently_89.html</a></p>
<p><a href="https://support.f5.com/csp/article/K5670"target="_blank" rel="external nofollow noopener noreferrer">K5670: Overview of adaptive connection reaping (11.5.x and earlier)</a></p>
<p><strong>top</strong></p>
<p>shift + m - Sort by memory usage</p>
<p>+ Sort descending</p>
<p>- Sort ascending</p>
<p>Measured in kilobytes</p>
<p>1 million kilobytes = 1 gigabyte</p>
<p>1000 kilobytes = 1 megabyte</p>
<p>nice process - Priority, lower number = more priority</p>
<pre tabindex="0"><code>top - 15:24:56 up 8 days,  4:52,  3 users,  load average: 0.31, 0.20, 0.08
Tasks: 252 total,   1 running, 251 sleeping,   0 stopped,   0 zombie
Cpu(s):  1.2%us,  0.7%sy,  0.3%ni, 97.4%id,  0.2%wa,  0.0%hi,  0.2%si,  0.0%st
Mem:   4063072k total,  3975468k used,	87604k free,   146572k buffers
Swap:  1023992k total, 	2796k used,  1021196k free,   468544k cached
  
PID USER  	PR  NI  VIRT  RES  SHR S %CPU %MEM	TIME+  COMMAND
10510 root  	RT   0 2430m 121m  95m S  5.6  3.1 686:26.35 tmm
 7438 root  	20   0  487m 104m  28m S  0.7  2.6  68:32.09 mcpd
 7662 root  	25   5 50636 9480 6272 S  0.7  0.2   7:59.31 merged
15757 root  	20   0  2444 1224  852 R  0.7  0.0   0:00.04 top
</code></pre><p>VIRT - How much memory the process can access</p>
<p>RES - How much the process is using in physical memory</p>
<p>Z - Zombie, terminated and waiting for parent process to finish</p>
<p>TIME+ Cumulative amount of time the process has used.</p>
<p>Load average: 1, 5, 15 minute interval. What jobs are queued to run. Over 1 per CPU is bad (4 for quad-core)</p>
<p>Tasks: Processes and states</p>
<ul>
<li>Zombie - parent process still around even though child is gone</li>
</ul>
<p>CPU: Percentage of CPU in different modes - should equal 100 percent total</p>
<ul>
<li>us - user</li>
<li>sy - system kernel processes</li>
<li>ni - niced user processes</li>
<li>id - Idle</li>
<li>%wa - I/O_Wait, high = storage issue</li>
<li>hi - hardware interrupts</li>
<li>si - software interrupts</li>
<li>st - CPU steal time, CPU isn’t available to VM and is working on another VM</li>
</ul>
<p>Memory: Should show almost always used fully because of TMM, bad indicator</p>
<p>Swap: Rarely used, if its high, memory is high</p>
<p>buffers/cache: How much memory is being borrowed for disk caching - improves access to frequently used things on disk.</p>
<p>Note: A high Other Used memory usage on the BIG-IP system Dashboard may not indicate an issue, as Linux kernel allocates memory to buffers and disk caching that can be released as needed.</p>
<p>You can increase memory to the System (not TMM) with a <strong>modify sys db</strong> command or allocating Small, Medium, or Large to MGMT under the Provisioning GUI page.</p>
<p><a href="https://support.f5.com/csp/article/K26427018"target="_blank" rel="external nofollow noopener noreferrer">K26427018: Overview of Management provisioning</a></p>
<p>It seems VMs always need to be Large allocated on v14 and above.</p>
<h5 id="a-possible-problem">A possible problem:</h5>
<p>Available memory (or &ldquo;free + buffers/cache&rdquo;) is close to zero</p>
<p>swap used increases or fluctuates</p>
<p><strong>show sys memory</strong></p>
<p>System memory</p>
<p>Host = Linux and non TMM processes</p>
<p>TMM</p>
<p>Subsystem - Memory used by TMM objects, hash tables</p>
<p><strong>show sys tmm-info</strong> &ndash; Shows multiple TMM Instances</p>
<p>TMM Used Memory compared to TMM Available Memory is the most important</p>
<p>TMM cannot be used in swap</p>
<p>Memory used by TMM is cleaned by sweepers periodically</p>
<h5 id="connection-reaping">Connection Reaping</h5>
<p>High-water - 95% TMM kernel utilization. No new connections are allowed</p>
<p>Low-water - 85% TMM kernel utilization. Aggressive reaping of the most idle connections, may delete connections prior to idle timeout configured.</p>
<h5 id="log-entries">Log Entries</h5>
<p>011e0002:4: sweeper_update aggressive mode activated - 85% TMM memory utilization will trigger aggressive idle connection deletion.</p>
<p>Adaptive reaping is activated from Dos Attacks, RAM Cache, Memory leaks</p>
<p><strong>LCD panel</strong> - Blocking DoS Attack</p>
<h3 id="cpu">CPU</h3>
<p><a href="https://support.f5.com/csp/article/K15468"target="_blank" rel="external nofollow noopener noreferrer">Overview of BIG-IP TMM CPU Usage</a></p>
<p><a href="https://support.f5.com/csp/article/K10095?sr=24657578"target="_blank" rel="external nofollow noopener noreferrer">Error Message: Clock advanced by <!-- raw HTML omitted --> ticks</a></p>
<p><a href="https://support.f5.com/csp/article/K10337613"target="_blank" rel="external nofollow noopener noreferrer">K10337613: Idle Enforcer Functionality</a></p>
<p><strong>show sys proc-info [ <!-- raw HTML omitted --> ]</strong> - Shows individual processes CPU usage<br>
<strong>show sys tmm-info</strong> - Show TMM CPU usage per process/core<br>
<strong>show sys cpu</strong> - System CPU is an aggregation of TMM and Control Plane CPU usage.<br>
<strong>show sys performance</strong><br>
<strong>top -</strong> Load average: 1, 5, 15 minute interval. What jobs are queued to run. Over 1 per CPU is bad (4 for quad-core)</p>
<p><strong>High CPU Causes</strong></p>
<ul>
<li>Memory paging, I/O operations</li>
<li>Complex iRules</li>
<li>A lot of HTTPS monitors</li>
<li>Large complex configs (a ton of ssl profiles/certs/keys)</li>
<li>Admin actions - dumping large number of connections or persistence</li>
<li>Listing large ARP entries</li>
<li>Large amount of traffic going through one TMM instance</li>
<li>Using socks driver instead of vmxnet3</li>
</ul>
<table>
<thead>
<tr>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>Clock advanced by <!-- raw HTML omitted --> ticks</td>
<td>In VE, dedicate more resources or priority<br />The TMM heartbeat thread dead timer hit [100 ms - physical, 300ms - virtual edition] and how far behind it is from the system clock<br />Can cause traffic disruption or failover if falls behind more than 10 seconds [10000 milliseconds] - may not log all because action already happened</td>
</tr>
<tr>
<td>info kernel: ltm driver: Idle enforcer starting - tid: <!-- raw HTML omitted --> cpu: <!-- raw HTML omitted -->/<!-- raw HTML omitted --></td>
<td>CPU usage on the Data plane reaches 80%, the Control plane is paused momentarily and used for Data plane until a log message ‘exited’ is shown</td>
</tr>
</tbody>
</table>
<h3 id="hard-drive">Hard Drive</h3>
<p><strong>df -h</strong> - Display partitions and size/usage</p>
<p><strong>du <!-- raw HTML omitted --> -h</strong> - Display size of files, -h = human readable sizes in K or G, automatically recursive into directories!</p>
<p><strong>lvscan</strong> - Display storage per partition. Some are shared, like log, share, etc.</p>
<h3 id="cache">Cache</h3>
<p><a href="https://support.f5.com/csp/article/K13878"target="_blank" rel="external nofollow noopener noreferrer">K13878: The ramcache.maxmemorypercent variable controls memory allocation for the HTTP cache (11.x - 15.x)</a></p>
<p>/var/log/ltm</p>
<p>01070668:3: The amount of cache memory assigned to Web Acceleration profiles (840MB) exceeds the maximum amount (838MB) defined by Ramcache.MaxMemoryPercent (50)</p>
<p>ramcache.maxmemorypercent - Percentage amount of memory that the total HTTP cache is allowed to use based on total TMM memory. Default is 50 percent</p>
<p>Verify memory allocated to tmos - <strong>show sys provision</strong></p>
<pre tabindex="0"><code>---------------------------------------------------------
Sys::Provision
Module CPU (%) Memory (MB) Host-Memory (MB) Disk (MB)
---------------------------------------------------------
apm 0 0 0 0
asm 0 0 0 0
avr 0 0 0 0
gtm 0 0 0 0
host 10 1296 0 82636
lc 0 0 0 0
ltm 1 0 0 0
pem 0 0 0 0
psm 0 0 0 0
tmos 89 6710 0 0
wam 0 0 0 0
wom 0 0 0 0
woml 0 0 0 0
</code></pre><p>TMM memory is 6710 MB</p>
<p>DB set to 50 percent</p>
<p>4 TMM instances</p>
<p>Formula: 6710 x .50 / 4 - 838MB is the max.</p>
<p>Memory for cache is not allocated until the profile is attached to a VIP. This error would not generate until you apply the profiles</p>
<p>HTTP cache storage is shared among all profiles of the same name. Consolidate profiles when possible</p>
<h2 id="--302c---identify-connectivity-problems-based-on-the-log-files">- 3.02c - Identify connectivity problems based on the log files</h2>
<p><strong>modify sys db</strong> <strong>tm.rstcause.log value enable</strong> - Displays “RST sent from <!-- raw HTML omitted --> to <!-- raw HTML omitted --> and the reason in logs</p>
<p>Everything else is self explanatory or I am not aware of any log entries that indicate a connectivity problem. SSL errors logging was not set to warning in 11.5.</p>
<h2 id="--302d---determine-the-appropriate-log-file-to-examine-to-determine-the-cause-of-the-problem">- 3.02d - Determine the appropriate log file to examine to determine the cause of the problem</h2>
<table>
<thead>
<tr>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Problem</strong></td>
<td><strong>Log File</strong></td>
</tr>
<tr>
<td>Failed hard drive or hard drive issues</td>
<td>/var/log/kern.log/var/log/daemon.log</td>
</tr>
<tr>
<td>Hardware initialization</td>
<td>/var/log/dmesg</td>
</tr>
<tr>
<td>Power Supplychmand[8901]: 012a0040:4: PSU1 Status input lost</td>
<td>/var/log/ltm</td>
</tr>
<tr>
<td>Linux events</td>
<td>/var/log/messages</td>
</tr>
<tr>
<td>Logins and changes</td>
<td>/var/log/audit</td>
</tr>
</tbody>
</table>
<h2 id="objective-303-analyze-performance-data-to-identify-a-resource-problem-on-an-ltm-device">Objective 3.03 Analyze performance data to identify a resource problem on an LTM device</h2>
<h2 id="--303a---analyze-performance-data-to-identify-a-resource-problem-on-an-ltm-device">- 3.03a - Analyze performance data to identify a resource problem on an LTM device</h2>
<p><strong>Statistics &gt; Performance Reports &gt; Performance Reports</strong></p>
<p>Performance Graphs are easy to look at. If the RAM or CPU is maxed the graph will say.</p>
<p><strong>show sys traffic</strong> - Shows packets dropped due to Errors and why</p>
<p><strong>show net rst-cause</strong> - Cause of resets</p>
<h2 id="objective-304-given-a-scenario-determine-the-cause-of-an-ltm-device-failover">Objective 3.04 Given a scenario, determine the cause of an LTM device failover</h2>
<h3 id="ha-groups-fast-failover">HA Groups (Fast Failover)</h3>
<p><a href="https://support.f5.com/csp/article/K16947"target="_blank" rel="external nofollow noopener noreferrer">Article: K16947 - F5 recommended practices for the HA group feature</a></p>
<p>Used to failover when a trunk link(s) or pool member(s) goes down.</p>
<p>Assigned to a floating traffic group on all devices.</p>
<p>Faster than VLAN, system, or gateway failsafes</p>
<p>Don’t use Force Standby while this feature is enabled on &lt; 13.0 devices, it will fail back to the Active unit. <a href="https://support.f5.com/csp/article/K14515"target="_blank" rel="external nofollow noopener noreferrer">Disable HA group first</a></p>
<p>Don’t use Auto-Failback on &lt;13.0 devices. It will keep failing back to the primary and cause flaps.</p>
<p><strong>Creating</strong></p>
<p>System &gt; High Availability &gt; HA Groups</p>
<p><strong>HA Score Calculation</strong></p>
<p>HA Score = Weights + Active Bonus<br>
The maximum overall HA Score is the sum of all HA group Pools and Trunk object weights, plus the active bonus value if the unit is active<br>
A single Pool or Trunk member object can weigh from 10 - 100<br>
There is no limit to the total HA Score of all Pool / Trunk object weights for HA group.<br>
Weight value (Required) 10 - 100, Assigned to pool or trunk object<br>
Threshold (Optional) - The minimum amount of available objects before making the TOTAL HA score immediately 0. If the threshold is 3, and there’s only 2 trunk links left out of 4, set the score to 0.</p>
<ul>
<li>Beware of pools with priority groups as the members that are up could prevent a failover<br>
Active Bonus (Optional) - A bonus given to the device with the active traffic group. Used to prevent failover if flapping or minor changes occur to trunk links. If traffic-group is at 0, bonus is not applied</li>
</ul>
<h3 id="ha-order">HA Order</h3>
<p>Auto Failback - Failover to original active if it becomes available again. Recommended 40 to 60 (Default) seconds.</p>
<p>Failover order - Only devices in the same sync-failover group will appear here. Fails back to the first device in order when it becomes available.</p>
<p>If the first device is not available, no auto fallback occurs. If no devices are available, Load Aware is used instead</p>
<h3 id="load-aware">Load Aware</h3>
<p>BIG-IP Device Service Clustering: Administration pg. 90</p>
<p>At least 3 devices in a device-group are required to use this mode.</p>
<p><strong>Configure</strong></p>
<p>Traffic Group &gt; HA Load Factor - Manually specified number to indicate the amount of traffic load under the traffic-group. Default value 10, range 1 - 1000. The higher = more load. Configure on every device, does not sync.</p>
<p>Device &gt; HA Capacity - Manually specified to indicate how much the device can handle related to the other devices. Default is 0 (unlimited) which does not use HA Capacity to calculate a Load Score. The higher = more capacity</p>
<p><strong>Load Score Calculation</strong></p>
<p>The load score is calculated on a per device basis in the group. For a device’s score to be calculated, (the sum of all active traffic group’s load factors on that device + the traffic group’s load factors it is next active for / device capacity.)</p>
<p>In order for a next-active device to be chosen for a single traffic group, (the sum of the local active traffic group’s load factors + remote candidate traffic group’s load factor / device capacity) must be run on all devices. The device with the lowest score is chosen as next-active. The tiebreaker is highest management IP</p>
<p><strong>show cm device</strong> - Displays HA Load Capacity, Mgmt IP, Current Load Factor, Next Active Device Load Factor</p>
<h3 id="failsafes">Failsafes</h3>
<p>If both units are affected by the same failsafe condition, they can both go into Standby</p>
<p><strong>Gateway Failsafe</strong></p>
<p><a href="https://support.f5.com/csp/article/K91881543"target="_blank" rel="external nofollow noopener noreferrer">K91881543: Configuring gateway fail-safe using the Configuration utility (11.x - 12.x)</a></p>
<p><a href="https://support.f5.com/csp/article/K15367"target="_blank" rel="external nofollow noopener noreferrer">K15367: Configuring gateway fail-safe using tmsh (11.x - 13.x)</a></p>
<ol>
<li>Create a pool with the gateway IP in it</li>
<li>Create new Gateway ICMP monitors to test IP reachability through the gateway with Transparent mode and Alias address, or use the default gateway_icmp monitor</li>
<li><strong>System &gt; High Availability &gt; Fail-safe &gt; Gateway</strong></li>
<li>Specify Pool and which device it belongs to.</li>
<li>Specify threshold - 1 would mean if there is less than 1 member, failover.</li>
</ol>
<pre tabindex="0"><code>ltm pool gateway_pool {
    members {
        10.128.10.254:0 {
            address 10.128.10.254
        }
    }
    gateway-failsafe-device bigip1.localhost
    min-up-members 1
    min-up-members-action failover
    min-up-members-checking enabled
}
</code></pre><p><strong>VLAN Fail-safe</strong></p>
<p><a href="https://support.f5.com/csp/article/K13297"target="_blank" rel="external nofollow noopener noreferrer">Overview of VLAN failsafe</a></p>
<p>Passively listens for traffic on VLAN. If there is none, generate traffic and expect response before the timer expires, or perform failover action.</p>
<p>Timer half expired - Send ARP request to oldest entry (IPv4)</p>
<p>Timer three-quarter expired - Send ARP request to all entries in table, and ICMP ping to multicast 224.0.0.1</p>
<p>If the peer LB responds in 11 or 12 code, then failover is averted</p>
<p>Be sure that the port has <strong>spanning-tree trunk portfast</strong> enabled. Otherwise, STP convergence can cause very long failovers (90 seconds).</p>
<p>With <strong>portfast</strong> it should be 10 seconds.</p>
<p><strong>db failover.vlanfailsafe.resettimeronanyframe</strong></p>
<ul>
<li>False (Default) - Only reset timer when receiving response to ARP</li>
<li>True - Reset timer if any traffic is received - including monitor responses</li>
</ul>
<p><strong>Configure</strong></p>
<p>System &gt; High Availability &gt; Fail-safe &gt; VLANs</p>
<p>Timeout: 90 seconds (default)</p>
<p>Action:  &lt;&gt;</p>
<pre tabindex="0"><code>net vlan external {
  failsafe enabled
}
</code></pre><p><strong>Miscellaneous Facts</strong></p>
<ul>
<li>VLAN failsafe configuration is not synced, make changes on all units</li>
<li>allow-service on Floating Self-IPs needs to be default (untested)</li>
<li>Set timer larger than it takes for links to come back up (STP)</li>
<li>Use node monitor for ARP entries to show if you have to</li>
<li>Do not configure it on the HA VLAN</li>
</ul>
<h2 id="--304a---explain-the-effect-of-network-failover-settings-on-the-ltm-device">- 3.04a - Explain the effect of network failover settings on the LTM device </h2>
<p>Default timeout is 3 seconds</p>
<p>Default port is UDP 1026</p>
<p>Required for connection mirroring</p>
<h2 id="--304b---explain-the-relationship-between-serial-and-network-failover">- 3.04b - Explain the relationship between serial and network failover </h2>
<p><a href="https://support.f5.com/csp/article/K2397"target="_blank" rel="external nofollow noopener noreferrer">K2397: Comparison of hardwired failover and network failover features</a></p>
<p>Hardware failover precedence over network failover. The unit will not failover if hardware is up and network is down.</p>
<h2 id="--304c---differentiate-between-unicast-and-multicast-network-failover-modes">- 3.04c - Differentiate between unicast and multicast network failover modes</h2>
<p>Unicast Failover IP - Used for LTMs primarily, and recommended to use on VIPRIONs as a backup.</p>
<p>Multicast Failover - Used by VIPRIONs - Multicast is sent out on the management interface, and all VIPRIONs receive it that are listening on that VLAN.</p>
<h2 id="--304d---identify-the-cause-of-failover-using-logs-and-statistics">- 3.04d - Identify the cause of failover using logs and statistics</h2>
<p><a href="https://support.f5.com/csp/article/K95002127#p8"target="_blank" rel="external nofollow noopener noreferrer">Troubleshooting failover events</a><br>
<a href="https://support.f5.com/csp/article/K16951"target="_blank" rel="external nofollow noopener noreferrer">Overview of SSL hardware acceleration fail-safe</a><br>
<a href="https://support.f5.com/csp/article/K12277"target="_blank" rel="external nofollow noopener noreferrer">How simultaneous failsafe events affect a redundant system</a><br>
<a href="https://support.f5.com/csp/article/K62511312"target="_blank" rel="external nofollow noopener noreferrer">K62511312: Cause of Failover - HA Group</a><br>
<a href="https://support.f5.com/csp/article/K57155323"target="_blank" rel="external nofollow noopener noreferrer">K57155323: Cause of Failover - Gateway Fail-Safe</a><br>
<a href="https://support.f5.com/csp/article/K48546348"target="_blank" rel="external nofollow noopener noreferrer">K48546348: Cause of Failover - Auto-failback</a><br>
<a href="https://support.f5.com/csp/article/K90354463"target="_blank" rel="external nofollow noopener noreferrer">K90354463: Cause of Failover - VLAN failsafe</a></p>
<h3 id="logs">Logs</h3>
<table>
<thead>
<tr>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>010c002b:5: Traffic group &lt;traffic_group&gt; received a targeted failover command for 10.128.1.100</td>
<td>Force standby command issued</td>
</tr>
<tr>
<td>010719fb:5: HA Group <!-- raw HTML omitted --> score updated from 40 to 30. <br /> 010c0045:5: Leaving active, group score 36 peer group score 40. <br /> 010c0052:5: Standby for traffic group /Common/&lt;traffic_group_name&gt;</td>
<td>HA Group</td>
</tr>
<tr>
<td>01140029:4: HA pool_memb_down /Common/g_pool fails action is failover</td>
<td>Gateway failsafe </td>
</tr>
<tr>
<td>01140029:4: HA vlan_fs</td>
<td>VLAN Failsafe</td>
</tr>
<tr>
<td>010c006d:5: Initiating Auto-Failback.</td>
<td>Auto-failback</td>
</tr>
<tr>
<td>01140029:5: HA daemon_heartbeat tmm fails action is failover and restart<br />01140106:2: Overdog daemon calling bigstart restart.</td>
<td>System failsafe</td>
</tr>
<tr>
<td>01140043:0: Ha feature nic_failsafe reboot requested</td>
<td>High Speed Bus issue detected</td>
</tr>
<tr>
<td>01070417:6: AUDIT - user admin - RAW: Request to run /usr/bin/cmd_sod go standby traffic-group-1 GUI</td>
<td>Force standby in GUI clicked</td>
</tr>
<tr>
<td>00000000:0: go standby</td>
<td><strong>run sys failover standby</strong> command ran.</td>
</tr>
<tr>
<td><strong>show sys log tmm | grep -i SIGSEGV</strong></td>
<td>Daemon failsafe - Search for SIGSEGV segmentation violations</td>
</tr>
<tr>
<td><strong>show sys log tmm | grep -i &lsquo;device error&rsquo;</strong> <br /> crypto-failsafe, switchboard-failsafe</td>
<td>Hardware failsafe</td>
</tr>
<tr>
<td>proc-run, ready-for-world</td>
<td>System (Daemon) Failsafe</td>
</tr>
</tbody>
</table>
<h3 id="statistics">Statistics</h3>
<p><a href="https://support.f5.com/csp/article/K14513346"target="_blank" rel="external nofollow noopener noreferrer">K14513346: The tmsh show /sys ha-group command output may display an incorrect HA group score value</a></p>
<table>
<thead>
<tr>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>show cm failover-status</strong></td>
<td>Status ‘Ok’ or ‘Error’ with reason, Network failover IP address and ports of connections (UDP 1026)</td>
</tr>
<tr>
<td><strong>show sys ha-status all-properties</strong> <br /> <strong>show sys ha-group</strong></td>
<td>Failsafe conditions, Failsafe failure status yes/no, timeouts <br /> See total HA score including active bonus score on current unit</td>
</tr>
<tr>
<td><strong>show cm traffic-group all-properties</strong></td>
<td>View HA load factor and next active</td>
</tr>
<tr>
<td><strong>run cm watch-sys-device</strong></td>
<td>Live updates of failover status, and HA IPs</td>
</tr>
<tr>
<td><strong>run cm watch-trafficgroup-device</strong></td>
<td>Live failover condition, monitor fault, next active</td>
</tr>
<tr>
<td><strong>show sys failover cable</strong></td>
<td>cable state unset - Network failover being used, no hardware failover detected - Max cable length - 50 ftcable set 0 - Active unit should display thiscable state 1 - Standby unit should detect this</td>
</tr>
<tr>
<td><strong>show sys failover</strong></td>
<td>Display amount of time in current Active or Standby stateFailover active for 119d 00:43:18</td>
</tr>
</tbody>
</table>
<h2 id="objective-305-given-a-scenario-determine-the-cause-of-loss-of-high-availability-andor-sync-failure">Objective 3.05 Given a scenario, determine the cause of loss of high availability and/or sync failure</h2>
<h2 id="--305a---explain-how-the-high-availability-concepts-relate-to-one-another">- 3.05a - Explain how the high availability concepts relate to one another</h2>
<p>DSC supports same or different hardware</p>
<p>Device Trust - Multiple BIG-IPs establish trust by signing each other&rsquo;s certificates.<br>
Device Groups - A collection of BIG-IPs that have established trust and wish to Sync-Failover or Sync-Only with each other.<br>
Traffic Groups - A collection of traffic objects - VIPs, SNATs, NATs, Folders, and Self IPs, that can be transferred to another member in a Sync-Failover Device-Group if there is an issue.<br>
Folders - Configuration under a partition.</p>
<p>Connection mirroring can only be done on identical hardware and is mirrored to the next-active device.</p>
<h2 id="--305b---explain-the-relationship-between-device-trust-and-device-groups">- 3.05b - Explain the relationship between device trust and device groups</h2>
<p>A peer BIG-IP must have device trust established before it can be put in a device-group</p>
<h2 id="--305c---identify-the-cause-of-config-sync-failures">- 3.05c - Identify the cause of config sync failures</h2>
<p><a href="https://support.f5.com/csp/article/K13946"target="_blank" rel="external nofollow noopener noreferrer">Troubleshooting ConfigSync and DSC</a></p>
<p><a href="https://support.f5.com/csp/article/K65332506"target="_blank" rel="external nofollow noopener noreferrer">K65332506: Provisioning mismatch may cause configsync error messages</a></p>
<h3 id="config-sync-requirements">Config-Sync Requirements</h3>
<ul>
<li>Device Trust established</li>
<li>Identical license and provisioned modules</li>
<li>Same major software release (11.x)</li>
<li>Times are synchronized</li>
<li>The self-IPs port-lockdown is <strong>NOT</strong> set to <strong>None,</strong> which is not default in 11.5.0</li>
<li><strong>Config must validate/load</strong></li>
</ul>
<h4 id="port-4353-connectivity">Port 4353 Connectivity</h4>
<p>Not actually iQuery, it’s separate</p>
<ol>
<li>Local <strong>mcpd</strong> connects locally to <strong>tmm</strong> on 6699</li>
<li>Local <strong>tmm</strong> connects to peer over 4353 over SSL</li>
<li>Remote <strong>tmm</strong> translates connection on port 4353 to 6699 and passes to <strong>mcpd</strong></li>
<li>Full mesh connectivity between devices over <strong>mcpd</strong> is established</li>
<li>Connectivity will show as port 6699 under netstat</li>
</ol>
<h3 id="sync-and-device-trust-problems">Sync and Device Trust Problems</h3>
<table>
<thead>
<tr>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>Verify Commit IDs, CID origin, and CID time. Higher CID = more recent</td>
<td><strong>run cm watch-devicegroup-device</strong></td>
</tr>
<tr>
<td>Processes are up</td>
<td><strong>bigstart status devmgmtd mcpd sod tmm</strong></td>
</tr>
<tr>
<td>Mismatched provisioned modules</td>
<td>01260013:4: SSL Handshake failed for TCP &lt;bigip1_configsync_ip&gt;:4353 -&gt; &lt;bigip2_configsync_ip&gt;:&lt;random_port&gt;<br />01260009:4: (null connflow): Connection error: ssl_basic_crypto_cb:694: <strong>alert(20) Decryption error</strong></td>
</tr>
<tr>
<td>Verify configuration will load</td>
<td><strong>load sys config verify</strong></td>
</tr>
<tr>
<td>Sync status and recommended action</td>
<td><strong>show cm sync-status</strong></td>
</tr>
<tr>
<td>Devices are in the trust group</td>
<td><strong>show cm device-group device_trust_group</strong></td>
</tr>
<tr>
<td>Config-sync IP is configured and trust connectivity is good</td>
<td><strong>show cm device</strong> <br /> <strong>netstat -pan | grep -E 6699</strong> - mcpd for device-trust <br /> <strong>run cm sniff-updates</strong> - Listens for CMI comms</td>
</tr>
<tr>
<td>Verify Time</td>
<td>Verify time/date -  <strong># date</strong><br />NTP configured (required?)<br /><strong>list sys ntp</strong> <br /> <strong># ntpq -np</strong></td>
</tr>
<tr>
<td>Verify license, software version, and provisioning</td>
<td><strong>show sys license</strong> <br /> <strong>show sys version / software</strong> <br /> <strong>list sys provision</strong></td>
</tr>
<tr>
<td>Verify port lockdown</td>
<td><strong>list net self allow-service</strong></td>
</tr>
</tbody>
</table>
<h4 id="sync-status-messages">Sync Status Messages</h4>
<p><strong>Disconnected</strong></p>
<ul>
<li>Communication problem between devices over 4353</li>
<li>Device trust issue</li>
</ul>
<p>All else fails - reset device trust</p>
<h4 id="device-trust">Device Trust</h4>
<p>Only a CA or Peer can sign certificates. If a peer member is only a Subordinate in its Local Trust, then it cannot sign certificates of the other device. The peer would sign its own certificate for the peer (pretty confusing)</p>
<h3 id="self-ips">Self-IPs</h3>
<p>Can be a range</p>
<p>Can assign IP that is in the range of separate VLANs to be accessible from both VLANs</p>
<h4 id="port-lockdown">Port Lockdown</h4>
<p><a href="https://support.f5.com/csp/article/K13250"target="_blank" rel="external nofollow noopener noreferrer">K13250: Overview of port lockdown behavior (10.x - 11.x)</a></p>
<p>Controlling what ports the self-IP can accept traffic on to prevent unauthorized management access, only allow access to other BIP IPs or necessary functions like DNS. Use out of band access instead  (Mgmt)</p>
<h4 id="options-2">Options</h4>
<p>Need to have ports allowed if you want to communicate from them as well. DNS to resolve hostnames from command line, ICMP, etc.</p>
<p><strong>Allow Default</strong> - Default in 11.0.0 - 11.5.2</p>
<ul>
<li>ICMP</li>
<li>OSPF</li>
<li>4353 TCP/UDP (iQuery/CMI)</li>
<li>443</li>
<li>161 TCP/UDP (SNMP)</li>
<li>22 TCP/UDP</li>
<li>53 TCP/UDP</li>
<li>520 TCP/UDP (RIP)</li>
<li>1026 UDP - Network Failover</li>
</ul>
<p><strong>Allow All</strong></p>
<p><strong>Allow None -</strong> Default in all other versions</p>
<ul>
<li>ICMP</li>
<li>Redundant pairs allow exceptions from peer:
<ul>
<li>1028 TCP - Persistence mirroring (11.0.0 - 11.3.0)</li>
<li>1029 - 1043 (1055) TCP - Mirroring channels per traffic group (11.4.0+)</li>
<li>4353 TCP - For Syncing via CMI (Centralized Management Infra) (11.0.0+)</li>
</ul>
</li>
</ul>
<h4 id="verification">Verification</h4>
<p>Verify port lockdown - <strong>list net self allow-service</strong></p>
<p>View default - <strong>list net self-allow</strong></p>
<h2 id="--305d---explain-the-relationship-between-traffic-groups-and-ltm-objects">- 3.05d - Explain the relationship between traffic groups and LTM objects</h2>
<p>Traffic groups host these LTM objects for failover - VIPs, SNATs, NATs, Folders, Self IPs</p>
<h2 id="--305e---interpret-log-messages-to-determine-the-cause-of-high-availability-issues">- 3.05e - Interpret log messages to determine the cause of high availability issues</h2>
<p><a href="https://support.f5.com/csp/article/K34063049"target="_blank" rel="external nofollow noopener noreferrer">K34063049: Error Message: 0107143c:5: Connection to CMI peer <!-- raw HTML omitted --> has been removed</a><br>
<a href="https://support.f5.com/csp/article/K06416036"target="_blank" rel="external nofollow noopener noreferrer">K06416036: Error Message: 0107143a:5: CMI reconnect timer: <!-- raw HTML omitted --></a><br>
<a href="https://support.f5.com/csp/article/K13667"target="_blank" rel="external nofollow noopener noreferrer">K13667: BIG-IP device group members must run the same major, minor or maintenance software version</a><br>
<a href="https://support.f5.com/csp/article/K75975904"target="_blank" rel="external nofollow noopener noreferrer">K75975904: Troubleshooting network failover</a><br>
<a href="https://support.f5.com/csp/article/K72087447"target="_blank" rel="external nofollow noopener noreferrer">K72087447: Error Message: HA Connection with peer [address:port] for traffic-group /Common/[traffic-group_name] lost. (11.x - 13.x)</a><br>
<a href="https://support.f5.com/csp/article/K37457128"target="_blank" rel="external nofollow noopener noreferrer">K37457128: Error Message: info sod[<!-- raw HTML omitted -->]: 010c007b:6: Deleted unicast failover address <!-- raw HTML omitted --> port <!-- raw HTML omitted --> for device /<!-- raw HTML omitted -->/<!-- raw HTML omitted -->.</a><br>
<a href="https://support.f5.com/csp/article/K29449945"target="_blank" rel="external nofollow noopener noreferrer">K29449945: Error Message: 010c008b:5: Unable to send to unreachable unicast address &lt;IP_address&gt; port &lt;port_number&gt;</a><br>
<a href="https://support.f5.com/csp/article/K17362757"target="_blank" rel="external nofollow noopener noreferrer">K17362757: Error Message: 010c0083:4: No failover status messages received for <!-- raw HTML omitted --> seconds, from device <!-- raw HTML omitted --> (&lt;IP_address&gt;)</a></p>
<p>Usually a <strong>sod</strong> message is a problem with Network Failover</p>
<table>
<thead>
<tr>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>01070712:3: Caught configuration exception (0), Can&rsquo;t parse MCP message, can&rsquo;t parse atomic message</td>
<td>Major Software mismatch</td>
</tr>
<tr>
<td>0107143c:5: Connection to CMI peer 192.168.100.2 has been removed<br />0107143a:5: CMI reconnect timer: enabled<br />0107143a:5: CMI reconnect timer: disabled, all peers are connected</td>
<td>Device trust port 4353/6699 issues</td>
</tr>
<tr>
<td>0107142f:3: Can&rsquo;t connect to CMI peer 10.11.23.140, TMM outbound listener not yet created<br />0107142f:3: Can&rsquo;t connect to CMI peer 192.168.10.100, port:6699, Transport endpoint is not connected</td>
<td>TMM not initialized on local or remote device</td>
</tr>
<tr>
<td>01340007:5: HA Connection with peer 192.168.100.2:32768 for traffic-group /Common/traffic-group-1 closing.</td>
<td>Received force offline message from peer</td>
</tr>
<tr>
<td>010c0078:5  Not listening for unicast failover packets on address 192.168.100.2 port 1026<br />010c007b:6: Deleted unicast failover address 192.168.100.2 port 1026 for device /Common/bigip1.f5.com</td>
<td>IP removed from network failover config</td>
</tr>
<tr>
<td>010c008b:5: Unable to send to unreachable unicast address 192.168.100.2 port 1026.</td>
<td>No route found to network failover IP</td>
</tr>
<tr>
<td>010c0083:4: No failover status messages received for 3.100 seconds, from device /Common/bigip2.f5.com (192.168.100.2) (unicast: -&gt; 192.168.100.1).</td>
<td>Connection lost over Network failover UDP 1026</td>
</tr>
<tr>
<td>01340002:3: HA Connection with peer 172.16.1.253:32768 for traffic-group /Common/traffic-group-1 lost.</td>
<td>Connection or persistence mirroring connection lost <br /> Check port 1028 - 1043 TCP</td>
</tr>
</tbody>
</table>
</div><div class="post-footer" id="post-footer">
  <div class="post-info">
    <div class="post-info-line">
      <div class="post-info-mod">
        <span title="Updated on 2023-04-30 20:14:22">Updated on 2023-04-30&nbsp;</span>
      </div><div class="post-info-license">
          <span><a rel="license external nofollow noopener noreferrer" href="https://creativecommons.org/licenses/by-nc/4.0/" target="_blank">CC BY-NC 4.0</a></span>
        </div></div>
    <div class="post-info-line">
      <div class="post-info-md"></div>
      <div class="post-info-share">
        <span><a href="javascript:void(0);" title="Share on Twitter" data-sharer="twitter" data-url="https://routeyour.net/posts/301b_study_guide/" data-title="F5 301b Study Guide"><i class="fa-brands fa-twitter fa-fw" aria-hidden="true"></i></a>
  <a href="javascript:void(0);" title="Share on Facebook" data-sharer="facebook" data-url="https://routeyour.net/posts/301b_study_guide/"><i class="fa-brands fa-facebook-square fa-fw" aria-hidden="true"></i></a>
  <a href="javascript:void(0);" title="Share on 微博" data-sharer="weibo" data-url="https://routeyour.net/posts/301b_study_guide/" data-title="F5 301b Study Guide"><i class="fa-brands fa-weibo fa-fw" aria-hidden="true"></i></a>
  </span>
      </div>
    </div>
  </div>

  <div class="post-info-more">
    <section class="post-tags"></section>
    <section>
      <span><a href="javascript:void(0);" onclick="window.history.back();">Back</a></span>&nbsp;|&nbsp;<span><a href="/">Home</a></span>
    </section>
  </div>

  <div class="post-nav"></div>
</div>
</article></main><footer class="footer">
    <div class="footer-container"><div class="footer-line powered">Powered by <a href="https://gohugo.io/" target="_blank" rel="external nofollow noopener noreferrer" title="Hugo 0.111.3">Hugo</a> | Theme - <a href="https://github.com/hugo-fixit/FixIt" target="_blank" rel="external" title="FixIt v0.2.18"><img class="fixit-icon" src="/fixit.min.svg" alt="FixIt logo" />&nbsp;FixIt</a>
        </div><div class="footer-line copyright" itemscope itemtype="http://schema.org/CreativeWork"><i class="fa-regular fa-copyright fa-fw" aria-hidden="true"></i>
            <span itemprop="copyrightYear">2021 - 2023</span><span class="author" itemprop="copyrightHolder">
              <a href="/">Caleb Delbrugge</a></span><span class="license footer-divider"><a rel="license external nofollow noopener noreferrer" href="https://creativecommons.org/licenses/by-nc/4.0/" target="_blank">CC BY-NC 4.0</a></span></div><div class="footer-line statistics"></div></div>
  </footer></div><div class="widgets"><div class="fixed-buttons animate__faster d-none"><div class="fixed-button back-to-top" role="button" aria-label="Back to Top"><i class="fa-solid fa-arrow-up fa-fw" aria-hidden="true"></i><span class="variant-numeric d-none">0%</span>
        </div></div><div id="mask"></div><noscript>
    <div class="noscript-warning">Theme FixIt works best with JavaScript enabled.</div>
  </noscript>
</div><link rel="stylesheet" href="/lib/katex/katex.min.css"><script src="/lib/sharer/sharer.min.js" async defer></script><script src="/lib/katex/katex.min.js" defer></script><script src="/lib/katex/auto-render.min.js" defer></script><script src="/lib/katex/copy-tex.min.js" defer></script><script src="/lib/katex/mhchem.min.js" defer></script><script>window.config={"code":{"copyTitle":"Copy to clipboard","editLockTitle":"Lock editable code block","editUnLockTitle":"Unlock editable code block","editable":true,"maxShownLines":10},"comment":{"enable":false},"math":{"delimiters":[{"display":true,"left":"$$","right":"$$"},{"display":true,"left":"\\[","right":"\\]"},{"display":true,"left":"\\begin{equation}","right":"\\end{equation}"},{"display":true,"left":"\\begin{equation*}","right":"\\end{equation*}"},{"display":true,"left":"\\begin{align}","right":"\\end{align}"},{"display":true,"left":"\\begin{align*}","right":"\\end{align*}"},{"display":true,"left":"\\begin{alignat}","right":"\\end{alignat}"},{"display":true,"left":"\\begin{alignat*}","right":"\\end{alignat*}"},{"display":true,"left":"\\begin{gather}","right":"\\end{gather}"},{"display":true,"left":"\\begin{CD}","right":"\\end{CD}"},{"display":false,"left":"$","right":"$"},{"display":false,"left":"\\(","right":"\\)"}],"strict":false}};</script><script src="/js/theme.min.js" defer></script></body>
</html>
