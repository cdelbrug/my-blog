<!DOCTYPE html>
<html itemscope itemtype="http://schema.org/WebPage" lang="en">
  <head>
    
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
    <meta name="robots" content="noodp" />
    <title>The Best S2S VPN Settings - Route Your Network</title><meta name="author" content="Caleb Delbrugge">
<meta name="author-link" content="">
<meta name="description" content="Introduction When configuring a Site to Site VPN, you may be wondering what the best settings are such as:
IKEv1 or v2 Encryption Integrity Lifetime PFS It&rsquo;s a good question, as I&rsquo;ve tried to figure that out myself. I stumbled upon this recommendation from NIST called &ldquo;Suite-B&rdquo; - and it seems to answer the question. There&rsquo;s an RFC for it below.
RFC 6379 - Suite B Cryptographic Suites for IPsec" /><meta name="keywords" content='Hugo, FixIt' /><meta itemprop="name" content="The Best S2S VPN Settings">
<meta itemprop="description" content="Introduction When configuring a Site to Site VPN, you may be wondering what the best settings are such as:
IKEv1 or v2 Encryption Integrity Lifetime PFS It&rsquo;s a good question, as I&rsquo;ve tried to figure that out myself. I stumbled upon this recommendation from NIST called &ldquo;Suite-B&rdquo; - and it seems to answer the question. There&rsquo;s an RFC for it below.
RFC 6379 - Suite B Cryptographic Suites for IPsec"><meta itemprop="datePublished" content="2024-05-14T19:14:22+08:00" />
<meta itemprop="dateModified" content="2024-05-14T19:14:22+08:00" />
<meta itemprop="wordCount" content="551">
<meta itemprop="keywords" content="" /><meta property="og:title" content="The Best S2S VPN Settings" />
<meta property="og:description" content="Introduction When configuring a Site to Site VPN, you may be wondering what the best settings are such as:
IKEv1 or v2 Encryption Integrity Lifetime PFS It&rsquo;s a good question, as I&rsquo;ve tried to figure that out myself. I stumbled upon this recommendation from NIST called &ldquo;Suite-B&rdquo; - and it seems to answer the question. There&rsquo;s an RFC for it below.
RFC 6379 - Suite B Cryptographic Suites for IPsec" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://routeyour.net/posts/the_best_s2s_vpn_settings/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2024-05-14T19:14:22+08:00" />
<meta property="article:modified_time" content="2024-05-14T19:14:22+08:00" />
<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="The Best S2S VPN Settings"/>
<meta name="twitter:description" content="Introduction When configuring a Site to Site VPN, you may be wondering what the best settings are such as:
IKEv1 or v2 Encryption Integrity Lifetime PFS It&rsquo;s a good question, as I&rsquo;ve tried to figure that out myself. I stumbled upon this recommendation from NIST called &ldquo;Suite-B&rdquo; - and it seems to answer the question. There&rsquo;s an RFC for it below.
RFC 6379 - Suite B Cryptographic Suites for IPsec"/>
<meta name="application-name" content="FixIt">
<meta name="apple-mobile-web-app-title" content="FixIt"><meta name="theme-color" data-light="#f8f8f8" data-dark="#252627" content="#f8f8f8"><meta name="msapplication-TileColor" content="#da532c"><link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" />
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5"><link rel="canonical" href="https://routeyour.net/posts/the_best_s2s_vpn_settings/" /><link rel="prev" href="https://routeyour.net/posts/301b_v1_objectives/" /><link rel="stylesheet" href="/css/style.min.css"><link rel="stylesheet" href="/lib/fontawesome-free/all.min.css"><link rel="stylesheet" href="/lib/animate/animate.min.css"><script type="application/ld+json">
  {
    "@context": "http://schema.org",
    "@type": "BlogPosting",
    "headline": "The Best S2S VPN Settings",
    "inLanguage": "en",
    "mainEntityOfPage": {
      "@type": "WebPage",
      "@id": "https:\/\/routeyour.net\/posts\/the_best_s2s_vpn_settings\/"
    },"genre": "posts","wordcount":  551 ,
    "url": "https:\/\/routeyour.net\/posts\/the_best_s2s_vpn_settings\/","datePublished": "2024-05-14T19:14:22+08:00","dateModified": "2024-05-14T19:14:22+08:00","publisher": {
      "@type": "Organization",
      "name": ""},"author": {
        "@type": "Person",
        "name": "Caleb Delbrugge"
      },"description": ""
  }
  </script></head>
  <body data-header-desktop="sticky" data-header-mobile="auto"><script>(window.localStorage?.getItem('theme') ? localStorage.getItem('theme') === 'dark' : ('auto' === 'auto' ? window.matchMedia('(prefers-color-scheme: dark)').matches : 'auto' === 'dark')) && document.body.setAttribute('data-theme', 'dark');</script><div class="wrapper" data-page-style="normal"><header class="desktop animate__faster" id="header-desktop">
  <div class="header-wrapper">
    <div class="header-title">
      <a href="/" title="Route Your Network"><span class="header-title-text">routeyour.net</span></a><span class="header-subtitle"></span></div>
    <nav>
      <ul class="menu"><li class="menu-item">
              <a
                class="menu-link"
                href="/posts/"
                
                
              >Posts</a></li><li class="menu-item">
              <a
                class="menu-link"
                href="/tags/"
                
                
              >Tags</a></li><li class="menu-item">
              <a
                class="menu-link"
                href="/categories/"
                
                
              >Categories</a></li><li class="menu-item delimiter"></li><li class="menu-item theme-switch" title="Switch Theme">
          <i class="fa-solid fa-adjust fa-fw" aria-hidden="true"></i>
        </li></ul>
    </nav>
  </div>
</header><header class="mobile animate__faster" id="header-mobile">
  <div class="header-container">
    <div class="header-wrapper">
      <div class="header-title">
        <a href="/" title="Route Your Network"><span class="header-title-text">routeyour.net</span></a><span class="header-subtitle"></span></div>
      <div class="menu-toggle" id="menu-toggle-mobile">
        <span></span><span></span><span></span>
      </div>
    </div>
    <nav>
      <ul class="menu" id="menu-mobile"><li
              class="menu-item"
            ><a
                  class="menu-link"
                  href="/posts/"
                  
                  
                >Posts</a></li><li
              class="menu-item"
            ><a
                  class="menu-link"
                  href="/tags/"
                  
                  
                >Tags</a></li><li
              class="menu-item"
            ><a
                  class="menu-link"
                  href="/categories/"
                  
                  
                >Categories</a></li><li class="menu-item menu-system">
          <span class="menu-system-item theme-switch" title="Switch Theme"><i class="fa-solid fa-adjust fa-fw" aria-hidden="true"></i></span></li>
      </ul>
    </nav>
  </div>
</header><main class="container"><aside class="toc" id="toc-auto"><h2 class="toc-title">Contents&nbsp;<i class="toc-icon fa-solid fa-angle-down fa-fw" aria-hidden="true"></i></h2>
      <div class="toc-content" id="toc-content-auto"></div></aside>

  <aside class="aside-custom">
    </aside>

  <article class="page single">
    <div class="header"><h1 class="single-title animate__animated animate__flipInX"><span>The Best S2S VPN Settings</span>
      </h1></div><div class="post-meta">
      <div class="post-meta-line"><span class="post-author"><span class="author"><i class="fa-solid fa-user-circle" aria-hidden="true"></i>
      Caleb Delbrugge</span></span></div>
      <div class="post-meta-line"><span title="published on 2024-05-14 19:14:22"><i class="fa-regular fa-calendar-alt fa-fw me-1" aria-hidden="true"></i><time datetime="2024-05-14">2024-05-14</time></span>&nbsp;<span title="Updated on 2024-05-14 19:14:22"><i class="fa-regular fa-edit fa-fw me-1" aria-hidden="true"></i><time datetime="2024-05-14">2024-05-14</time></span>&nbsp;<span><i class="fa-solid fa-pencil-alt fa-fw me-1" aria-hidden="true"></i>551 words</span>&nbsp;<span><i class="fa-regular fa-clock fa-fw me-1" aria-hidden="true"></i>3 minutes</span>&nbsp;</div>
    </div><div class="details toc" id="toc-static" data-kept="false">
        <div class="details-summary toc-title">
          <span>Contents</span>
          <span><i class="details-icon fa-solid fa-angle-right" aria-hidden="true"></i></span>
        </div>
        <div class="details-content toc-content" id="toc-content-static"><nav id="TableOfContents">
  <ul>
    <li><a href="#phase-1">Phase 1</a></li>
    <li><a href="#phase-2">Phase 2</a></li>
  </ul>

  <ul>
    <li><a href="#palo-alto">Palo Alto</a>
      <ul>
        <li><a href="#phase-1-1">Phase 1</a></li>
        <li><a href="#phase-2-1">Phase 2</a></li>
      </ul>
    </li>
    <li><a href="#asa">ASA</a>
      <ul>
        <li><a href="#phase-1-2">Phase 1</a></li>
        <li><a href="#phase-2-2">Phase 2</a></li>
        <li><a href="#virtual-tunnel-interface">Virtual Tunnel Interface</a></li>
        <li><a href="#routing">Routing</a></li>
      </ul>
    </li>
  </ul>
</nav></div>
      </div><div class="content" id="content"><h1 id="introduction">Introduction</h1>
<p>When configuring a Site to Site VPN, you may be wondering what the best settings are such as:</p>
<ul>
<li>IKEv1 or v2</li>
<li>Encryption</li>
<li>Integrity</li>
<li>Lifetime</li>
<li>PFS</li>
</ul>
<p>It&rsquo;s a good question, as I&rsquo;ve tried to figure that out myself. I stumbled upon this recommendation from NIST called &ldquo;Suite-B&rdquo; - and it seems to answer the question. There&rsquo;s an RFC for it below.</p>
<p><a href="https://datatracker.ietf.org/doc/html/rfc6379"target="_blank" rel="external nofollow noopener noreferrer">RFC 6379 - Suite B Cryptographic Suites for IPsec</a></p>
<p>There&rsquo;s two options they provide for encryption</p>
<ul>
<li>Suite-B-GCM-128</li>
<li>Suite-B-GCM-256</li>
</ul>
<h2 id="phase-1">Phase 1</h2>
<ul>
<li>IKEv2</li>
<li>Encryption type: AES-CBC-128 or AES-CBC-256</li>
<li>Hash type: SHA256 or SHA384</li>
<li>Diffie Hellman group: 19 or 20</li>
<li>Lifetime: 28800 seconds</li>
<li>Data Lifetime: Unlimited</li>
<li>Authentication: PSK or Certificate</li>
</ul>
<p>Other settings in phase 1 include whether to use a pre-shared key or certificate for authentication.
There&rsquo;s also the lifetime, which is how often to recycle the keys. For this, I refer to Palo Alto firewalls default setting, which is 8 hours.</p>
<h2 id="phase-2">Phase 2</h2>
<ul>
<li>Encryption type: AES-GCM-128 or AES-GCM-256</li>
<li>Hash: Null (built-in to GCM)</li>
<li>Diffie Hellman group: 19 or 20</li>
<li>Lifetime: 3600 seconds</li>
<li>Data Lifetime: Unlimited</li>
<li>Authentication: PSK or Certificate</li>
</ul>
<p>Again, using 1 hour lifetime to match the default on the Palo.</p>
<h1 id="configuration">Configuration</h1>
<p>In my examples, I&rsquo;ll be using Suite-B-GCM-128</p>
<h2 id="palo-alto">Palo Alto</h2>
<p>I don&rsquo;t have CLI for this yet but here&rsquo;s steps for the GUI</p>
<h3 id="phase-1-1">Phase 1</h3>
<pre tabindex="0"><code>Network &gt; Network Profiles &gt; IKE Gateways

Name: &lt;PEER-NAME&gt;-IKE-GW
Version: IKEv2 Only
Interface: &lt;OUTSIDE-INTERFACE&gt;
Peer IP Type: IP
Peer IP: &lt;PEER-IP&gt;
PSK: &lt;PSK&gt;
Peer Identification IP Address: &lt;PEER-IP&gt;

Advanced Options:
- IKE Crypto Profile: Suite-B-GCM-128
- Liveness Check: 5 seconds

Network &gt; Interfaces &gt; Add
Zone &gt; New &gt; &lt;PEER-NAME&gt;
IPv4 &gt; Add &gt; &lt;PEERING-IP&gt;
</code></pre><h3 id="phase-2-1">Phase 2</h3>
<pre tabindex="0"><code>Network &gt; Network Profiles &gt; IPSec Tunnels &gt; Add

Name: &lt;PEER-NAME&gt;-IPSEC-TUNNEL
IKE Gateway: &lt;PEER-NAME&gt;-IKE-GW
IPSec Crypto Profile: Suite-B-GCM-128
</code></pre><h2 id="asa">ASA</h2>
<p>If you&rsquo;re still running ASA code, that&rsquo;s awesome. It&rsquo;s pretty good at VPNs, and is still supported on Firepower hardware as far as I know.</p>
<h3 id="phase-1-2">Phase 1</h3>
<pre tabindex="0"><code>crypto ikev2 policy 100
 encryption aes
 integrity sha256
 group 19
 lifetime seconds 28800
</code></pre><p>You&rsquo;ll want to disable idle timeout on the ASA for VPNs. Otherwise, if no data has passed for a while, it will tear down the tunnel. Sometimes, the remote end isn&rsquo;t even aware of it.</p>
<pre tabindex="0"><code>group-policy &lt;NAME&gt; internal
group-policy &lt;NAME&gt; attributes
 vpn-idle-timeout none

tunnel-group &lt;PEER-IP&gt; type ipsec-l2l
tunnel-group &lt;PEER-IP&gt; ipsec-attributes
 ikev2 local-authentication pre-shared-key &lt;PSK&gt;
 ikev2 remote-authentication pre-shared-key &lt;PSK&gt;
tunnel-group &lt;PEER-IP&gt; general-attributes
 default-group-policy &lt;NAME&gt;
</code></pre><h3 id="phase-2-2">Phase 2</h3>
<p>Setting the &ldquo;kilobytes unlimited&rdquo; will disable Data Lifetime, which is a feature to recycle keys after a certain amount of data is sent. It&rsquo;s best to leave it off due to some firewalls not supporting it or having it off by default. If the firewalls in the tunnel mismatch on this, it can cause unexpected tunnel stability if one is not aware of the other doing this.</p>
<pre tabindex="0"><code>crypto ipsec ikev2 ipsec-proposal SUITE-B-GCM-128-PROPOSAL
 protocol esp encryption aes-gcm
 protocol esp integrity null

crypto ipsec profile SUITE-B-GCM-128-PROFILE
  set ikev2 ipsec-proposal SUITE-B-GCM-128-PROPOSAL
  set security-association lifetime seconds 28800 kilobytes unlimited
  set pfs group19
</code></pre><h3 id="virtual-tunnel-interface">Virtual Tunnel Interface</h3>
<pre tabindex="0"><code>interface tunnel &lt;1-100&gt;
  nameif &lt;IF-NAME&gt;
  ip address &lt;PEERING-IP&gt; &lt;MASK&gt;
  tunnel source interface &lt;OUTSIDE-INTERFACE-NAME&gt;
  tunnel destination &lt;PEER-IP&gt;
  tunnel mode ipsec ipv4
  tunnel protection ipsec profile SUITE-B-GCM-128-PROFILE
</code></pre><h3 id="routing">Routing</h3>
<p>Now you need to decide if you will perform static or dynamic routing. If you are going to have any kind of redundancy, dynamic is recommended.</p>
<h4 id="dynamic">Dynamic</h4>
<h4 id="static">Static</h4>
</div><div class="post-footer" id="post-footer">
  <div class="post-info">
    <div class="post-info-line">
      <div class="post-info-mod">
        <span title="Updated on 2024-05-14 19:14:22">Updated on 2024-05-14&nbsp;</span>
      </div><div class="post-info-license">
          <span><a rel="license external nofollow noopener noreferrer" href="https://creativecommons.org/licenses/by-nc/4.0/" target="_blank">CC BY-NC 4.0</a></span>
        </div></div>
    <div class="post-info-line">
      <div class="post-info-md"></div>
      <div class="post-info-share">
        <span><a href="javascript:void(0);" title="Share on Twitter" data-sharer="twitter" data-url="https://routeyour.net/posts/the_best_s2s_vpn_settings/" data-title="The Best S2S VPN Settings"><i class="fa-brands fa-twitter fa-fw" aria-hidden="true"></i></a>
  <a href="javascript:void(0);" title="Share on Facebook" data-sharer="facebook" data-url="https://routeyour.net/posts/the_best_s2s_vpn_settings/"><i class="fa-brands fa-facebook-square fa-fw" aria-hidden="true"></i></a>
  <a href="javascript:void(0);" title="Share on Linkedin" data-sharer="linkedin" data-url="https://routeyour.net/posts/the_best_s2s_vpn_settings/"><i class="fa-brands fa-linkedin fa-fw" aria-hidden="true"></i></a>
  </span>
      </div>
    </div>
  </div>

  <div class="post-info-more">
    <section class="post-tags"></section>
    <section>
      <span><a href="javascript:void(0);" onclick="window.history.back();">Back</a></span>&nbsp;|&nbsp;<span><a href="/">Home</a></span>
    </section>
  </div>

  <div class="post-nav"><a href="/posts/301b_v1_objectives/" class="post-nav-item" rel="prev" title="F5 301b v1 Objectives"><i class="fa-solid fa-angle-left fa-fw" aria-hidden="true"></i>F5 301b v1 Objectives</a></div>
</div>
<div id="comments"><div id="giscus">
          <script
            src="https://giscus.app/client.js"
            data-repo="cdelbrug/my-blog"
            data-repo-id="R_kgDOJdR-hA"
            data-category="Announcements"
            data-category-id="DIC_kwDOJdR-hM4CeXIg"
            data-mapping="pathname"
            data-strict="0"
            
            data-theme="preferred_color_scheme"
            data-reactions-enabled="1"
            data-emit-metadata="0"
            data-input-position="bottom"
            data-lang="en"
            data-loading="lazy"
            crossorigin="anonymous"
            async
            defer
          ></script>
        </div>
        <noscript>
          Please enable JavaScript to view the comments powered by <a href="https://giscus.app/" rel="external nofollow noopener noreferrer">giscus</a>.
        </noscript></div></article></main><footer class="footer">
    <div class="footer-container"><div class="footer-line powered">Powered by <a href="https://gohugo.io/" target="_blank" rel="external nofollow noopener noreferrer" title="Hugo 0.111.3">Hugo</a> | Theme - <a href="https://github.com/hugo-fixit/FixIt" target="_blank" rel="external" title="FixIt v0.2.18"><img class="fixit-icon" src="/fixit.min.svg" alt="FixIt logo" />&nbsp;FixIt</a>
        </div><div class="footer-line copyright" itemscope itemtype="http://schema.org/CreativeWork"><i class="fa-regular fa-copyright fa-fw" aria-hidden="true"></i>
            <span itemprop="copyrightYear">2021 - 2025</span><span class="author" itemprop="copyrightHolder">
              <a href="/">Caleb Delbrugge</a></span><span class="license footer-divider"><a rel="license external nofollow noopener noreferrer" href="https://creativecommons.org/licenses/by-nc/4.0/" target="_blank">CC BY-NC 4.0</a></span></div><div class="footer-line statistics"></div></div>
  </footer></div><div class="widgets"><div class="fixed-buttons animate__faster d-none"><div class="fixed-button back-to-top" role="button" aria-label="Back to Top"><i class="fa-solid fa-arrow-up fa-fw" aria-hidden="true"></i><span class="variant-numeric d-none">0%</span>
        </div><div class="fixed-button view-comments d-none" role="button" aria-label="View Comments"><i class="fa-solid fa-comment fa-fw" aria-hidden="true"></i></div></div><div id="mask"></div><noscript>
    <div class="noscript-warning">Theme FixIt works best with JavaScript enabled.</div>
  </noscript>
</div><link rel="stylesheet" href="/lib/katex/katex.min.css"><script src="/lib/sharer/sharer.min.js" async defer></script><script src="/lib/katex/katex.min.js" defer></script><script src="/lib/katex/auto-render.min.js" defer></script><script src="/lib/katex/copy-tex.min.js" defer></script><script src="/lib/katex/mhchem.min.js" defer></script><script>window.config={"code":{"copyTitle":"Copy to clipboard","editLockTitle":"Lock editable code block","editUnLockTitle":"Unlock editable code block","editable":true,"maxShownLines":10},"comment":{"enable":true,"expired":false,"giscus":{"darkTheme":"dark","lightTheme":"light"}},"math":{"delimiters":[{"display":true,"left":"$$","right":"$$"},{"display":true,"left":"\\[","right":"\\]"},{"display":true,"left":"\\begin{equation}","right":"\\end{equation}"},{"display":true,"left":"\\begin{equation*}","right":"\\end{equation*}"},{"display":true,"left":"\\begin{align}","right":"\\end{align}"},{"display":true,"left":"\\begin{align*}","right":"\\end{align*}"},{"display":true,"left":"\\begin{alignat}","right":"\\end{alignat}"},{"display":true,"left":"\\begin{alignat*}","right":"\\end{alignat*}"},{"display":true,"left":"\\begin{gather}","right":"\\end{gather}"},{"display":true,"left":"\\begin{CD}","right":"\\end{CD}"},{"display":false,"left":"$","right":"$"},{"display":false,"left":"\\(","right":"\\)"}],"strict":false}};</script><script src="/js/theme.min.js" defer></script></body>
</html>
